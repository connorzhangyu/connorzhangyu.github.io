<!doctype html><html lang=zh><head><title>Docker :: Hello World</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="docker安装 {% tabs docker %}
# 卸载旧版本 sudo yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-selinux docker-engine-selinux docker-engine # 安装 sudo yum install -y yum-utils device-mapper-persistent-data lvm2 # 添加yum源 sudo yum-config-manager --add-repo https://mirrors.ustc.edu.cn/docker-ce/linux/centos/docker-ce.repo # 安装 yum -y install https://download.docker.com/linux/fedora/30/x86_64/stable/Packages/containerd.io-1.2.6-3.3.fc30.x86_64.rpm yum -y install docker-ce 启动 systemctl enable docker systemctl start docker # 用于系统是干净的,如果重新装,需要吧原来的docker卸载掉 sudo apt install docker.io {% endtabs %}
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=../../posts/docker/><link rel=stylesheet href=../../styles.css><link rel="shortcut icon" href=../../img/theme-colors/orange.png><link rel=apple-touch-icon href=../../img/theme-colors/orange.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content="Anthony"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="og:title" content="Docker"><meta property="og:description" content="docker安装 {% tabs docker %}
# 卸载旧版本 sudo yum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-selinux docker-engine-selinux docker-engine # 安装 sudo yum install -y yum-utils device-mapper-persistent-data lvm2 # 添加yum源 sudo yum-config-manager --add-repo https://mirrors.ustc.edu.cn/docker-ce/linux/centos/docker-ce.repo # 安装 yum -y install https://download.docker.com/linux/fedora/30/x86_64/stable/Packages/containerd.io-1.2.6-3.3.fc30.x86_64.rpm yum -y install docker-ce 启动 systemctl enable docker systemctl start docker # 用于系统是干净的,如果重新装,需要吧原来的docker卸载掉 sudo apt install docker.io {% endtabs %}
"><meta property="og:url" content="/posts/docker/"><meta property="og:site_name" content="Hello World"><meta property="og:image" content="https://image.runtimes.cc/202404051526227.webp"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Docker"><meta property="article:published_time" content="2022-11-19 18:25:00 +0000 UTC"></head><body class=orange><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=../../><div class=logo>康纳的记仇小本本</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=../../about>关于</a></li><li><a href=../../showcase>精选</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=../../about>关于</a></li><li><a href=../../showcase>精选</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=../../posts/docker/>Docker</a></h1><div class=post-meta><time class=post-date>2022-11-19</time><span class=post-author>Anthony</span></div><span class=post-tags>#<a href=../../tags/docker/>Docker</a>&nbsp;
#<a href=../../tags/jenkins/>Jenkins</a>&nbsp;
</span><img src=https://image.runtimes.cc/202404051526227.webp class=post-cover alt=" " title="Cover Image"><div class=post-content><div><h1 id=docker安装>docker安装<a href=#docker安装 class=hanchor arialabel=Anchor>&#8983;</a></h1><p>{% tabs docker %}</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 卸载旧版本</span>
</span></span><span style=display:flex><span>sudo yum remove docker docker-client  docker-client-latest  docker-common  docker-latest  docker-latest-logrotate  docker-logrotate  docker-selinux  docker-engine-selinux  docker-engine
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 安装</span>
</span></span><span style=display:flex><span>sudo yum install -y yum-utils  device-mapper-persistent-data  lvm2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 添加yum源</span>
</span></span><span style=display:flex><span>sudo yum-config-manager --add-repo  https://mirrors.ustc.edu.cn/docker-ce/linux/centos/docker-ce.repo
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 安装</span>
</span></span><span style=display:flex><span>yum -y install https://download.docker.com/linux/fedora/30/x86_64/stable/Packages/containerd.io-1.2.6-3.3.fc30.x86_64.rpm
</span></span><span style=display:flex><span>yum -y install docker-ce
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>启动
</span></span><span style=display:flex><span>systemctl enable docker
</span></span><span style=display:flex><span>systemctl start docker
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 用于系统是干净的,如果重新装,需要吧原来的docker卸载掉</span>
</span></span><span style=display:flex><span>sudo apt install docker.io
</span></span></code></pre></div><p>{% endtabs %}</p><h2 id=开启远程访问>开启远程访问<a href=#开启远程访问 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 编辑</span>
</span></span><span style=display:flex><span>vim /lib/systemd/system/docker.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 默认是这样的</span>
</span></span><span style=display:flex><span>ExecStart<span style=color:#f92672>=</span>/usr/bin/dockerd -H fd:// --containerd<span style=color:#f92672>=</span>/run/containerd/containerd.sock 
</span></span><span style=display:flex><span><span style=color:#75715e># 修改成</span>
</span></span><span style=display:flex><span>ExecStart<span style=color:#f92672>=</span>/usr/bin/dockerd -H fd:// --containerd<span style=color:#f92672>=</span>/run/containerd/containerd.sock -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 重启</span>
</span></span><span style=display:flex><span>systemctl daemon-reload
</span></span><span style=display:flex><span>systemctl restart docker
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 测试</span>
</span></span><span style=display:flex><span>curl http://localhost:2375/version
</span></span></code></pre></div><h2 id=查看远端仓库的标签>查看远端仓库的标签<a href=#查看远端仓库的标签 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>创建一个<code>dockertags.sh</code>脚本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> usage<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    cat <span style=color:#e6db74>&lt;&lt; HELP
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>dockertags  --  list all tags for a Docker image on a remote registry.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EXAMPLE:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - list all tags for ubuntu:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       dockertags ubuntu
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    - list all php tags containing apache:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>       dockertags php apache
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>HELP</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $# -lt <span style=color:#ae81ff>1</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    usage
</span></span><span style=display:flex><span>    exit
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>image<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>tags<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>wget -q https://registry.hub.docker.com/v1/repositories/<span style=color:#e6db74>${</span>image<span style=color:#e6db74>}</span>/tags -O -  | sed -e <span style=color:#e6db74>&#39;s/[][]//g&#39;</span> -e <span style=color:#e6db74>&#39;s/&#34;//g&#39;</span> -e <span style=color:#e6db74>&#39;s/ //g&#39;</span> | tr <span style=color:#e6db74>&#39;}&#39;</span> <span style=color:#e6db74>&#39;\n&#39;</span>  | awk -F: <span style=color:#e6db74>&#39;{print $3}&#39;</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$2<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    tags<span style=color:#f92672>=</span><span style=color:#e6db74>`</span> echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>tags<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> | grep <span style=color:#e6db74>&#34;</span>$2<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>tags<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 给权限</span>
</span></span><span style=display:flex><span>chmod +x dockertags.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用</span>
</span></span><span style=display:flex><span>./dockertags.sh mysql
</span></span></code></pre></div><h2 id=warning-ipv4-forwarding-is-disabled-networking-will-not-work>WARNING: IPv4 forwarding is disabled. Networking will not work<a href=#warning-ipv4-forwarding-is-disabled-networking-will-not-work class=hanchor arialabel=Anchor>&#8983;</a></h2><p>是没有开启转发,<a href="https://so.csdn.net/so/search?q=docker&amp;spm=1001.2101.3001.7020">docker</a>网桥配置完后，需要开启转发，不然容器启动后，就会没有网络</p><p>修改配置文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># vim /etc/sysctl.conf</span>
</span></span><span style=display:flex><span>net.ipv4.ip_forward<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    <span style=color:#75715e>#添加此行配置</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 重启network和docker服务</span>
</span></span><span style=display:flex><span>systemctl restart network <span style=color:#f92672>&amp;&amp;</span> systemctl restart docker
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看是否修改成功，如果返回为“net.ipv4.ip_forward = 1”则表示修改成功</span>
</span></span><span style=display:flex><span>sysctl net.ipv4.ip_forward
</span></span></code></pre></div><h2 id=常用命令>常用命令<a href=#常用命令 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 查看镜像源,最下面能看到</span>
</span></span><span style=display:flex><span>docker info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看镜像/容器/数据卷所占的空间</span>
</span></span><span style=display:flex><span>docker system df xxx
</span></span></code></pre></div><h1 id=镜像>镜像<a href=#镜像 class=hanchor arialabel=Anchor>&#8983;</a></h1><p><strong>查看镜像</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 列出本地主机上的镜像</span>
</span></span><span style=display:flex><span>docker images
</span></span></code></pre></div><ul><li>REPOSITORY：表示镜像的仓库源</li><li>TAG：镜像的标签</li><li>IMAGE ID：镜像ID</li><li>CREATED：镜像创建时间</li><li>SIZE：镜像大小</li></ul><p><strong>下载镜像</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 查找镜像</span>
</span></span><span style=display:flex><span>docker search ubuntu:13.10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 只是直接下载</span>
</span></span><span style=display:flex><span>docker pull ubuntu:13.10
</span></span></code></pre></div><p><strong>删除镜像</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 删除指定镜像</span>
</span></span><span style=display:flex><span>docker image rm &lt;id&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 删除名字是none的镜像</span>
</span></span><span style=display:flex><span>docker rmi <span style=color:#66d9ef>$(</span>docker images | grep <span style=color:#e6db74>&#34;none&#34;</span> | awk <span style=color:#e6db74>&#39;{print $3}&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 删除全部镜像</span>
</span></span><span style=display:flex><span>docker rmi -f <span style=color:#66d9ef>$(</span>docker image -qa<span style=color:#66d9ef>)</span>
</span></span></code></pre></div><h1 id=容器>容器<a href=#容器 class=hanchor arialabel=Anchor>&#8983;</a></h1><p><strong>运行容器</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run -p 10001:10001 -t springboot/eureka-item
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run -it --rm ubuntu:16.04 bash
</span></span></code></pre></div><ul><li>docker run 运行容器的命令</li><li>-i 以交互模式运行,通常与-t一起使用</li><li>-t 为容器重新分配一个伪输入终端,通常与-i一起使用</li><li>bash 进入交互式终端,通常使用/bin/bash</li><li>-p 指定端口</li><li>-P 随机分配端口</li><li>-d 后台运行容器并返回容器Id,即启动守护式容器</li></ul><p><strong>查看容器</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 查看正在运行的容器</span>
</span></span><span style=display:flex><span>docker ps 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看所有容器</span>
</span></span><span style=display:flex><span>docker ps -a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 列出所有的容器 ID</span>
</span></span><span style=display:flex><span>docker ps -aq
</span></span></code></pre></div><p><strong>启动容器</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span> <span style=color:#75715e>#启动已终止容器</span>
</span></span><span style=display:flex><span> docker container start 05909cd09bf9
</span></span></code></pre></div><p><strong>重启容器</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker restart id
</span></span></code></pre></div><p><strong>停止容器</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 停止容器</span>
</span></span><span style=display:flex><span>docker stop myredis
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 强制停止容器</span>
</span></span><span style=display:flex><span>docker kill myredis
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 停止所有的容器</span>
</span></span><span style=display:flex><span>docker stop <span style=color:#66d9ef>$(</span>docker ps -aq<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 删除所有的容器</span>
</span></span><span style=display:flex><span>docker rm <span style=color:#66d9ef>$(</span>docker ps -aq<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 强制删除,在运行的容器也会删除</span>
</span></span><span style=display:flex><span>docker rm -f myredis
</span></span></code></pre></div><p><strong>容器日志</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker logs xxx 
</span></span></code></pre></div><h2 id=进入容器>进入容器<a href=#进入容器 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 不会启动新的进程,用exit退出,会导致容器的停止</span>
</span></span><span style=display:flex><span>docker attach 5cc239848ce5
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 打开新的终端,启用新的进程,用exit退出,不会导致容器的停止</span>
</span></span><span style=display:flex><span>docker exec -it 5cc239848ce5 /bin/bash
</span></span></code></pre></div><p><strong>进入容器修改时区,需要重启容器</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Asia/Shanghai&#34;</span> &gt; /etc/timezone
</span></span></code></pre></div><h2 id=拷贝文件>拷贝文件<a href=#拷贝文件 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 将主机/www/runoob目录拷贝到容器96f7f14e99ab的/www目录下。</span>
</span></span><span style=display:flex><span>docker cp /www/runoob 96f7f14e99ab:/www/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 将主机/www/runoob目录拷贝到容器96f7f14e99ab中，目录重命名为www</span>
</span></span><span style=display:flex><span>docker cp /www/runoob 96f7f14e99ab:/www
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 将容器96f7f14e99ab的/www目录拷贝到主机的/tmp目录中</span>
</span></span><span style=display:flex><span>docker cp  96f7f14e99ab:/www /tmp/
</span></span></code></pre></div><h2 id=导出入容器>导出/入容器<a href=#导出入容器 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>第一种方式:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 如果要导出本地某个容器，可以使用 docker export 命令。</span>
</span></span><span style=display:flex><span>docker export 1e560fca3906 &gt; ubuntu.tar
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># docker import 从容器快照文件中再导入为镜像，</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 以下实例将快照文件 ubuntu.tar 导入到镜像 test/ubuntu:v1:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 格式: cat 文件名 | docker import - xxx(镜像用户,自定义)/xxx(镜像名,自定义):xxx(版本号自定义)</span>
</span></span><span style=display:flex><span>cat docker/ubuntu.tar | docker import - test/ubuntu:v1
</span></span></code></pre></div><p>第二种方式:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 镜像转文件</span>
</span></span><span style=display:flex><span>docker save -o demo.tar<span style=color:#f92672>(</span>自定义<span style=color:#f92672>)</span> 镜像名:版本号
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 文件转镜像</span>
</span></span><span style=display:flex><span>docker load -i demo.tar
</span></span></code></pre></div><h2 id=commit>Commit<a href=#commit class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker commit -a <span style=color:#e6db74>&#34;runoob.com&#34;</span> -m <span style=color:#e6db74>&#34;my apache&#34;</span> a404c6c174a2  mymysql:v1 
</span></span></code></pre></div><h2 id=过时容器不能上网>过时:容器不能上网<a href=#过时容器不能上网 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vim /etc/sysctl.conf
</span></span><span style=display:flex><span>增加：net.ipv4.ip_forward<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>重启服务：systemctl restart network
</span></span><span style=display:flex><span>查看属性是否修改成功：sysctl net.ipv4.ip_forward
</span></span></code></pre></div><h2 id=过时停止和查看容器>过时:停止和查看容器<a href=#过时停止和查看容器 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#查看所有的容器(已经存在的容器,已经停止的)</span>
</span></span><span style=display:flex><span>docker container ls -a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#停止容器</span>
</span></span><span style=display:flex><span>docker container stop 05909cd09bf9
</span></span></code></pre></div><h2 id=过时jenkins容器脚本>过时:Jenkins容器脚本<a href=#过时jenkins容器脚本 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>APP_NAME<span style=color:#f92672>=</span>springboot/lottery-admin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;当前容器列表&#34;</span>
</span></span><span style=display:flex><span>docker ps -a | grep $APP_NAME
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;star service success!&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>count <span style=color:#f92672>=</span> ’docker ps -a |grep $APP_NAME |wc -l‘
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span>$count -ge 1<span style=color:#f92672>]</span>;<span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>docker stop $APP_NAME
</span></span><span style=display:flex><span>docker rm $APP_NAME
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>appName<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;simons-cloud-eureka&#34;</span>
</span></span><span style=display:flex><span>word<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span>$word<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>word<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>docker ps -a -q --no-trunc --filter name<span style=color:#f92672>=</span>^/<span style=color:#e6db74>&#34;</span>$appName<span style=color:#e6db74>&#34;</span>$<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span>$word<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$word<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;当前不存在该容器，直接进行启动该操作-------------------------------------&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>elif</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$word<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;当前已存在容器，停止并移除该容器-------------------------------------&#34;</span>
</span></span><span style=display:flex><span>/usr/bin/docker stop <span style=color:#e6db74>&#34;</span>$word<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>/usr/bin/docker rm <span style=color:#e6db74>&#34;</span>$word<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>elif</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$word<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;查询的信息有误，执行默认操作-------------------------------------&#34;</span>
</span></span><span style=display:flex><span>/usr/bin/docker stop <span style=color:#e6db74>&#34;</span>$word<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>/usr/bin/docker rm <span style=color:#e6db74>&#34;</span>$word<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>docker run -p 8761:8761 -d --name <span style=color:#e6db74>&#34;</span>$appName<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span>$appName<span style=color:#e6db74>&#34;</span>:latest
</span></span></code></pre></div><h1 id=挂载目录>挂载目录<a href=#挂载目录 class=hanchor arialabel=Anchor>&#8983;</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run -it --privileged<span style=color:#f92672>=</span>true -v /tmp/host_data:/tmp/docker_data --name<span style=color:#f92672>=</span>u1 ubuntu
</span></span><span style=display:flex><span><span style=color:#75715e># --privileged=true 用来扩容权限用的,最好是加上</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -v 宿主目录:容器目录,运行容器的时候,会自动创建目录</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看挂载情况</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;Mounts&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Type&#34;</span>: <span style=color:#e6db74>&#34;bind&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Source&#34;</span>: <span style=color:#e6db74>&#34;/tmp/host_data&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Destination&#34;</span>: <span style=color:#e6db74>&#34;/tmp/docker_data&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Mode&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;RW&#34;</span>: true,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Propagation&#34;</span>: <span style=color:#e6db74>&#34;rprivate&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 继承挂载</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 再启动一个容器,起名叫u2,u2的挂载目录,跟u1的一样,就继承u1的挂载目录</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 特点是,就算u1停了,也不会影响这个</span>
</span></span><span style=display:flex><span>docker run -it --privileged<span style=color:#f92672>=</span>true --volumes-fron u1 --name<span style=color:#f92672>=</span>u2 ubuntu
</span></span></code></pre></div><h1 id=dcokerfile>Dcokerfile<a href=#dcokerfile class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=expose>Expose<a href=#expose class=hanchor arialabel=Anchor>&#8983;</a></h2><p>暴露端口</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># GET_IMAGE</span>
</span></span><span style=display:flex><span>FROM 192.168.0.216:5000/centos
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e># MAINTAINER_INFO</span>
</span></span><span style=display:flex><span>MAINTAINER hongxue hongxue@showjoy.com
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>RUN yum -y install vim
</span></span><span style=display:flex><span>RUN yum -y install net-tools
</span></span><span style=display:flex><span>RUN yum -y install openssh-server
</span></span><span style=display:flex><span>RUN yum -y install wget curl
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e># PORT</span>
</span></span><span style=display:flex><span>EXPOSE <span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span>EXPOSE <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>EXPOSE <span style=color:#ae81ff>8009</span>
</span></span><span style=display:flex><span>EXPOSE <span style=color:#ae81ff>8005</span>
</span></span><span style=display:flex><span>EXPOSE <span style=color:#ae81ff>8443</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -d -it -P --name port_list_container port_list
</span></span></code></pre></div><ul><li>要使用-P ,绑定的宿主端口,会是随机的</li><li>所以Dockerfile的EXPOSE的主要功能,也只是给运维人员看看的</li></ul><h1 id=网络>网络<a href=#网络 class=hanchor arialabel=Anchor>&#8983;</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 查看Docker网络,默认的3大网络模式</span>
</span></span><span style=display:flex><span>root@anthony:~# docker network ls
</span></span><span style=display:flex><span>NETWORK ID     NAME      DRIVER    SCOPE
</span></span><span style=display:flex><span>a4154cc357c5   bridge    bridge    local
</span></span><span style=display:flex><span>6625ad672ae9   host      host      local
</span></span><span style=display:flex><span>497caf91f24e   none      null      local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 创建一个网络</span>
</span></span><span style=display:flex><span>docker network create xxxx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 删除一个网络</span>
</span></span><span style=display:flex><span>docker network rm xxxx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看网络</span>
</span></span><span style=display:flex><span>docker network inspect xxx 
</span></span><span style=display:flex><span>root@anthony:~# docker network inspect bridge
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Name&#34;</span>: <span style=color:#e6db74>&#34;bridge&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Id&#34;</span>: <span style=color:#e6db74>&#34;a4154cc357c50d0ac961d8235101d8e199119d5677b911ca84ff49962039a53a&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Created&#34;</span>: <span style=color:#e6db74>&#34;2023-10-27T00:40:28.869797225Z&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Scope&#34;</span>: <span style=color:#e6db74>&#34;local&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Driver&#34;</span>: <span style=color:#e6db74>&#34;bridge&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;EnableIPv6&#34;</span>: false,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;IPAM&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;Driver&#34;</span>: <span style=color:#e6db74>&#34;default&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;Options&#34;</span>: null,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;Config&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;Subnet&#34;</span>: <span style=color:#e6db74>&#34;172.17.0.0/16&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;Gateway&#34;</span>: <span style=color:#e6db74>&#34;172.17.0.1&#34;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Internal&#34;</span>: false,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Attachable&#34;</span>: false,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Ingress&#34;</span>: false,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ConfigFrom&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;Network&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;ConfigOnly&#34;</span>: false,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Containers&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;a59c6dd9d8bbdbc4f760389bd85af69786e632e6bd1d346c542d6886f572872b&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;Name&#34;</span>: <span style=color:#e6db74>&#34;u1&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;EndpointID&#34;</span>: <span style=color:#e6db74>&#34;e54ed02028a063b38390abac5306cba4f97ff40135b0cfab2370c950f5ae11dc&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;MacAddress&#34;</span>: <span style=color:#e6db74>&#34;02:42:ac:11:00:02&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;IPv4Address&#34;</span>: <span style=color:#e6db74>&#34;172.17.0.2/16&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;IPv6Address&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;b5615376be36a2b28485a93fa62d10d9886c53c9f59c5fbcd00de78b0184d6b7&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;Name&#34;</span>: <span style=color:#e6db74>&#34;tomcat&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;EndpointID&#34;</span>: <span style=color:#e6db74>&#34;23688ac53c0f16a8abd20bbe4e64539266645019ce95501253577cf57fc71b7a&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;MacAddress&#34;</span>: <span style=color:#e6db74>&#34;02:42:ac:11:00:03&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;IPv4Address&#34;</span>: <span style=color:#e6db74>&#34;172.17.0.3/16&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;IPv6Address&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Options&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;com.docker.network.bridge.default_bridge&#34;</span>: <span style=color:#e6db74>&#34;true&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;com.docker.network.bridge.enable_icc&#34;</span>: <span style=color:#e6db74>&#34;true&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;com.docker.network.bridge.enable_ip_masquerade&#34;</span>: <span style=color:#e6db74>&#34;true&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;com.docker.network.bridge.host_binding_ipv4&#34;</span>: <span style=color:#e6db74>&#34;0.0.0.0&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#75715e># 网桥名字</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;com.docker.network.bridge.name&#34;</span>: <span style=color:#e6db74>&#34;docker0&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;com.docker.network.driver.mtu&#34;</span>: <span style=color:#e6db74>&#34;1500&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Labels&#34;</span>: <span style=color:#f92672>{}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><h1 id=docker-compose>docker-compose<a href=#docker-compose class=hanchor arialabel=Anchor>&#8983;</a></h1><p><a href=https://www.runoob.com/docker/docker-compose.html>Docker Compose</a></p><h2 id=安装>安装<a href=#安装 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 可以修改版本 </span>
</span></span><span style=display:flex><span>curl -L <span style=color:#e6db74>&#34;https://github.com/docker/compose/releases/download/v2.23.0/docker-compose-</span><span style=color:#66d9ef>$(</span>uname -s<span style=color:#66d9ef>)</span><span style=color:#e6db74>-</span><span style=color:#66d9ef>$(</span>uname -m<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> -o /usr/local/bin/docker-compose
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 给权限</span>
</span></span><span style=display:flex><span>sudo chmod +x /usr/local/bin/docker-compose
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 超链接</span>
</span></span><span style=display:flex><span>sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 验证</span>
</span></span><span style=display:flex><span>docker-compose --version
</span></span></code></pre></div><h2 id=命令>命令<a href=#命令 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 启动</span>
</span></span><span style=display:flex><span>docker-compose up
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 后台启动</span>
</span></span><span style=display:flex><span>docker-compose up -d
</span></span></code></pre></div><h2 id=部署到私有仓库>部署到私有仓库<a href=#部署到私有仓库 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>//位置
</span></span><span style=display:flex><span>gedit /etc/default/docker
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>//添加的命令
</span></span><span style=display:flex><span>DOCKER_OPTS<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;–insecure-registry 172.20.100.211:5000&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>//重启
</span></span><span style=display:flex><span>service docker restart
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>//打tag
</span></span><span style=display:flex><span>docker tag springboot/eureka-item 172.20.100.211:5000/anthonyfirst
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>//推送
</span></span><span style=display:flex><span>docker push 172.20.100.211:5000/anthonyfirst
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>//获取私有仓库里的信息
</span></span><span style=display:flex><span>curl -XGET http://172.20.100.211:5000/v2/_catalog
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#客户端配置私有仓库</span>
</span></span><span style=display:flex><span>修改/etc/sysconfig/docker（Ubuntu下配置文件地址为：/etc/init/docker.conf），增加启动选项<span style=color:#f92672>(</span>已有参数的在后面追加<span style=color:#f92672>)</span>，之后重启docker，不添加报错，https证书问题。
</span></span><span style=display:flex><span>OPTIONS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;--insecure-registry 172.20.100.211:5000&#39;</span> <span style=color:#75715e>#CentOS 7系统</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#重启服务</span>
</span></span><span style=display:flex><span>systemctl daemon-reload
</span></span><span style=display:flex><span>systemctl restart docker
</span></span></code></pre></div><h1 id=报错信息>报错信息<a href=#报错信息 class=hanchor arialabel=Anchor>&#8983;</a></h1><h3 id=1缺少fontconfiguration>1.缺少FontConfiguration<a href=#1缺少fontconfiguration class=hanchor arialabel=Anchor>&#8983;</a></h3><p>知道是因为alpine中缺少FontConfiguration，那么就考虑安装ttf-dejavu这个软件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>NullPointerException</span>
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>FontConfiguration</span>.<span style=color:#a6e22e>getVersion</span>(FontConfiguration.<span style=color:#a6e22e>java</span>:1264)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>FontConfiguration</span>.<span style=color:#a6e22e>readFontConfigFile</span>(FontConfiguration.<span style=color:#a6e22e>java</span>:219)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>FontConfiguration</span>.<span style=color:#a6e22e>init</span>(FontConfiguration.<span style=color:#a6e22e>java</span>:107)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>X11FontManager</span>.<span style=color:#a6e22e>createFontConfiguration</span>(X11FontManager.<span style=color:#a6e22e>java</span>:774)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>font</span>.<span style=color:#a6e22e>SunFontManager$2</span>.<span style=color:#a6e22e>run</span>(SunFontManager.<span style=color:#a6e22e>java</span>:431)
</span></span><span style=display:flex><span>    at java.<span style=color:#a6e22e>security</span>.<span style=color:#a6e22e>AccessController</span>.<span style=color:#a6e22e>doPrivileged</span>(Native Method)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>font</span>.<span style=color:#a6e22e>SunFontManager</span>.<span style=color:#f92672>&lt;</span>init<span style=color:#f92672>&gt;</span>(SunFontManager.<span style=color:#a6e22e>java</span>:376)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>FcFontManager</span>.<span style=color:#f92672>&lt;</span>init<span style=color:#f92672>&gt;</span>(FcFontManager.<span style=color:#a6e22e>java</span>:35)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>X11FontManager</span>.<span style=color:#f92672>&lt;</span>init<span style=color:#f92672>&gt;</span>(X11FontManager.<span style=color:#a6e22e>java</span>:57)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>reflect</span>.<span style=color:#a6e22e>NativeConstructorAccessorImpl</span>.<span style=color:#a6e22e>newInstance0</span>(Native Method)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>reflect</span>.<span style=color:#a6e22e>NativeConstructorAccessorImpl</span>.<span style=color:#a6e22e>newInstance</span>(NativeConstructorAccessorImpl.<span style=color:#a6e22e>java</span>:62)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>reflect</span>.<span style=color:#a6e22e>DelegatingConstructorAccessorImpl</span>.<span style=color:#a6e22e>newInstance</span>(DelegatingConstructorAccessorImpl.<span style=color:#a6e22e>java</span>:45)
</span></span><span style=display:flex><span>    at java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>reflect</span>.<span style=color:#a6e22e>Constructor</span>.<span style=color:#a6e22e>newInstance</span>(Constructor.<span style=color:#a6e22e>java</span>:423)
</span></span><span style=display:flex><span>    at java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>Class</span>.<span style=color:#a6e22e>newInstance</span>(Class.<span style=color:#a6e22e>java</span>:442)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>font</span>.<span style=color:#a6e22e>FontManagerFactory$1</span>.<span style=color:#a6e22e>run</span>(FontManagerFactory.<span style=color:#a6e22e>java</span>:83)
</span></span><span style=display:flex><span>    at java.<span style=color:#a6e22e>security</span>.<span style=color:#a6e22e>AccessController</span>.<span style=color:#a6e22e>doPrivileged</span>(Native Method)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>font</span>.<span style=color:#a6e22e>FontManagerFactory</span>.<span style=color:#a6e22e>getInstance</span>(FontManagerFactory.<span style=color:#a6e22e>java</span>:74)
</span></span><span style=display:flex><span>    at java.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>Font</span>.<span style=color:#a6e22e>getFont2D</span>(Font.<span style=color:#a6e22e>java</span>:491)
</span></span><span style=display:flex><span>    at java.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>Font</span>.<span style=color:#a6e22e>access$000</span>(Font.<span style=color:#a6e22e>java</span>:224)
</span></span><span style=display:flex><span>    at java.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>Font$FontAccessImpl</span>.<span style=color:#a6e22e>getFont2D</span>(Font.<span style=color:#a6e22e>java</span>:228)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>font</span>.<span style=color:#a6e22e>FontUtilities</span>.<span style=color:#a6e22e>getFont2D</span>(FontUtilities.<span style=color:#a6e22e>java</span>:180)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>font</span>.<span style=color:#a6e22e>StandardGlyphVector</span>.<span style=color:#a6e22e>initFontData</span>(StandardGlyphVector.<span style=color:#a6e22e>java</span>:1126)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>font</span>.<span style=color:#a6e22e>StandardGlyphVector</span>.<span style=color:#a6e22e>init</span>(StandardGlyphVector.<span style=color:#a6e22e>java</span>:1115)
</span></span><span style=display:flex><span>    at sun.<span style=color:#a6e22e>font</span>.<span style=color:#a6e22e>StandardGlyphVector</span>.<span style=color:#f92672>&lt;</span>init<span style=color:#f92672>&gt;</span>(StandardGlyphVector.<span style=color:#a6e22e>java</span>:167)
</span></span><span style=display:flex><span>    at java.<span style=color:#a6e22e>awt</span>.<span style=color:#a6e22e>Font</span>.<span style=color:#a6e22e>createGlyphVector</span>(Font.<span style=color:#a6e22e>java</span>:2545)
</span></span><span style=display:flex><span>    at nl.<span style=color:#a6e22e>captcha</span>.<span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>renderer</span>.<span style=color:#a6e22e>DefaultWordRenderer</span>.<span style=color:#a6e22e>render</span>(Unknown Source)
</span></span><span style=display:flex><span>    at nl.<span style=color:#a6e22e>captcha</span>.<span style=color:#a6e22e>Captcha$Builder</span>.<span style=color:#a6e22e>addText</span>(Unknown Source)
</span></span><span style=display:flex><span>    at com.<span style=color:#a6e22e>liferay</span>.<span style=color:#a6e22e>portal</span>.<span style=color:#a6e22e>captcha</span>.<span style=color:#a6e22e>simplecaptcha</span>.<span style=color:#a6e22e>SimpleCaptchaImpl</span>.<span style=color:#a6e22e>getSimpleCaptcha</span>(SimpleCaptchaImpl.<span style=color:#a6e22e>java</span>:243)
</span></span><span style=display:flex><span>    at com.<span style=color:#a6e22e>liferay</span>.<span style=color:#a6e22e>portal</span>.<span style=color:#a6e22e>captcha</span>.<span style=color:#a6e22e>simplecaptcha</span>.<span style=color:#a6e22e>SimpleCaptchaImpl</span>.<span style=color:#a6e22e>serveImage</span>(SimpleCaptchaImpl.<span style=color:#a6e22e>java</span>:159)
</span></span><span style=display:flex><span>    at com.<span style=color:#a6e22e>liferay</span>.<span style=color:#a6e22e>portal</span>.<span style=color:#a6e22e>captcha</span>.<span style=color:#a6e22e>CaptchaImpl</span>.<span style=color:#a6e22e>serveImage</span>(CaptchaImpl.<span style=color:#a6e22e>java</span>:100)
</span></span><span style=display:flex><span>    at com.<span style=color:#a6e22e>liferay</span>.<span style=color:#a6e22e>portal</span>.<span style=color:#a6e22e>kernel</span>.<span style=color:#a6e22e>captcha</span>.<span style=color:#a6e22e>CaptchaUtil</span>.<span style=color:#a6e22e>serveImage</span>(CaptchaUtil.<span style=color:#a6e22e>java</span>:78)
</span></span><span style=display:flex><span>    at com.<span style=color:#a6e22e>liferay</span>.<span style=color:#a6e22e>portal</span>.<span style=color:#a6e22e>captcha</span>.<span style=color:#a6e22e>CaptchaPortletAction</span>.<span style=color:#a6e22e>serveResource</span>(CaptchaPortletAction.<span style=color:#a6e22e>java</span>:42)
</span></span></code></pre></div><p>原本的dockerfile</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-docker data-lang=docker><span style=display:flex><span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> openjdk:8-jdk-alpine</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>VOLUME</span><span style=color:#e6db74> /tmp</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ADD</span> agent-0.0.1-SNAPSHOT.jar app.jar<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENTRYPOINT</span> [<span style=color:#e6db74>&#34;java&#34;</span>,<span style=color:#e6db74>&#34;-Djava.security.egd=file:/dev/./urandom&#34;</span>,<span style=color:#e6db74>&#34;-jar&#34;</span>,<span style=color:#e6db74>&#34;/app.jar&#34;</span>]<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>要改成下面这样<code>RUN apk --update add fontconfig ttf-dejavu</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-docker data-lang=docker><span style=display:flex><span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> openjdk:8-jdk-alpine</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>VOLUME</span><span style=color:#e6db74> /tmp</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ADD</span> agent-0.0.1-SNAPSHOT.jar app.jar<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> apk --update add fontconfig ttf-dejavu<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>ENTRYPOINT</span> [<span style=color:#e6db74>&#34;java&#34;</span>,<span style=color:#e6db74>&#34;-Djava.security.egd=file:/dev/./urandom&#34;</span>,<span style=color:#e6db74>&#34;-jar&#34;</span>,<span style=color:#e6db74>&#34;/app.jar&#34;</span>]<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><h3 id=2warning-hk2-service-reification-failed-for>2.<strong>WARNING: HK2 service reification failed for&mldr;</strong><a href=#2warning-hk2-service-reification-failed-for class=hanchor arialabel=Anchor>&#8983;</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>NoClassDefFoundError</span>: javax<span style=color:#f92672>/</span>activation<span style=color:#f92672>/</span>DataSource
</span></span><span style=display:flex><span>				at java.<span style=color:#a6e22e>base</span><span style=color:#f92672>/</span>java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>Class</span>.<span style=color:#a6e22e>getDeclaredConstructors0</span>(Native Method)
</span></span><span style=display:flex><span>				at java.<span style=color:#a6e22e>base</span><span style=color:#f92672>/</span>java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>Class</span>.<span style=color:#a6e22e>privateGetDeclaredConstructors</span>(Class.<span style=color:#a6e22e>java</span>:3110)
</span></span><span style=display:flex><span>				at java.<span style=color:#a6e22e>base</span><span style=color:#f92672>/</span>java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>Class</span>.<span style=color:#a6e22e>getDeclaredConstructors</span>(Class.<span style=color:#a6e22e>java</span>:2314)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>Utilities$3</span>.<span style=color:#a6e22e>run</span>(Utilities.<span style=color:#a6e22e>java</span>:1310)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>Utilities$3</span>.<span style=color:#a6e22e>run</span>(Utilities.<span style=color:#a6e22e>java</span>:1306)
</span></span><span style=display:flex><span>				at java.<span style=color:#a6e22e>base</span><span style=color:#f92672>/</span>java.<span style=color:#a6e22e>security</span>.<span style=color:#a6e22e>AccessController</span>.<span style=color:#a6e22e>doPrivileged</span>(Native Method)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>Utilities</span>.<span style=color:#a6e22e>getAllConstructors</span>(Utilities.<span style=color:#a6e22e>java</span>:1306)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>Utilities</span>.<span style=color:#a6e22e>findProducerConstructor</span>(Utilities.<span style=color:#a6e22e>java</span>:1249)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>DefaultClassAnalyzer</span>.<span style=color:#a6e22e>getConstructor</span>(DefaultClassAnalyzer.<span style=color:#a6e22e>java</span>:83)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>glassfish</span>.<span style=color:#a6e22e>jersey</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>inject</span>.<span style=color:#a6e22e>JerseyClassAnalyzer</span>.<span style=color:#a6e22e>getConstructor</span>(JerseyClassAnalyzer.<span style=color:#a6e22e>java</span>:144)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>Utilities</span>.<span style=color:#a6e22e>getConstructor</span>(Utilities.<span style=color:#a6e22e>java</span>:178)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>ClazzCreator</span>.<span style=color:#a6e22e>initialize</span>(ClazzCreator.<span style=color:#a6e22e>java</span>:128)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>ClazzCreator</span>.<span style=color:#a6e22e>initialize</span>(ClazzCreator.<span style=color:#a6e22e>java</span>:179)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>SystemDescriptor</span>.<span style=color:#a6e22e>internalReify</span>(SystemDescriptor.<span style=color:#a6e22e>java</span>:723)
</span></span><span style=display:flex><span>				at org.<span style=color:#a6e22e>jvnet</span>.<span style=color:#a6e22e>hk2</span>.<span style=color:#a6e22e>internal</span>.<span style=color:#a6e22e>SystemDescriptor</span>.<span style=color:#a6e22e>reify</span>(SystemDescriptor.<span style=color:#a6e22e>java</span>:678)
</span></span></code></pre></div><p>在pom.xml里添加</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;groupId&gt;</span>com.spotify<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;artifactId&gt;</span>dockerfile-maven-plugin<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>		// ......
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;dependencies&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;groupId&gt;</span>javax.activation<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;artifactId&gt;</span>activation<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;version&gt;</span>1.1.1<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/dependencies&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/plugin&gt;</span>
</span></span></code></pre></div><h3 id=3不能链接daemon>3.不能链接daemon<a href=#3不能链接daemon class=hanchor arialabel=Anchor>&#8983;</a></h3><p>服务没有启动,运行docker,会报这个错</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?.
</span></span></code></pre></div><p>需要启动docker service</p><pre tabindex=0><code>service docker start
</code></pre><h1 id=安装软件>安装软件<a href=#安装软件 class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=安装jenkins>安装Jenkins<a href=#安装jenkins class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run -d <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		-u root <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		-v /var/run/docker.sock:/var/run/docker.sock <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		-v <span style=color:#66d9ef>$(</span>which docker<span style=color:#66d9ef>)</span>:/usr/bin/docker <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		-p 8080:8080 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		-p 50000:50000 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		-v /home/jenkins:/var/jenkins_home <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		--restart<span style=color:#f92672>=</span>always <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		--name jenkins <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		jenkins/jenkins:lts
</span></span><span style=display:flex><span>		
</span></span><span style=display:flex><span><span style=color:#75715e># 查看密码</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 容器里的位置</span>
</span></span><span style=display:flex><span>cat /var/jenkins_home/secrets/initialAdminPassword
</span></span><span style=display:flex><span><span style=color:#75715e># 宿主机的位置</span>
</span></span><span style=display:flex><span>cat /root/jenkins/secrets/initialAdminPassword
</span></span></code></pre></div><p>4.安装插件完之后,安装maven插件,在主机上下载maven,上传到容器中</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker cp maven-3.6.0 jenkins:/usr/local/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// 上传本机的配置文件
</span></span><span style=display:flex><span>docker cp settings.xml jenkins:/home/
</span></span></code></pre></div><p>5.进入容器</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>// 普通用户的权限
</span></span><span style=display:flex><span>docker exec -it jenkins bash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// sudo的用户权限
</span></span><span style=display:flex><span>docker exec -it -u <span style=color:#ae81ff>0</span> jenkins bash
</span></span></code></pre></div><p>6.从本机拷贝到容器,是不需要用到权限的,但是在容器内,比如从/home下的文件移动到/root 就需要权限,就需要使用 -u 0</p><blockquote><p>在Docker容器的Jenkins,构建SpringBoot 的jar包
再执行Shell运行的时候,连接数据库可能有坑,数据库会连不上</p></blockquote><h2 id=安装elasticsearch>安装ElasticSearch<a href=#安装elasticsearch class=hanchor arialabel=Anchor>&#8983;</a></h2><pre tabindex=0><code>docker run -d --name es -p 9200:9200 -p 9300:9300 -e &#34;discovery.type=single-node&#34; docker.elastic.co/elasticsearch/elasticsearch:6.3.2

docker exec -it es /bin/bash

cd config

vi elasticsearch.yml

# 加入跨域配置
http.cors.enabled: true
http.cors.allow-origin: &#34;*&#34;

docker restart es
</code></pre><h2 id=安装portainer>安装Portainer<a href=#安装portainer class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 创建数据卷</span>
</span></span><span style=display:flex><span>docker volume create portainer_data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 9000才是web访问的端口</span>
</span></span><span style=display:flex><span>docker run -d <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      -p 8000:8000 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      -p 9000:9000 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      -p 9443:9443 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      --name portainer <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      --restart<span style=color:#f92672>=</span>always <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      -v /var/run/docker.sock:/var/run/docker.sock <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      -v /docker/portainer:/data <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>      portainer/portainer-ce:2.21.1
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>yourdomain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://localhost:9000</span>;  <span style=color:#75715e># 将请求转发到 Portainer 后端
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Host</span> $host;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Real-IP</span> $remote_addr;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Forwarded-For</span> $proxy_add_x_forwarded_for;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Forwarded-Proto</span> $scheme;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># WebSocket 支持
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>proxy_http_version</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>.1</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Upgrade</span> $http_upgrade;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Connection</span> <span style=color:#e6db74>&#34;upgrade&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=添加docker-node>添加docker node<a href=#添加docker-node class=hanchor arialabel=Anchor>&#8983;</a></h2><p><a href=https://blog.csdn.net/bj_chengrong/article/details/90300972>https://blog.csdn.net/bj_chengrong/article/details/90300972</a></p><h2 id=安装redis>安装Redis<a href=#安装redis class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 简单的执行</span>
</span></span><span style=display:flex><span>docker run -itd <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     --name redis <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     --restart<span style=color:#f92672>=</span>always <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     -p 6379:6379 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     redis
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 持久化执行</span>
</span></span><span style=display:flex><span>docker run -d <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           --name redis <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -p 6379:6379 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -v /docker/redis/config/redis.conf:/usr/local/etc/redis/redis.conf <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -v /docker/redis/data:/data <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           --restart<span style=color:#f92672>=</span>always <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           redis redis-server /usr/local/etc/redis/redis.conf
</span></span></code></pre></div><p>新建<code>redis.conf</code>,位置在:<code>/docker/redis/config/redis.conf</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>#启用 RDB 快照持久化</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>save 900 1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>save 300 10</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>save 60 10000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#启用 AOF 持久化</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>appendonly yes</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>appendfsync everysec</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#设置持久化目录</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>dir /data</span>
</span></span></code></pre></div><h2 id=安装mysql>安装Mysql<a href=#安装mysql class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 正式配置</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 在对应目录先创建my.cnf文件, 不然系统会自动创建my.cnf文件夹....</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 本地对应的目录文件夹会自动创建</span>
</span></span><span style=display:flex><span>docker run -itd <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           --name mysql <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -p 3306:3306 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -e MYSQL_ROOT_PASSWORD<span style=color:#f92672>=</span><span style=color:#ae81ff>123456</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -v /Users/anthony/docker/mysql/config/my.cnf:/etc/mysql/conf.d/my.cnf <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -v /Users/anthony/docker/mysql/data:/var/lib/mysql <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           --restart<span style=color:#f92672>=</span>always  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           mysql
</span></span></code></pre></div><p>最简单的my.cnf配置文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>[<span style=color:#ae81ff>mysqld]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 时区</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>default-time-zone=+08:00</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 字符集</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>character-set-server=utf8mb4</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 创建函数/存过的时候,会报安全问题,不用存过/函数,不用管</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>log_bin_trust_function_creators=1;</span>
</span></span></code></pre></div><blockquote><p>容器文档:<a href=https://hub.docker.com/_/mysql/>Mysql</a></p></blockquote><h2 id=安装-nginx>安装 Nginx<a href=#安装-nginx class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-docker data-lang=docker><span style=display:flex><span><span style=color:#75715e># 简单的</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker run --name nginx-test <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     -p 8080:80 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     -d <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     nginx<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># 正式的</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>docker run -d <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -p 443:443 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -p 80:80 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           --name nginx <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -v /home/nginx/www:/usr/share/nginx/html <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -v /home/nginx/conf/nginx.conf:/etc/nginx/nginx.conf <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           -v /home/nginx/logs:/var/log/nginx <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>           nginx<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>nginx.conf模板</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 用户 nginx 使用的工作进程</span>
</span></span><span style=display:flex><span>user nginx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 允许的工作进程数，自动检测 CPU 核心数</span>
</span></span><span style=display:flex><span>worker_processes auto;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 错误日志路径和日志级别</span>
</span></span><span style=display:flex><span>error_log /var/log/nginx/error.log warn;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># PID 文件路径</span>
</span></span><span style=display:flex><span>pid /var/run/nginx.pid;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>events <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 单个工作进程允许的最大连接数</span>
</span></span><span style=display:flex><span>    worker_connections 1024;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>http <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    include /etc/nginx/mime.types;
</span></span><span style=display:flex><span>    default_type application/octet-stream;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 日志格式配置</span>
</span></span><span style=display:flex><span>    log_format main <span style=color:#e6db74>&#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; &#39;</span>
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;</span>
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 访问日志路径</span>
</span></span><span style=display:flex><span>    access_log /var/log/nginx/access.log main;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 启用 Gzip 压缩</span>
</span></span><span style=display:flex><span>    gzip on;
</span></span><span style=display:flex><span>    gzip_disable <span style=color:#e6db74>&#34;msie6&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 启用发送文件优化</span>
</span></span><span style=display:flex><span>    sendfile on;
</span></span><span style=display:flex><span>    tcp_nopush on;
</span></span><span style=display:flex><span>    tcp_nodelay on;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    keepalive_timeout 65;
</span></span><span style=display:flex><span>    types_hash_max_size 2048;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    include /etc/nginx/conf.d/*.conf;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 默认服务器配置</span>
</span></span><span style=display:flex><span>    server <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        listen <span style=color:#ae81ff>80</span> default_server;
</span></span><span style=display:flex><span>        server_name localhost;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 站点根目录</span>
</span></span><span style=display:flex><span>        root /usr/share/nginx/html;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 主页文件</span>
</span></span><span style=display:flex><span>        index index.html index.htm;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 处理静态文件请求</span>
</span></span><span style=display:flex><span>        location / <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            try_files $uri $uri/ <span style=color:#f92672>=</span>404;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 配置反向代理</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 如果你需要反向代理到一个后端服务，可以启用以下代码：</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># location /api/ {</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#     proxy_pass http://backend_service;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#     proxy_set_header Host $host;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#     proxy_set_header X-Real-IP $remote_addr;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#     proxy_set_header X-Forwarded-Proto $scheme;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># }</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 错误页面</span>
</span></span><span style=display:flex><span>        error_page <span style=color:#ae81ff>500</span> <span style=color:#ae81ff>502</span> <span style=color:#ae81ff>503</span> <span style=color:#ae81ff>504</span> /50x.html;
</span></span><span style=display:flex><span>        location <span style=color:#f92672>=</span> /50x.html <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            root /usr/share/nginx/html;
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=安装nexus-3>安装nexus 3<a href=#安装nexus-3 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 创建数据文件夹</span>
</span></span><span style=display:flex><span>mkdir /docker/nexus3/nexus-data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果有权限问题</span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>777</span> /docker/nexus3/nexus-data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>docker run -d <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     -p 8081:8081 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     --name nexus <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     -v /docker/nexus3/nexus-data:/nexus-data <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     --restart<span style=color:#f92672>=</span>always <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     sonatype/nexus3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看密码</span>
</span></span><span style=display:flex><span>cat /docker/nexus3/nexus-data/admin.password
</span></span></code></pre></div><h2 id=安装elastic-search>安装Elastic Search<a href=#安装elastic-search class=hanchor arialabel=Anchor>&#8983;</a></h2><pre tabindex=0><code>docker run -itd \
    -p 9200:9200 \
    -p 9300:9300 \
    -e &#34;discovery.type=single-node&#34; \
       -v /home/anthony/es/config:/usr/share/elasticsearch/config/ \
       --name elasticsearch \
       --restart=always \
       docker.elastic.co/elasticsearch/elasticsearch:7.7.0
</code></pre><h2 id=安装zookeeper>安装Zookeeper<a href=#安装zookeeper class=hanchor arialabel=Anchor>&#8983;</a></h2><pre tabindex=0><code>docker run -d -p 2181:2181 --name some-zookeeper --restart=always zookeeper
</code></pre><p><a href=https://github.com/vran-dev/PrettyZoo.git>安装可视化软件</a></p><p>mac安装的使用要查看下说明文档,会出现安装包损坏的情况</p><h2 id=安装grafana>安装Grafana<a href=#安装grafana class=hanchor arialabel=Anchor>&#8983;</a></h2><pre tabindex=0><code># admin / admin
docker run -d -p 3000:3000 --name=grafana grafana/grafana
</code></pre><h2 id=安装wordpress>安装WordPress<a href=#安装wordpress class=hanchor arialabel=Anchor>&#8983;</a></h2><p><a href=https://blog.csdn.net/shangyexin/article/details/106311376>docker-compose安装WordPress</a></p><h2 id=安装禅道>安装禅道<a href=#安装禅道 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 内置数据库</span>
</span></span><span style=display:flex><span>docker run -d -v &lt;你的宿主机目录&gt;/data:/data -p 80:80 -e MYSQL_INTERNAL<span style=color:#f92672>=</span>true hub.zentao.net/app/zentao 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 外接数据库,web页面的安装向导,点击确定之后要等一会</span>
</span></span><span style=display:flex><span>docker run -itd <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -v /docker/zentao/data:/data <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -p 8001:80 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -e MYSQL_INTERNAL<span style=color:#f92672>=</span>false <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -e ZT_MYSQL_HOST<span style=color:#f92672>=</span>172.17.0.3 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -e ZT_MYSQL_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>3306</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -e ZT_MYSQL_USER<span style=color:#f92672>=</span>root <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -e ZT_MYSQL_PASSWORD<span style=color:#f92672>=</span>Qwer1234. <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -e ZT_MYSQL_DB<span style=color:#f92672>=</span>zentao <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --restart<span style=color:#f92672>=</span>always <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --name zentao <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    hub.zentao.net/app/zentao 
</span></span></code></pre></div><p><a href=https://www.zentao.net/book/zentaopms/docker-1111.html#15>禅道官方文档</a></p><h2 id=安装nacos>安装Nacos<a href=#安装nacos class=hanchor arialabel=Anchor>&#8983;</a></h2><p>mac docker 安装nacos</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run -d <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		   -p 8848:8848 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		   --env MODE<span style=color:#f92672>=</span>standalone  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		   --name nacos  <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>		   zhusaidong/nacos-server-m1:2.0.3
</span></span></code></pre></div><p>访问地址：http://localhost:8848/nacos/</p><p>账号/密码：nacos/nacos</p><blockquote><p><a href=https://nacos.io/zh-cn/docs/v2/quickstart/quick-start-docker.html>Nacos官方文档</a></p></blockquote></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=../../posts/datagrip/><span class=button__icon>←</span>
<span class=button__text>DataGrip</span>
</a></span><span class="button next"><a href=../../posts/elasticsearch/><span class=button__text>ElasticSearch</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2025 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/mirus-ua/hugo-theme-re-terminal target=_blank>Theme</a> made by <a href=https://github.com/mirus-ua target=_blank>Mirus</a></span></div></div></footer><script type=text/javascript src=../../bundle.min.js></script></div></body></html>