<!doctype html><html lang=zh><head><title>Posts :: Hello World</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://connorzhangyu.com/posts/><link rel=stylesheet href=https://connorzhangyu.com/styles.css><link rel="shortcut icon" href=https://connorzhangyu.com/img/theme-colors/orange.png><link rel=apple-touch-icon href=https://connorzhangyu.com/img/theme-colors/orange.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="zh"><meta property="og:type" content="website"><meta property="og:title" content="Posts"><meta property="og:description" content><meta property="og:url" content="https://connorzhangyu.com/posts/"><meta property="og:site_name" content="Hello World"><meta property="og:image" content="https://connorzhangyu.com/img/favicon/orange.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/posts/index.xml rel=alternate type=application/rss+xml title="Hello World"></head><body class=orange><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>康纳的记仇小本本</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>关于</a></li><li><a href=/showcase>精选</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>关于</a></li><li><a href=/showcase>精选</a></li></ul></nav></header><div class=content><div class=posts><article class="post on-list"><h1 class=post-title><a href=https://connorzhangyu.com/posts/11143717-ed32-46f5-9ce6-5b4945a0c69b/>使用 Docker 和 CI/CD 实现 Java 服务与 Nginx Proxy Manager 的自动化部署</a></h1><div class=post-meta><time class=post-date>2024-12-06</time><span class=post-author>Connor</span></div><div class=post-content><h1 id=使用-docker-和-cicd-实现-java-服务与-nginx-proxy-manager-的自动化部署>使用 Docker 和 CI/CD 实现 Java 服务与 Nginx Proxy Manager 的自动化部署</h1><p>在现代微服务架构中，<strong>Nginx Proxy Manager</strong> 常被用作轻量级的反向代理管理工具，而通过 <strong>Docker</strong> 和 <strong>CI/CD 工具</strong>（如 GitHub Actions、GitLab CI/CD），可以实现自动化的部署和配置。本篇博客将带你一步步实现 Nginx Proxy Manager 与 Java 服务的自动化部署和配置。</p><hr><h2 id=一背景与目标>一、背景与目标</h2><p><strong>为什么选择 Nginx Proxy Manager？</strong></p><ul><li>简单易用的 Web 界面。</li><li>内置 Let&rsquo;s Encrypt 自动化 SSL 配置。</li><li>支持多域名、多服务的反向代理。</li></ul><p><strong>我们的目标：</strong></p><ol><li>使用 Docker 部署 Nginx Proxy Manager 和 Java 服务。</li><li>在 CI/CD 流程中自动化反向代理配置。</li><li>支持多环境（如开发、测试、生产）的动态切换。</li></ol><hr><h2 id=二准备工作>二、准备工作</h2><ol><li><p><strong>安装 Docker 和 Docker Compose</strong><br>确保服务器已安装：</p><ul><li>Docker：<a href=https://docs.docker.com/get-docker/>安装指南</a></li><li>Docker Compose：<a href=https://docs.docker.com/compose/install/>安装指南</a></li></ul></li><li><p><strong>准备一个运行中的 Java 服务</strong><br>假设你已有一个 Java 应用（如 Spring Boot 项目），并打包成 Docker 镜像。</p></div><div><a class="read-more button" href=/posts/11143717-ed32-46f5-9ce6-5b4945a0c69b/>Read more →</a></div></article><article class="post on-list"><h1 class=post-title><a href=https://connorzhangyu.com/posts/flutter/>Flutter</a></h1><div class=post-meta><time class=post-date>2024-07-27</time><span class=post-author>Anthony</span></div><img src=https://image.runtimes.cc/202407271621772.png class=post-cover alt=Flutter title="Cover Image"><div class=post-content><h1 id=安装>安装</h1><p>以<code>Ma</code>为例,安装之后任何地方有问题,要执行flutter自带的命令,检查<code>flutter doctor</code></p><p>选择对应的版本,下载到本地就是一个压缩包,解压,就能看到flutter的源码,包含<code>Dart</code>SDK</p><p><img src=https://image.runtimes.cc/202407271624215.png alt=image-20240727162450510></p><p>修改环境变量,记得要<code>source</code>下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>安装目录/flutter/bin:$PATH
</span></span></code></pre></div><p>Android Studio 安装<code>Flutter</code>插件,会自动安装<code>Dart</code>插件,新建Flutter项目</p><p><img src=https://image.runtimes.cc/202407271627148.png alt=image-20240727162701726></p><p>选择flutter下载的目录,最后解压出来的文件夹,后缀加上版本号</p><p><img src=https://image.runtimes.cc/202407271628362.png alt=image-20240727162820290></p><p>选择要创建哪些平台,看别人的教程,这里还有ios language的选项,不知道这里为啥没有</p><p><img src=https://image.runtimes.cc/202407271629455.png alt=image-20240727162913174></p><p>点击创建,flutter项目就创建完成了,接下来安装安卓模拟器</p><p><img src=https://image.runtimes.cc/202407271632326.png alt=image-20240727163213937></p><p>用生成出来的Demo运行下,就能看到例子了,到目前使用的是安卓的模拟器,下面是ios的模拟器</p><p>下载xcode,创建一个默认的ios的项目,点击运行,会提示下载模拟器,点下载就好了</p><p><img src=https://image.runtimes.cc/202407281223696.png alt=image-20240728122303800></p><p>选择模拟器,并重新再运行</p><p><img src=https://image.runtimes.cc/202407281225750.png alt=image-20240728122551387></p><p>运行成功就会有一个iPhone的界面</p><p><img src=https://image.runtimes.cc/202407281226888.png alt=image-20240728122648500></p><p>安装命令行工具</p><p><img src=https://image.runtimes.cc/202407281227469.png alt=image-20240728122757878></p><p>之后再执行<code>flutter doctor</code>就能大部分的都解决了,没有解决的,有会相应的命令提示</p><h1 id=资源--媒体>资源 & 媒体</h1><h2 id=添加资源和图片>添加资源和图片</h2><p><strong>指定资源</strong></p><p>Flutter 使用 <code>pubspec.yaml</code> 文件，位于项目根目录，来识别应用程序所需的资源。</p><p>在根目录下创建<code>assets</code>文件夹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>flutter</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>assets</span>:
</span></span><span style=display:flex><span>	  <span style=color:#75715e># 指定单个资源</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>assets/my_icon.png</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 指定整个目录,需要在目录名称的结尾加上 /：</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>directory/</span>
</span></span></code></pre></div><p>代码使用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dart data-lang=dart><span style=display:flex><span>Image.asset(<span style=color:#e6db74>&#34;assets/images/star.png&#34;</span>, width: <span style=color:#ae81ff>30</span>, height: <span style=color:#ae81ff>30</span>)
</span></span></code></pre></div><h2 id=加载网络图片>加载网络图片</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dart data-lang=dart><span style=display:flex><span>Image.network(<span style=color:#e6db74>&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9Gc&#34;</span>)
</span></span></code></pre></div><blockquote><p>参考:</p><p><a href=https://docs.flutter.dev/get-started/install>Flutter官网</a></p></blockquote></div><div><a class="read-more button" href=/posts/flutter/>Read more →</a></div></article><article class="post on-list"><h1 class=post-title><a href=https://connorzhangyu.com/posts/pinia/>Pinia</a></h1><div class=post-meta><time class=post-date>2024-07-07</time><span class=post-author>Anthony</span></div><span class=post-tags>#<a href=https://connorzhangyu.com/tags/vue.js/>Vue.js</a>&nbsp;
#<a href=https://connorzhangyu.com/tags/pinia/>Pinia</a>&nbsp;
</span><img src=https://image.runtimes.cc/202404051535734.jpg class=post-cover alt=Pinia title="Cover Image"><div class=post-content><p>安装</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>npm install pinia
</span></span></code></pre></div></div><div><a class="read-more button" href=/posts/pinia/>Read more →</a></div></article><article class="post on-list"><h1 class=post-title><a href=https://connorzhangyu.com/posts/%E8%AE%B0%E5%BD%95/nexus-3/>nexus3</a></h1><div class=post-meta><time class=post-date>2024-03-12</time><span class=post-author>Anthony</span></div><img src=https://image.runtimes.cc/202409151814537.png class=post-cover alt=nexus3 title="Cover Image"><div class=post-content><h1 id=docker仓库>Docker仓库</h1><table><thead><tr><th>类型</th><th>端口</th><th>仓库名字</th></tr></thead><tbody><tr><td>Host</td><td>9083</td><td>My-docker-host</td></tr><tr><td>proxy</td><td></td><td>My-docker-proxy</td></tr><tr><td>group</td><td>9082</td><td>My-docker-group</td></tr></tbody></table><p><strong>创建一个存储目录</strong></p><p>名字随便起,没有太多影响</p><p>![image-20240917104642184](../../../../../../Library/Application Support/typora-user-images/image-20240917104642184.png)</p><p>创建docker host仓库</p><p>![image-20240917104411323](../../../../../../Library/Application Support/typora-user-images/image-20240917104411323.png)</p><p>![image-20240917104515460](../../../../../../Library/Application Support/typora-user-images/image-20240917104515460.png)</p><p>![image-20240917104240181](../../../../../../Library/Application Support/typora-user-images/image-20240917104240181.png)</p><p>创建proxy仓库</p><p>![image-20240917113108378](../../../../../../Library/Application Support/typora-user-images/image-20240917113108378.png)</p><p>![image-20240917113128237](../../../../../../Library/Application Support/typora-user-images/image-20240917113128237.png)</p><p>group</p><p>![image-20240917113647416](../../../../../../Library/Application Support/typora-user-images/image-20240917113647416.png)</p><p>docker客户端配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># vim /etc/docker/daemon.json</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;insecure-registries&#34;</span>: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;54.255.206.44:9082&#34;</span>, <span style=color:#e6db74>&#34;54.255.206.44:9083&#34;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 需要重启</span>
</span></span><span style=display:flex><span>systemctl daemon-reload
</span></span><span style=display:flex><span>systemctl restart docker
</span></span></code></pre></div><p>登录</p><p>登录之后凭证保存在<code>/.docker/config.json</code>或者是在,部署的时候遇到一个问题,就是jenkins打包之后docker login可以,但是push的时候就提示没有授权,暂时的解决办法是,宿主机docker login下,保存凭证,然后jenkins容器挂载<code>/root/.docker/config.json</code>这个文件,jenkins打包就可以不用登录,直接推送</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>root@anthony:~# docker login http://54.255.206.44:9083
</span></span><span style=display:flex><span>Username: admin
</span></span><span style=display:flex><span>Password:
</span></span><span style=display:flex><span>Error response from daemon: login attempt to http://54.255.206.44:9083/v2/ failed with status: <span style=color:#ae81ff>401</span> Unauthorized
</span></span><span style=display:flex><span><span style=color:#75715e># ----------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span>root@anthony:~# docker login http://54.255.206.44:9082
</span></span><span style=display:flex><span>Username: admin
</span></span><span style=display:flex><span>Password:
</span></span><span style=display:flex><span>WARNING! Your password will be stored unencrypted in /root/.docker/config.json.
</span></span><span style=display:flex><span>Configure a credential helper to remove this warning. See
</span></span><span style=display:flex><span>https://docs.docker.com/engine/reference/commandline/login/#credentials-store
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Login Succeeded
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 镜像操作</span>
</span></span><span style=display:flex><span><span style=color:#75715e># pull镜像</span>
</span></span><span style=display:flex><span>docker pull nginx:latest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 给镜像打tag</span>
</span></span><span style=display:flex><span>docker tag nginx:latest 54.255.206.44:9082/my-docker-host/nginx:latest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 推送镜像</span>
</span></span><span style=display:flex><span>docker push 54.255.206.44:9082/my-docker-host/nginx:latest
</span></span></code></pre></div></div><div><a class="read-more button" href=/posts/%E8%AE%B0%E5%BD%95/nexus-3/>Read more →</a></div></article><article class="post on-list"><h1 class=post-title><a href=https://connorzhangyu.com/posts/springcloud/>SpringCloud</a></h1><div class=post-meta><time class=post-date>2024-03-03</time><span class=post-author>Anthony</span></div><img src=https://image.runtimes.cc/202404051534948.webp class=post-cover alt=SpringCloud title="Cover Image"><div class=post-content></div><div><a class="read-more button" href=/posts/springcloud/>Read more →</a></div></article><div class=pagination><div class=pagination__buttons><a href=/posts/page/8/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>Newer posts</span>
</a><a href=/posts/page/10/ class="button next"><span class=button__text>Older posts</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2025 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/mirus-ua/hugo-theme-re-terminal target=_blank>Theme</a> made by <a href=https://github.com/mirus-ua target=_blank>Mirus</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>