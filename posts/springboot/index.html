<!doctype html><html lang=zh><head><title>SpringBoot :: Hello World</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='定时器 定时器的数值放到配置文件,如果使用@Scheduled(fixedDelay = 类中的变量)这种方式试过不行
@Scheduled(fixedDelayString = "${fixedDelayString}") public void open() { } fixedDelayString=30000 RocketMQ 下载源码或者二进制包
# 源码安装 # 解压文件 unzip rocketmq-all-5.2.0-source-release.zip cd rocketmq-all-5.2.0-source-release/ # 编译 mvn -Prelease-all -DskipTests -Dspotbugs.skip=true clean install -U # 编译后的二进制的目录,配置文件在这里 cd ./distribution 修改配置文件
# 修改配置文件 # 修改内存配置,虚拟机的内存太小了 # vim ./bin/runserver.sh JAVA_OPT="${JAVA_OPT} -server -Xms512m -Xmx521m -Xmn256g -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m" # vim ./bin/runbroker.sh JAVA_OPT="${JAVA_OPT} -server -Xms512m -Xmx512m" 启动
# 第一步.启动Name Server sh bin/mqnamesrv The Name Server boot success... # 第二步.启动Broker sh bin/mqbroker -n localhost:9876 The broker[%s, 172.30.30.233:10911] boot success... 测试发送消息
'><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=../../posts/springboot/><link rel=stylesheet href=../../styles.css><link rel="shortcut icon" href=../../img/theme-colors/orange.png><link rel=apple-touch-icon href=../../img/theme-colors/orange.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content="Anthony"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="og:title" content="SpringBoot"><meta property="og:description" content='定时器 定时器的数值放到配置文件,如果使用@Scheduled(fixedDelay = 类中的变量)这种方式试过不行
@Scheduled(fixedDelayString = "${fixedDelayString}") public void open() { } fixedDelayString=30000 RocketMQ 下载源码或者二进制包
# 源码安装 # 解压文件 unzip rocketmq-all-5.2.0-source-release.zip cd rocketmq-all-5.2.0-source-release/ # 编译 mvn -Prelease-all -DskipTests -Dspotbugs.skip=true clean install -U # 编译后的二进制的目录,配置文件在这里 cd ./distribution 修改配置文件
# 修改配置文件 # 修改内存配置,虚拟机的内存太小了 # vim ./bin/runserver.sh JAVA_OPT="${JAVA_OPT} -server -Xms512m -Xmx521m -Xmn256g -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m" # vim ./bin/runbroker.sh JAVA_OPT="${JAVA_OPT} -server -Xms512m -Xmx512m" 启动
# 第一步.启动Name Server sh bin/mqnamesrv The Name Server boot success... # 第二步.启动Broker sh bin/mqbroker -n localhost:9876 The broker[%s, 172.30.30.233:10911] boot success... 测试发送消息
'><meta property="og:url" content="/posts/springboot/"><meta property="og:site_name" content="Hello World"><meta property="og:image" content="https://image.runtimes.cc/202404051534895.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Java"><meta property="article:section" content="Spring"><meta property="article:section" content="Spring Boot"><meta property="article:published_time" content="2023-07-15 14:58:26 +0000 UTC"></head><body class=orange><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=../../><div class=logo>康纳的记仇小本本</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=../../about>关于</a></li><li><a href=../../showcase>精选</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=../../about>关于</a></li><li><a href=../../showcase>精选</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=../../posts/springboot/>SpringBoot</a></h1><div class=post-meta><time class=post-date>2023-07-15</time><span class=post-author>Anthony</span></div><span class=post-tags>#<a href=../../tags/java/>Java</a>&nbsp;
</span><img src=https://image.runtimes.cc/202404051534895.png class=post-cover alt=" " title="Cover Image"><div class=post-content><div><h1 id=定时器>定时器<a href=#定时器 class=hanchor arialabel=Anchor>&#8983;</a></h1><p>定时器的数值放到配置文件,如果使用<code>@Scheduled(fixedDelay = 类中的变量)</code>这种方式试过不行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Scheduled</span>(fixedDelayString <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;${fixedDelayString}&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>open</span>() {
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#a6e22e>fixedDelayString</span><span style=color:#f92672>=</span><span style=color:#e6db74>30000</span>
</span></span></code></pre></div><h1 id=rocketmq>RocketMQ<a href=#rocketmq class=hanchor arialabel=Anchor>&#8983;</a></h1><p>下载源码或者二进制包</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 源码安装</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 解压文件</span>
</span></span><span style=display:flex><span>unzip rocketmq-all-5.2.0-source-release.zip
</span></span><span style=display:flex><span>cd rocketmq-all-5.2.0-source-release/
</span></span><span style=display:flex><span><span style=color:#75715e># 编译</span>
</span></span><span style=display:flex><span>mvn -Prelease-all -DskipTests -Dspotbugs.skip<span style=color:#f92672>=</span>true clean install -U
</span></span><span style=display:flex><span><span style=color:#75715e># 编译后的二进制的目录,配置文件在这里</span>
</span></span><span style=display:flex><span>cd ./distribution
</span></span></code></pre></div><p>修改配置文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 修改配置文件</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 修改内存配置,虚拟机的内存太小了</span>
</span></span><span style=display:flex><span><span style=color:#75715e># vim ./bin/runserver.sh</span>
</span></span><span style=display:flex><span>JAVA_OPT<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>JAVA_OPT<span style=color:#e6db74>}</span><span style=color:#e6db74> -server -Xms512m -Xmx521m -Xmn256g -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># vim ./bin/runbroker.sh</span>
</span></span><span style=display:flex><span>JAVA_OPT<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>JAVA_OPT<span style=color:#e6db74>}</span><span style=color:#e6db74> -server -Xms512m -Xmx512m&#34;</span>
</span></span></code></pre></div><p>启动</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 第一步.启动Name Server</span>
</span></span><span style=display:flex><span>sh bin/mqnamesrv
</span></span><span style=display:flex><span>The Name Server boot success...
</span></span><span style=display:flex><span><span style=color:#75715e># 第二步.启动Broker</span>
</span></span><span style=display:flex><span>sh bin/mqbroker -n localhost:9876
</span></span><span style=display:flex><span> The broker<span style=color:#f92672>[</span>%s, 172.30.30.233:10911<span style=color:#f92672>]</span> boot success...
</span></span></code></pre></div><p>测试发送消息</p><pre tabindex=0><code>export NAMESRV_ADDR=localhost:9876
# 发送消息
sh bin/tools.sh org.apache.rocketmq.example.quickstart.Producer
# 接收消息
sh bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer
</code></pre><h2 id=关闭服务>关闭服务<a href=#关闭服务 class=hanchor arialabel=Anchor>&#8983;</a></h2><pre tabindex=0><code>sh bin/mqshutdown broker
sh bin/mqshutdown namesrv
</code></pre><h2 id=监控>监控<a href=#监控 class=hanchor arialabel=Anchor>&#8983;</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 记得checkout release-rocketmq-console-1.0.0分支</span>
</span></span><span style=display:flex><span>git clone https://github.com/apache/rocketmq-externals/tree/release-rocketmq-console-1.0.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 修改配置文件里的rocketMQ远程地址</span>
</span></span><span style=display:flex><span>NameSvrAddrList <span style=color:#f92672>=</span> 192.168.254.124:9876
</span></span><span style=display:flex><span><span style=color:#75715e># 或者</span>
</span></span><span style=display:flex><span>rocketmq.config.namesrvAddr<span style=color:#f92672>=</span>192.168.254.124:9876
</span></span></code></pre></div><h2 id=代码>代码<a href=#代码 class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=单个生产者消费者>单个生产者消费者<a href=#单个生产者消费者 class=hanchor arialabel=Anchor>&#8983;</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Provider</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        DefaultMQProducer producer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DefaultMQProducer(<span style=color:#e6db74>&#34;group1&#34;</span>);
</span></span><span style=display:flex><span>        producer.<span style=color:#a6e22e>setNamesrvAddr</span>(<span style=color:#e6db74>&#34;192.168.254.190:9876&#34;</span>);
</span></span><span style=display:flex><span>        producer.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>        String msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;什么鬼,咋莫名其妙就收到了&#34;</span>;
</span></span><span style=display:flex><span>        Message message <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Message(<span style=color:#e6db74>&#34;topic1&#34;</span>, <span style=color:#e6db74>&#34;tag1&#34;</span>, msg.<span style=color:#a6e22e>getBytes</span>());
</span></span><span style=display:flex><span>        SendResult sendResult <span style=color:#f92672>=</span> producer.<span style=color:#a6e22e>send</span>(message);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%s%n&#34;</span>, sendResult);
</span></span><span style=display:flex><span>        producer.<span style=color:#a6e22e>shutdown</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Consumer</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> MQClientException {
</span></span><span style=display:flex><span>        DefaultMQPushConsumer consumer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DefaultMQPushConsumer(<span style=color:#e6db74>&#34;group1&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>setNamesrvAddr</span>(<span style=color:#e6db74>&#34;192.168.254.190:9876&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>subscribe</span>(<span style=color:#e6db74>&#34;topic1&#34;</span>, <span style=color:#e6db74>&#34;*&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>registerMessageListener</span>((MessageListenerConcurrently) (list, consumeConcurrentlyContext) <span style=color:#f92672>-&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 业务逻辑</span>
</span></span><span style=display:flex><span>            list.<span style=color:#a6e22e>forEach</span>(one<span style=color:#f92672>-&gt;</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> body <span style=color:#f92672>=</span> one.<span style=color:#a6e22e>getBody</span>();
</span></span><span style=display:flex><span>                System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#66d9ef>new</span> String(body));
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> ConsumeConcurrentlyStatus.<span style=color:#a6e22e>CONSUME_SUCCESS</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;消费者启起来了&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=单个生产者多个消费者>单个生产者多个消费者<a href=#单个生产者多个消费者 class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=相同的topic相同的group-负载均衡>相同的Topic,相同的Group-负载均衡<a href=#相同的topic相同的group-负载均衡 class=hanchor arialabel=Anchor>&#8983;</a></h3><p>默认就是负载均衡,多个消费者,每个人收一条信息,不重复</p><p><img src=https://image.runtimes.cc/202404051459670.png alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Provider</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        DefaultMQProducer producer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DefaultMQProducer(<span style=color:#e6db74>&#34;group2&#34;</span>);
</span></span><span style=display:flex><span>        producer.<span style=color:#a6e22e>setNamesrvAddr</span>(<span style=color:#e6db74>&#34;192.168.254.190:9876&#34;</span>);
</span></span><span style=display:flex><span>        producer.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> 10; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            String msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;默认接受者是负载均衡&#34;</span><span style=color:#f92672>+</span>i;
</span></span><span style=display:flex><span>            Message message <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Message(<span style=color:#e6db74>&#34;topic2&#34;</span>, <span style=color:#e6db74>&#34;tag1&#34;</span>, msg.<span style=color:#a6e22e>getBytes</span>());
</span></span><span style=display:flex><span>            SendResult sendResult <span style=color:#f92672>=</span> producer.<span style=color:#a6e22e>send</span>(message);
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%s%n&#34;</span>, sendResult);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        producer.<span style=color:#a6e22e>shutdown</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Consumer</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> MQClientException {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 谁来收</span>
</span></span><span style=display:flex><span>        DefaultMQPushConsumer consumer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DefaultMQPushConsumer(<span style=color:#e6db74>&#34;group2&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 从哪里收</span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>setNamesrvAddr</span>(<span style=color:#e6db74>&#34;192.168.254.190:9876&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 监听队列</span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>subscribe</span>(<span style=color:#e6db74>&#34;topic2&#34;</span>, <span style=color:#e6db74>&#34;*&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 监听器</span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>registerMessageListener</span>((MessageListenerConcurrently) (list, consumeConcurrentlyContext) <span style=color:#f92672>-&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 业务逻辑</span>
</span></span><span style=display:flex><span>            list.<span style=color:#a6e22e>forEach</span>(one<span style=color:#f92672>-&gt;</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> body <span style=color:#f92672>=</span> one.<span style=color:#a6e22e>getBody</span>();
</span></span><span style=display:flex><span>                System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#66d9ef>new</span> String(body));
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> ConsumeConcurrentlyStatus.<span style=color:#a6e22e>CONSUME_SUCCESS</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;消费者启起来了&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 第一个消费者</span>
</span></span><span style=display:flex><span>默认接受者是负载均衡0
</span></span><span style=display:flex><span>默认接受者是负载均衡1
</span></span><span style=display:flex><span>默认接受者是负载均衡4
</span></span><span style=display:flex><span>默认接受者是负载均衡5
</span></span><span style=display:flex><span>默认接受者是负载均衡8
</span></span><span style=display:flex><span>默认接受者是负载均衡9
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 第二个消费者</span>
</span></span><span style=display:flex><span>默认接受者是负载均衡2
</span></span><span style=display:flex><span>默认接受者是负载均衡3
</span></span><span style=display:flex><span>默认接受者是负载均衡6
</span></span><span style=display:flex><span>默认接受者是负载均衡7
</span></span></code></pre></div><h3 id=相同的topic相同的group-轮训>相同的Topic,相同的Group-轮训<a href=#相同的topic相同的group-轮训 class=hanchor arialabel=Anchor>&#8983;</a></h3><p>只是添加了消费者的一段代码:<code>consumer.setMessageModel(MessageModel.BROADCASTING);</code></p><p><img src=https://image.runtimes.cc/202404051459646.png alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Provider</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> Exception {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 谁来发</span>
</span></span><span style=display:flex><span>        DefaultMQProducer producer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DefaultMQProducer(<span style=color:#e6db74>&#34;group3&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 发给谁</span>
</span></span><span style=display:flex><span>        producer.<span style=color:#a6e22e>setNamesrvAddr</span>(<span style=color:#e6db74>&#34;192.168.254.190:9876&#34;</span>);
</span></span><span style=display:flex><span>        producer.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0; i <span style=color:#f92672>&lt;</span> 10; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            String msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;默认接受者是负载均衡&#34;</span><span style=color:#f92672>+</span>i;
</span></span><span style=display:flex><span>            Message message <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Message(<span style=color:#e6db74>&#34;topic3&#34;</span>, <span style=color:#e6db74>&#34;tag1&#34;</span>, msg.<span style=color:#a6e22e>getBytes</span>());
</span></span><span style=display:flex><span>            SendResult sendResult <span style=color:#f92672>=</span> producer.<span style=color:#a6e22e>send</span>(message);
</span></span><span style=display:flex><span>            System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;%s%n&#34;</span>, sendResult);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        producer.<span style=color:#a6e22e>shutdown</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Consumer</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> MQClientException {
</span></span><span style=display:flex><span>        DefaultMQPushConsumer consumer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DefaultMQPushConsumer(<span style=color:#e6db74>&#34;group3&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>setNamesrvAddr</span>(<span style=color:#e6db74>&#34;192.168.254.190:9876&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>subscribe</span>(<span style=color:#e6db74>&#34;topic3&#34;</span>, <span style=color:#e6db74>&#34;*&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>setMessageModel</span>(MessageModel.<span style=color:#a6e22e>BROADCASTING</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 监听器</span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>registerMessageListener</span>((MessageListenerConcurrently) (list, consumeConcurrentlyContext) <span style=color:#f92672>-&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 业务逻辑</span>
</span></span><span style=display:flex><span>            list.<span style=color:#a6e22e>forEach</span>(one<span style=color:#f92672>-&gt;</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> body <span style=color:#f92672>=</span> one.<span style=color:#a6e22e>getBody</span>();
</span></span><span style=display:flex><span>                System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#66d9ef>new</span> String(body));
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> ConsumeConcurrentlyStatus.<span style=color:#a6e22e>CONSUME_SUCCESS</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;消费者启起来了&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 两个消费者都是收到相同的消息</span>
</span></span><span style=display:flex><span>默认接受者是负载均衡0
</span></span><span style=display:flex><span>默认接受者是负载均衡1
</span></span><span style=display:flex><span>默认接受者是负载均衡2
</span></span><span style=display:flex><span>默认接受者是负载均衡3
</span></span><span style=display:flex><span>默认接受者是负载均衡4
</span></span><span style=display:flex><span>默认接受者是负载均衡5
</span></span><span style=display:flex><span>默认接受者是负载均衡6
</span></span><span style=display:flex><span>默认接受者是负载均衡7
</span></span><span style=display:flex><span>默认接受者是负载均衡8
</span></span><span style=display:flex><span>默认接受者是负载均衡9
</span></span></code></pre></div><h3 id=不同的topic不同的group>不同的Topic,不同的Group<a href=#不同的topic不同的group class=hanchor arialabel=Anchor>&#8983;</a></h3><p><img src=https://image.runtimes.cc/202404051459641.png alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 消费者1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Consumer</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> MQClientException {
</span></span><span style=display:flex><span>        DefaultMQPushConsumer consumer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DefaultMQPushConsumer(<span style=color:#e6db74>&#34;group4&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>setNamesrvAddr</span>(<span style=color:#e6db74>&#34;192.168.254.190:9876&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>subscribe</span>(<span style=color:#e6db74>&#34;topic4&#34;</span>, <span style=color:#e6db74>&#34;*&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 监听器</span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>registerMessageListener</span>((MessageListenerConcurrently) (list, consumeConcurrentlyContext) <span style=color:#f92672>-&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 业务逻辑</span>
</span></span><span style=display:flex><span>            list.<span style=color:#a6e22e>forEach</span>(one<span style=color:#f92672>-&gt;</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> body <span style=color:#f92672>=</span> one.<span style=color:#a6e22e>getBody</span>();
</span></span><span style=display:flex><span>                System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#66d9ef>new</span> String(body));
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> ConsumeConcurrentlyStatus.<span style=color:#a6e22e>CONSUME_SUCCESS</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;消费者启起来了&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 消费者2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Consumer</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> MQClientException {
</span></span><span style=display:flex><span>        DefaultMQPushConsumer consumer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DefaultMQPushConsumer(<span style=color:#e6db74>&#34;group4&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>setNamesrvAddr</span>(<span style=color:#e6db74>&#34;192.168.254.190:9876&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>subscribe</span>(<span style=color:#e6db74>&#34;topic4&#34;</span>, <span style=color:#e6db74>&#34;*&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 监听器</span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>registerMessageListener</span>((MessageListenerConcurrently) (list, consumeConcurrentlyContext) <span style=color:#f92672>-&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 业务逻辑</span>
</span></span><span style=display:flex><span>            list.<span style=color:#a6e22e>forEach</span>(one<span style=color:#f92672>-&gt;</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> body <span style=color:#f92672>=</span> one.<span style=color:#a6e22e>getBody</span>();
</span></span><span style=display:flex><span>                System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#66d9ef>new</span> String(body));
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> ConsumeConcurrentlyStatus.<span style=color:#a6e22e>CONSUME_SUCCESS</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;消费者启起来了&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 消费者3</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Consumer</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>main</span>(String<span style=color:#f92672>[]</span> args) <span style=color:#66d9ef>throws</span> MQClientException {
</span></span><span style=display:flex><span>        DefaultMQPushConsumer consumer <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> DefaultMQPushConsumer(<span style=color:#e6db74>&#34;group4-1&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>setNamesrvAddr</span>(<span style=color:#e6db74>&#34;192.168.254.190:9876&#34;</span>);
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>subscribe</span>(<span style=color:#e6db74>&#34;topic4&#34;</span>, <span style=color:#e6db74>&#34;*&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 监听器</span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>registerMessageListener</span>((MessageListenerConcurrently) (list, consumeConcurrentlyContext) <span style=color:#f92672>-&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 业务逻辑</span>
</span></span><span style=display:flex><span>            list.<span style=color:#a6e22e>forEach</span>(one<span style=color:#f92672>-&gt;</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> body <span style=color:#f92672>=</span> one.<span style=color:#a6e22e>getBody</span>();
</span></span><span style=display:flex><span>                System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#66d9ef>new</span> String(body));
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> ConsumeConcurrentlyStatus.<span style=color:#a6e22e>CONSUME_SUCCESS</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        consumer.<span style=color:#a6e22e>start</span>();
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;消费者启起来了&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 消费者1</span>
</span></span><span style=display:flex><span>默认接受者是负载均衡2
</span></span><span style=display:flex><span>默认接受者是负载均衡3
</span></span><span style=display:flex><span>默认接受者是负载均衡6
</span></span><span style=display:flex><span>默认接受者是负载均衡7
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 消费者2</span>
</span></span><span style=display:flex><span>默认接受者是负载均衡0
</span></span><span style=display:flex><span>默认接受者是负载均衡1
</span></span><span style=display:flex><span>默认接受者是负载均衡4
</span></span><span style=display:flex><span>默认接受者是负载均衡5
</span></span><span style=display:flex><span>默认接受者是负载均衡8
</span></span><span style=display:flex><span>默认接受者是负载均衡9
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 消费者3</span>
</span></span><span style=display:flex><span>默认接受者是负载均衡0
</span></span><span style=display:flex><span>默认接受者是负载均衡1
</span></span><span style=display:flex><span>默认接受者是负载均衡2
</span></span><span style=display:flex><span>默认接受者是负载均衡3
</span></span><span style=display:flex><span>默认接受者是负载均衡4
</span></span><span style=display:flex><span>默认接受者是负载均衡5
</span></span><span style=display:flex><span>默认接受者是负载均衡6
</span></span><span style=display:flex><span>默认接受者是负载均衡7
</span></span><span style=display:flex><span>默认接受者是负载均衡8
</span></span><span style=display:flex><span>默认接受者是负载均衡9
</span></span></code></pre></div><h1 id=swagger>Swagger<a href=#swagger class=hanchor arialabel=Anchor>&#8983;</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!-- 引入Swagger3依赖 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;groupId&gt;</span>io.springfox<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;artifactId&gt;</span>springfox-boot-starter<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;version&gt;</span>3.0.0<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/dependency&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> io.swagger.annotations.ApiOperation;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.context.annotation.Bean;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.context.annotation.Configuration;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> springfox.documentation.builders.ApiInfoBuilder;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> springfox.documentation.builders.PathSelectors;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> springfox.documentation.builders.RequestHandlerSelectors;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> springfox.documentation.oas.annotations.EnableOpenApi;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> springfox.documentation.service.ApiInfo;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> springfox.documentation.service.Contact;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> springfox.documentation.spi.DocumentationType;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> springfox.documentation.spring.web.plugins.Docket;
</span></span><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * Swagger配置类
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@EnableOpenApi</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Configuration</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SwaggerConfig</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Bean</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Docket <span style=color:#a6e22e>docket</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> Docket(DocumentationType.<span style=color:#a6e22e>OAS_30</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>apiInfo</span>(apiInfo()).<span style=color:#a6e22e>enable</span>(<span style=color:#66d9ef>true</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>select</span>()
</span></span><span style=display:flex><span>                <span style=color:#75715e>//apis： 添加swagger接口提取范围</span>
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>apis</span>(RequestHandlerSelectors.<span style=color:#a6e22e>basePackage</span>(<span style=color:#e6db74>&#34;com.example.study.controller&#34;</span>))
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>apis</span>(RequestHandlerSelectors.<span style=color:#a6e22e>withMethodAnnotation</span>(ApiOperation.<span style=color:#a6e22e>class</span>))
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>paths</span>(PathSelectors.<span style=color:#a6e22e>any</span>())
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> ApiInfo <span style=color:#a6e22e>apiInfo</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> ApiInfoBuilder()
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>title</span>(<span style=color:#e6db74>&#34;XX项目接口文档&#34;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>description</span>(<span style=color:#e6db74>&#34;XX项目描述&#34;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>contact</span>(<span style=color:#66d9ef>new</span> Contact(<span style=color:#e6db74>&#34;作者&#34;</span>, <span style=color:#e6db74>&#34;作者URL&#34;</span>, <span style=color:#e6db74>&#34;作者Email&#34;</span>))
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>version</span>(<span style=color:#e6db74>&#34;1.0&#34;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>build</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># 原因是在springboot 2.6.0中将SpringMVC 默认路径匹配策略从AntPathMatcher</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 更改为PathPatternParser，导致出错，解决办法是切换回原先的AntPathMatcher</span>
</span></span><span style=display:flex><span>spring.mvc.pathmatch.matching-strategy=ant_path_matcher
</span></span></code></pre></div><h1 id=knife4j>knife4j<a href=#knife4j class=hanchor arialabel=Anchor>&#8983;</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;groupId&gt;</span>com.github.xiaoymin<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;artifactId&gt;</span>knife4j-spring-boot-starter<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;version&gt;</span>3.0.3<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>application.properties</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>spring.mvc.pathmatch.matching-strategy=ant_path_matcher
</span></span><span style=display:flex><span>knife4j.enable: true
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@RestController</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@RequestMapping</span>(<span style=color:#e6db74>&#34;/test&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Api</span>(tags <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;测试2&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>// 排序</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@ApiSort</span>(value <span style=color:#f92672>=</span> 1)
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TestController2</span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@GetMapping</span>(<span style=color:#e6db74>&#34;/3&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ApiOperation</span>(<span style=color:#e6db74>&#34;3&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>method</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;hello wolrd&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@GetMapping</span>(<span style=color:#e6db74>&#34;/4&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ApiOperation</span>(<span style=color:#e6db74>&#34;4&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>method2</span>(){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;hello wolrd&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=log4j2>Log4j2<a href=#log4j2 class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=log4j2-1>Log4j2<a href=#log4j2-1 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>日志所有级别级别从上到下 ,级别从低到高,报错(更重要)这种,级别最高,info,debug相对不怎么重要</p><ul><li>all</li><li>trace</li><li>debug</li><li>info</li><li>warn</li><li>error</li><li>fail</li></ul><p>Log4j2.xml配置例子</p><p>{% tabs Log4j2 %}</p><pre tabindex=0><code>info级别输出到info.log
warn级别输出warn.log
error级别输出到error.log
debug级别输出到debug.log
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Configuration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--&lt;Configuration status=&#34;WARN&#34; monitorInterval=&#34;30&#34;&gt; --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;properties&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;LOG_HOME&#34;</span><span style=color:#f92672>&gt;</span>./service-logs<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/properties&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Appenders&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--*********************控制台日志***********************--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Console</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;consoleAppender&#34;</span> <span style=color:#a6e22e>target=</span><span style=color:#e6db74>&#34;SYSTEM_OUT&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志格式及颜色--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;PatternLayout</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>pattern=</span><span style=color:#e6db74>&#34;%style{%d{ISO8601}}{bright,green} %highlight{%-5level} [%style{%t}{bright,blue}] %style{%C{}}{bright,yellow}: %msg%n%style{%throwable}{red}&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>disableAnsi=</span><span style=color:#e6db74>&#34;false&#34;</span> <span style=color:#a6e22e>noConsoleNoAnsi=</span><span style=color:#e6db74>&#34;false&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/Console&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--*********************文件日志***********************--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--all级别日志--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;RollingFile</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;allFileAppender&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>fileName=</span><span style=color:#e6db74>&#34;${LOG_HOME}/all.log&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>filePattern=</span><span style=color:#e6db74>&#34;${LOG_HOME}/$${date:yyyy-MM}/all-%d{yyyy-MM-dd}-%i.log.gz&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志格式--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;PatternLayout&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;pattern&gt;</span>%d %p %C{} [%t] %m%n<span style=color:#f92672>&lt;/pattern&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/PatternLayout&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Policies&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!-- 设置日志文件切分参数 --&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--&lt;OnStartupTriggeringPolicy/&gt;--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--设置日志基础文件大小，超过该大小就触发日志文件滚动更新--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;SizeBasedTriggeringPolicy</span> <span style=color:#a6e22e>size=</span><span style=color:#e6db74>&#34;100 MB&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--设置日志文件滚动更新的时间，依赖于文件命名filePattern的设置--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;TimeBasedTriggeringPolicy/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Policies&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志的文件个数上限，不设置默认为7个，超过大小后会被覆盖；依赖于filePattern中的%i--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;DefaultRolloverStrategy</span> <span style=color:#a6e22e>max=</span><span style=color:#e6db74>&#34;100&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/RollingFile&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--debug级别日志--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;RollingFile</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;debugFileAppender&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>fileName=</span><span style=color:#e6db74>&#34;${LOG_HOME}/debug.log&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>filePattern=</span><span style=color:#e6db74>&#34;${LOG_HOME}/$${date:yyyy-MM}/debug-%d{yyyy-MM-dd}-%i.log.gz&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Filters&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--过滤掉info及更高级别日志--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;ThresholdFilter</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>onMatch=</span><span style=color:#e6db74>&#34;DENY&#34;</span> <span style=color:#a6e22e>onMismatch=</span><span style=color:#e6db74>&#34;NEUTRAL&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Filters&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志格式--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;PatternLayout&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;pattern&gt;</span>%d %p %C{} [%t] %m%n<span style=color:#f92672>&lt;/pattern&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/PatternLayout&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Policies&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!-- 设置日志文件切分参数 --&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--&lt;OnStartupTriggeringPolicy/&gt;--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--设置日志基础文件大小，超过该大小就触发日志文件滚动更新--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;SizeBasedTriggeringPolicy</span> <span style=color:#a6e22e>size=</span><span style=color:#e6db74>&#34;100 MB&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--设置日志文件滚动更新的时间，依赖于文件命名filePattern的设置--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;TimeBasedTriggeringPolicy/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Policies&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志的文件个数上限，不设置默认为7个，超过大小后会被覆盖；依赖于filePattern中的%i--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;DefaultRolloverStrategy</span> <span style=color:#a6e22e>max=</span><span style=color:#e6db74>&#34;100&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/RollingFile&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--info级别日志--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;RollingFile</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;infoFileAppender&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>fileName=</span><span style=color:#e6db74>&#34;${LOG_HOME}/info.log&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>filePattern=</span><span style=color:#e6db74>&#34;${LOG_HOME}/$${date:yyyy-MM}/info-%d{yyyy-MM-dd}-%i.log.gz&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Filters&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--过滤掉warn及更高级别日志--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;ThresholdFilter</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;warn&#34;</span> <span style=color:#a6e22e>onMatch=</span><span style=color:#e6db74>&#34;DENY&#34;</span> <span style=color:#a6e22e>onMismatch=</span><span style=color:#e6db74>&#34;NEUTRAL&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Filters&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志格式--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;PatternLayout&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;pattern&gt;</span>%d %p %C{} [%t] %m%n<span style=color:#f92672>&lt;/pattern&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/PatternLayout&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Policies&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!-- 设置日志文件切分参数 --&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--&lt;OnStartupTriggeringPolicy/&gt;--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志基础文件大小，超过该大小就触发日志文件滚动更新--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;SizeBasedTriggeringPolicy</span> <span style=color:#a6e22e>size=</span><span style=color:#e6db74>&#34;100 MB&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志文件滚动更新的时间，依赖于文件命名filePattern的设置--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;TimeBasedTriggeringPolicy</span> <span style=color:#a6e22e>interval=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>modulate=</span><span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Policies&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志的文件个数上限，不设置默认为7个，超过大小后会被覆盖；依赖于filePattern中的%i--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--&lt;DefaultRolloverStrategy max=&#34;100&#34;/&gt;--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/RollingFile&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--warn级别日志--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;RollingFile</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;warnFileAppender&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>fileName=</span><span style=color:#e6db74>&#34;${LOG_HOME}/warn.log&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>filePattern=</span><span style=color:#e6db74>&#34;${LOG_HOME}/$${date:yyyy-MM}/warn-%d{yyyy-MM-dd}-%i.log.gz&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Filters&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--过滤掉error及更高级别日志--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;ThresholdFilter</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;error&#34;</span> <span style=color:#a6e22e>onMatch=</span><span style=color:#e6db74>&#34;DENY&#34;</span> <span style=color:#a6e22e>onMismatch=</span><span style=color:#e6db74>&#34;NEUTRAL&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Filters&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志格式--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;PatternLayout&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;pattern&gt;</span>%d %p %C{} [%t] %m%n<span style=color:#f92672>&lt;/pattern&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/PatternLayout&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Policies&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!-- 设置日志文件切分参数 --&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--&lt;OnStartupTriggeringPolicy/&gt;--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--设置日志基础文件大小，超过该大小就触发日志文件滚动更新--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;SizeBasedTriggeringPolicy</span> <span style=color:#a6e22e>size=</span><span style=color:#e6db74>&#34;100 MB&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--设置日志文件滚动更新的时间，依赖于文件命名filePattern的设置--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;TimeBasedTriggeringPolicy/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Policies&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志的文件个数上限，不设置默认为7个，超过大小后会被覆盖；依赖于filePattern中的%i--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;DefaultRolloverStrategy</span> <span style=color:#a6e22e>max=</span><span style=color:#e6db74>&#34;100&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/RollingFile&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--error及更高级别日志--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;RollingFile</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;errorFileAppender&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>fileName=</span><span style=color:#e6db74>&#34;${LOG_HOME}/error.log&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>filePattern=</span><span style=color:#e6db74>&#34;${LOG_HOME}/$${date:yyyy-MM}/error-%d{yyyy-MM-dd}-%i.log.gz&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志格式--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;PatternLayout&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;pattern&gt;</span>%d %p %C{} [%t] %m%n<span style=color:#f92672>&lt;/pattern&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/PatternLayout&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Policies&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!-- 设置日志文件切分参数 --&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--&lt;OnStartupTriggeringPolicy/&gt;--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--设置日志基础文件大小，超过该大小就触发日志文件滚动更新--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;SizeBasedTriggeringPolicy</span> <span style=color:#a6e22e>size=</span><span style=color:#e6db74>&#34;100 MB&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>&lt;!--设置日志文件滚动更新的时间，依赖于文件命名filePattern的设置--&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;TimeBasedTriggeringPolicy/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Policies&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>&lt;!--设置日志的文件个数上限，不设置默认为7个，超过大小后会被覆盖；依赖于filePattern中的%i--&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;DefaultRolloverStrategy</span> <span style=color:#a6e22e>max=</span><span style=color:#e6db74>&#34;100&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/RollingFile&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--json格式error级别日志--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;RollingFile</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;errorJsonAppender&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>fileName=</span><span style=color:#e6db74>&#34;${LOG_HOME}/error-json.log&#34;</span>
</span></span><span style=display:flex><span>                     <span style=color:#a6e22e>filePattern=</span><span style=color:#e6db74>&#34;${LOG_HOME}/error-json-%d{yyyy-MM-dd}-%i.log.gz&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;JSONLayout</span> <span style=color:#a6e22e>compact=</span><span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#a6e22e>eventEol=</span><span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#a6e22e>locationInfo=</span><span style=color:#e6db74>&#34;true&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Policies&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;SizeBasedTriggeringPolicy</span> <span style=color:#a6e22e>size=</span><span style=color:#e6db74>&#34;100 MB&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;TimeBasedTriggeringPolicy</span> <span style=color:#a6e22e>interval=</span><span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#a6e22e>modulate=</span><span style=color:#e6db74>&#34;true&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Policies&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/RollingFile&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/Appenders&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Loggers&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!-- 根日志设置 --&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Root</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;debug&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;allFileAppender&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;all&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;consoleAppender&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;debug&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;debugFileAppender&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;debug&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;infoFileAppender&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;info&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;warnFileAppender&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;warn&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;errorFileAppender&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;error&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;errorJsonAppender&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;error&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/Root&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--spring日志--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Logger</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;org.springframework&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;debug&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!--druid数据源日志--&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Logger</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;druid.sql.Statement&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;warn&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!-- mybatis日志 --&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Logger</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;com.mybatis&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;warn&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Logger</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;org.hibernate&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;warn&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Logger</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;com.zaxxer.hikari&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;info&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Logger</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;org.quartz&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;info&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Logger</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;com.andya.demo&#34;</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;debug&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/Loggers&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Configuration&gt;</span>
</span></span></code></pre></div><pre tabindex=0><code>error级别 打印error.log
info级别 打印info,error 日志到info.log
debug级别 打印info,error,debug日志到debug.log
</code></pre><p>{% endtabs %}</p><p>基本结构是:</p><ul><li>Configuration<ul><li>properties 属性配置,可以在这里配置全局变量,可以在xml别的地方引入</li><li>Appenders 具体配置日志框架该如何收集日志的动作<ul><li>Console 控制台输出</li><li>RollingFile 滚动日志文件</li></ul></li><li>Loggers<ul><li>Root 理论上只有一个Root,level属性,是全局日志级别,如果AppenderRef没有配置level,就使用全局级别<ul><li>AppenderRef 引用具体配置的动作,level 没有的话,就使用全局级别,就像<code>CSS</code>属性那样,标签里的属性优先级最高</li></ul></li><li>Logger 单独配置一些类,level 没有的话,就使用全局级别,就像<code>CSS</code>属性那样,标签里的属性优先级最高</li></ul></li></ul></li></ul><p>过滤器的具体使用方法</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;Filters&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!--过滤掉info及更高级别日志--&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;ThresholdFilter</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;info&#34;</span> <span style=color:#a6e22e>onMatch=</span><span style=color:#e6db74>&#34;DENY&#34;</span> <span style=color:#a6e22e>onMismatch=</span><span style=color:#e6db74>&#34;NEUTRAL&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Filters&gt;</span>
</span></span></code></pre></div><p><code>level</code>指定日志等级的阈值。</p><p><code>onMatch</code> 定义当日志事件等级等于或高于 <code>level</code> 属性指定的等级时的行为。</p><ul><li><code>ACCEPT</code>：接受日志事件，让它通过过滤器。</li><li><code>DENY</code>：拒绝日志事件，不让它通过过滤器。</li><li><code>NEUTRAL</code>：对日志事件不做决定，继续应用其他的过滤规则。</li></ul><p><code>onMismatch</code> 定义当日志事件等级低于 <code>level</code> 属性指定的等级时的行为。</p><ul><li><code>ACCEPT</code>：接受日志事件，让它通过过滤器。</li><li><code>DENY</code>：拒绝日志事件，不让它通过过滤器。</li><li><code>NEUTRAL</code>：对日志事件不做决定，继续应用其他的过滤规则。</li></ul><pre tabindex=0><code>if 日志的级别 &gt;= level配置的级别
	ACCEPT  接受日志
	DENY  拒绝日志
	NEUTRAL 对日志事件不做决定，继续应用其他的过滤规则

if 日志的级别 &lt; level配置的级别
	ACCEPT  接受日志
	DENY  拒绝日志
	NEUTRAL 对日志事件不做决定，继续应用其他的过滤规则
</code></pre><blockquote><p>还是没有搞清楚 onMismatch=&ldquo;NEUTRAL&rdquo; 的作用是怎样的</p><p>使用ChatGPT提供的demo,没有验证</p><p>info级别 记录到info.log
error级别 记录到error.log
info级别和error级别 记录到dev.log</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;Configuration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Appenders&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!-- Info 级别日志的 Appender --&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;File</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;InfoAppender&#34;</span> <span style=color:#a6e22e>fileName=</span><span style=color:#e6db74>&#34;logs/info.log&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;ThresholdFilter</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;INFO&#34;</span> <span style=color:#a6e22e>onMatch=</span><span style=color:#e6db74>&#34;ACCEPT&#34;</span> <span style=color:#a6e22e>onMismatch=</span><span style=color:#e6db74>&#34;DENY&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;PatternLayout</span> <span style=color:#a6e22e>pattern=</span><span style=color:#e6db74>&#34;%d{yyyy-MM-dd HH:mm:ss} [%t] %-5level %logger{36} - %msg%n&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/File&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!-- Error 级别日志的 Appender --&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;File</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;ErrorAppender&#34;</span> <span style=color:#a6e22e>fileName=</span><span style=color:#e6db74>&#34;logs/error.log&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;ThresholdFilter</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;ERROR&#34;</span> <span style=color:#a6e22e>onMatch=</span><span style=color:#e6db74>&#34;ACCEPT&#34;</span> <span style=color:#a6e22e>onMismatch=</span><span style=color:#e6db74>&#34;DENY&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;PatternLayout</span> <span style=color:#a6e22e>pattern=</span><span style=color:#e6db74>&#34;%d{yyyy-MM-dd HH:mm:ss} [%t] %-5level %logger{36} - %msg%n&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/File&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>&lt;!-- 同时记录 Info 和 Error 级别日志的 Appender --&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;File</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;DevAppender&#34;</span> <span style=color:#a6e22e>fileName=</span><span style=color:#e6db74>&#34;logs/dev.log&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;Filters&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;ThresholdFilter</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;INFO&#34;</span> <span style=color:#a6e22e>onMatch=</span><span style=color:#e6db74>&#34;ACCEPT&#34;</span> <span style=color:#a6e22e>onMismatch=</span><span style=color:#e6db74>&#34;DENY&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;ThresholdFilter</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;ERROR&#34;</span> <span style=color:#a6e22e>onMatch=</span><span style=color:#e6db74>&#34;ACCEPT&#34;</span> <span style=color:#a6e22e>onMismatch=</span><span style=color:#e6db74>&#34;NEUTRAL&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/Filters&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;PatternLayout</span> <span style=color:#a6e22e>pattern=</span><span style=color:#e6db74>&#34;%d{yyyy-MM-dd HH:mm:ss} [%t] %-5level %logger{36} - %msg%n&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/File&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/Appenders&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;Loggers&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;Root</span> <span style=color:#a6e22e>level=</span><span style=color:#e6db74>&#34;DEBUG&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;InfoAppender&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;ErrorAppender&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;AppenderRef</span> <span style=color:#a6e22e>ref=</span><span style=color:#e6db74>&#34;DevAppender&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/Root&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/Loggers&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Configuration&gt;</span>
</span></span></code></pre></div></blockquote><h2 id=只是引入web框架>只是引入web框架<a href=#只是引入web框架 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>只是引入web框架</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;groupId&gt;</span>org.springframework.boot<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;artifactId&gt;</span>spring-boot-starter-web<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/dependency&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@GetMapping</span>(<span style=color:#e6db74>&#34;/test&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>test</span>(){
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 格式化当前日期时间</span>
</span></span><span style=display:flex><span>    String formattedDateTime <span style=color:#f92672>=</span> LocalDateTime.<span style=color:#a6e22e>now</span>().<span style=color:#a6e22e>format</span>(DateTimeFormatter.<span style=color:#a6e22e>ofPattern</span>(<span style=color:#e6db74>&#34;yyyy-MM-dd HH:mm:ss&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    log.<span style=color:#a6e22e>debug</span>(<span style=color:#e6db74>&#34;当前日期时间：{}&#34;</span>, formattedDateTime);
</span></span><span style=display:flex><span>    log.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;当前日期时间：{}&#34;</span>, formattedDateTime);
</span></span><span style=display:flex><span>    log.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#34;当前日期时间：{}&#34;</span>, formattedDateTime);
</span></span><span style=display:flex><span>    log.<span style=color:#a6e22e>warn</span>(<span style=color:#e6db74>&#34;当前日期时间：{}&#34;</span>, formattedDateTime);
</span></span><span style=display:flex><span>    log.<span style=color:#a6e22e>trace</span>(<span style=color:#e6db74>&#34;当前日期时间：{}&#34;</span>, formattedDateTime);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> formattedDateTime;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 控制台打印</span>
</span></span><span style=display:flex><span>INFO <span style=color:#ae81ff>64710</span> --- <span style=color:#f92672>[</span>nio-8080-exec-1<span style=color:#f92672>]</span> c.e.s.controller.IndexController         : 当前日期时间：2024-03-03 21:37:40
</span></span><span style=display:flex><span>ERROR <span style=color:#ae81ff>64710</span> --- <span style=color:#f92672>[</span>nio-8080-exec-1<span style=color:#f92672>]</span> c.e.s.controller.IndexController         : 当前日期时间：2024-03-03 21:37:40
</span></span><span style=display:flex><span>WARN <span style=color:#ae81ff>64710</span> --- <span style=color:#f92672>[</span>nio-8080-exec-1<span style=color:#f92672>]</span> c.e.s.controller.IndexController         : 当前日期时间：2024-03-03 21:37:40
</span></span><span style=display:flex><span><span style=color:#75715e># 为什么控制台没有打印 trace和debug日志</span>
</span></span></code></pre></div></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=../../posts/%E8%AE%B0%E5%BD%95/waline/><span class=button__icon>←</span>
<span class=button__text>Waline部署</span>
</a></span><span class="button next"><a href=../../posts/telegrambot/><span class=button__text>Telegram Bot</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2025 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/mirus-ua/hugo-theme-re-terminal target=_blank>Theme</a> made by <a href=https://github.com/mirus-ua target=_blank>Mirus</a></span></div></div></footer><script type=text/javascript src=../../bundle.min.js></script></div></body></html>