<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Mac on Hello World</title><link>https://connorzhangyu.com/tags/mac/</link><description>Recent content in Mac on Hello World</description><generator>Hugo -- gohugo.io</generator><language>zh</language><lastBuildDate>Thu, 29 May 2025 10:23:17 +0000</lastBuildDate><atom:link href="https://connorzhangyu.com/tags/mac/index.xml" rel="self" type="application/rss+xml"/><item><title>Dapp</title><link>https://connorzhangyu.com/posts/dapp/</link><pubDate>Thu, 29 May 2025 10:23:17 +0000</pubDate><guid>https://connorzhangyu.com/posts/dapp/</guid><description>&lt;h1 id="helloworldåˆçº¦">HelloWorldåˆçº¦&lt;/h1>
&lt;p>&lt;a href="https://remix.ethereum.org">Remixç¼–è¾‘å™¨&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505281038720.png" alt="image-20250524144934373">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-solidity" data-lang="solidity">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// SPDX-License-Identifier: MIT
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">pragma solidity&lt;/span> &lt;span style="color:#f92672">^&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>.&lt;span style="color:#ae81ff">8&lt;/span>.&lt;span style="color:#ae81ff">13&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">contract&lt;/span> &lt;span style="color:#a6e22e">helloworld&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">helloWorld&lt;/span>() &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">pure&lt;/span> &lt;span style="color:#66d9ef">returns&lt;/span> (&lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#66d9ef">memory&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Hello, World!&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://image.runtimes.cc/202505281038400.png" alt="image-20250524145024856">&lt;/p>
&lt;h1 id="å‘è¡Œä»£å¸">å‘è¡Œä»£å¸&lt;/h1>
&lt;p>åœ¨é—²é±¼,æ·˜å®ä¸Šä¹°äº›æµ‹è¯•å¸,ä¹Ÿå¯ä»¥é€šè¿‡æ°´é¾™å¤´è·å–(åªæ˜¯æœ‰ç‚¹è¦æ±‚å’Œé—¨æ§›,ä¸å¦‚ç›´æ¥ä¹°),è¿™é‡Œæˆ‘ä¹°äº†ä¸¤ç¬”
&lt;img src="https://image.runtimes.cc/202505281036642.webp" alt="">&lt;/p>
&lt;p>æ–°å»ºåˆçº¦æ–‡ä»¶&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505291022584.png" alt="image-20250529101100930">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-solidity" data-lang="solidity">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// SPDX-License-Identifier: MIT
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">pragma solidity&lt;/span> &lt;span style="color:#f92672">^&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>.&lt;span style="color:#ae81ff">8&lt;/span>.&lt;span style="color:#ae81ff">13&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#e6db74">&amp;#34;@openzeppelin/contracts/token/ERC20/ERC20.sol&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">contract&lt;/span> &lt;span style="color:#a6e22e">MyError20Token&lt;/span> &lt;span style="color:#66d9ef">is&lt;/span> ERC20{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">constructor&lt;/span>(&lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#66d9ef">memory&lt;/span> _name,&lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#66d9ef">memory&lt;/span> _symbol) ERC20(_name,_symbol){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _mint(msg.sender,&lt;span style="color:#ae81ff">10000&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span> &lt;span style="color:#f92672">**&lt;/span> &lt;span style="color:#ae81ff">18&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://image.runtimes.cc/202505291022541.png" alt="image-20250529101412816">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505291022024.png" alt="image-20250529101510973">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505291022071.png" alt="image-20250529101815851">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505291022160.png" alt="image-20250529102052827">&lt;/p></description><content>&lt;h1 id="helloworldåˆçº¦">HelloWorldåˆçº¦&lt;/h1>
&lt;p>&lt;a href="https://remix.ethereum.org">Remixç¼–è¾‘å™¨&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505281038720.png" alt="image-20250524144934373">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-solidity" data-lang="solidity">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// SPDX-License-Identifier: MIT
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">pragma solidity&lt;/span> &lt;span style="color:#f92672">^&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>.&lt;span style="color:#ae81ff">8&lt;/span>.&lt;span style="color:#ae81ff">13&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">contract&lt;/span> &lt;span style="color:#a6e22e">helloworld&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">helloWorld&lt;/span>() &lt;span style="color:#66d9ef">public&lt;/span> &lt;span style="color:#66d9ef">pure&lt;/span> &lt;span style="color:#66d9ef">returns&lt;/span> (&lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#66d9ef">memory&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Hello, World!&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://image.runtimes.cc/202505281038400.png" alt="image-20250524145024856">&lt;/p>
&lt;h1 id="å‘è¡Œä»£å¸">å‘è¡Œä»£å¸&lt;/h1>
&lt;p>åœ¨é—²é±¼,æ·˜å®ä¸Šä¹°äº›æµ‹è¯•å¸,ä¹Ÿå¯ä»¥é€šè¿‡æ°´é¾™å¤´è·å–(åªæ˜¯æœ‰ç‚¹è¦æ±‚å’Œé—¨æ§›,ä¸å¦‚ç›´æ¥ä¹°),è¿™é‡Œæˆ‘ä¹°äº†ä¸¤ç¬”
&lt;img src="https://image.runtimes.cc/202505281036642.webp" alt="">&lt;/p>
&lt;p>æ–°å»ºåˆçº¦æ–‡ä»¶&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505291022584.png" alt="image-20250529101100930">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-solidity" data-lang="solidity">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// SPDX-License-Identifier: MIT
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">pragma solidity&lt;/span> &lt;span style="color:#f92672">^&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>.&lt;span style="color:#ae81ff">8&lt;/span>.&lt;span style="color:#ae81ff">13&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> &lt;span style="color:#e6db74">&amp;#34;@openzeppelin/contracts/token/ERC20/ERC20.sol&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">contract&lt;/span> &lt;span style="color:#a6e22e">MyError20Token&lt;/span> &lt;span style="color:#66d9ef">is&lt;/span> ERC20{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">constructor&lt;/span>(&lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#66d9ef">memory&lt;/span> _name,&lt;span style="color:#66d9ef">string&lt;/span> &lt;span style="color:#66d9ef">memory&lt;/span> _symbol) ERC20(_name,_symbol){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _mint(msg.sender,&lt;span style="color:#ae81ff">10000&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">10&lt;/span> &lt;span style="color:#f92672">**&lt;/span> &lt;span style="color:#ae81ff">18&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://image.runtimes.cc/202505291022541.png" alt="image-20250529101412816">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505291022024.png" alt="image-20250529101510973">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505291022071.png" alt="image-20250529101815851">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202505291022160.png" alt="image-20250529102052827">&lt;/p></content></item><item><title>DataGrip</title><link>https://connorzhangyu.com/posts/datagrip/</link><pubDate>Sat, 19 Nov 2022 18:25:00 +0000</pubDate><guid>https://connorzhangyu.com/posts/datagrip/</guid><description>&lt;h1 id="æŸ¥çœ‹ddlå’Œå¤åˆ¶ä¸ºinsertè¯­å¥">æŸ¥çœ‹ddlå’Œå¤åˆ¶ä¸ºinsertè¯­å¥&lt;/h1>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051411320.png" alt="">&lt;/p>
&lt;h1 id="æ˜¾ç¤º">æ˜¾ç¤º&lt;/h1>
&lt;h2 id="è®¾ç½®æ•°æ®åº“é¢œè‰²">è®¾ç½®æ•°æ®åº“é¢œè‰²&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051411473.png" alt="image-20230723151325737">&lt;/p>
&lt;h2 id="æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„">æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412133.png" alt="image-20230726133150472">&lt;/p>
&lt;h2 id="æ˜¾ç¤ºè¡¨çš„commnet">æ˜¾ç¤ºè¡¨çš„commnet&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412038.png" alt="image-20230726133353607">&lt;/p>
&lt;h2 id="æ˜¾ç¤ºæ•°æ®åº“ddlæœ€åä¸€æ¬¡æ›´æ–°çš„æ—¶é—´">æ˜¾ç¤ºæ•°æ®åº“DDLæœ€åä¸€æ¬¡æ›´æ–°çš„æ—¶é—´&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412291.png" alt="image-20230726133451693">&lt;/p>
&lt;h1 id="åŒæ­¥æ¯”è¾ƒä¸¤ä¸ªè¡¨çš„æ•°æ®ç»“æ„">åŒæ­¥/æ¯”è¾ƒä¸¤ä¸ªè¡¨çš„æ•°æ®ç»“æ„&lt;/h1>
&lt;p>ç”¨command é€‰ä¸­ ä¸¤ä¸ªæƒ³è¦æ¯”è¾ƒçš„è¡¨,ç„¶ååœ¨å…¶ä¸­ä¸€ä¸ªè¡¨,é€‰æ‹©&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412792.png" alt="image-20230723151708711">&lt;/p>
&lt;p>åªæ˜¾ç¤ºä¸ä¸€æ ·çš„å­—æ®µ
&lt;img src="https://image.runtimes.cc/202404051412925.png" alt="image-20230723151821734">&lt;/p>
&lt;p>æ˜¾ç¤ºå…¨éƒ¨å­—æ®µ,ç»¿è‰²è¡¨ç¤ºä¸ä¸€æ ·&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412733.png" alt="image-20230723151913910">&lt;/p>
&lt;p>ä¹Ÿå¯ä»¥æ¯”è¾ƒä¸¤ä¸ªåº“,è¿˜æ˜¯åˆšæ‰çš„æ–¹æ³•,é€‰ä¸­ä¸¤ä¸ªåº“,å†æ¯”è¾ƒ&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412216.png" alt="image-20230723153819424">&lt;/p>
&lt;p>ç›¸å½“äºNavicatçš„è¿™ä¸ªåŠŸèƒ½&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051413066.png" alt="image-20230723153427586">&lt;/p>
&lt;h1 id="å¤åˆ¶åŠŸèƒ½">å¤åˆ¶åŠŸèƒ½&lt;/h1>
&lt;p>æ ‡è®°1,é€‰ä¸­è¡¨,&lt;code>Command + c&lt;/code> å°±æ˜¯å¤åˆ¶çš„è¡¨å&lt;/p>
&lt;p>æ ‡è®°2,é€‰ä¸­åº“,&lt;code>Command + c&lt;/code> å°±æ˜¯å¤åˆ¶çš„åº“å&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414322.png" alt="image-20230726133739963">&lt;/p>
&lt;p>å³è¾¹çš„é€‰é¡¹,è®©ä½ å¤åˆ¶å‡ºçš„SQLæ ¼å¼æ˜¯ä»€ä¹ˆæ ·çš„,æ¯”å¦‚å¤åˆ¶å‡ºinsertçš„sql,æˆ–è€…updateçš„sql,æˆ–è€…å¯¼å‡ºxml æˆ–è€…,å¤šæ¡è®°å½•å¤åˆ¶å‡ºä¸€æ¡sqlè¯­å¥,ç®€å•ä½¿ç”¨å¯ä»¥å°è¯•&lt;/p>
&lt;p>build-in:&lt;/p>
&lt;ul>
&lt;li>sql inserts&lt;/li>
&lt;li>sql updates&lt;/li>
&lt;/ul>
&lt;p>scripted:&lt;/p>
&lt;ul>
&lt;li>sql-insert-multirow&lt;/li>
&lt;li>Sql-insert-statements&lt;/li>
&lt;li>&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414566.png" alt="image-20230726133946342">&lt;/p>
&lt;h1 id="å¯¼å‡ºçš„åŠŸèƒ½">å¯¼å‡ºçš„åŠŸèƒ½&lt;/h1>
&lt;p>ä½¿ç”¨mysqldump,å¯¼å‡ºæ•´ä¸ªåº“&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414556.png" alt="image-20230726134405227">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414094.png" alt="image-20230726134504395">&lt;/p>
&lt;p>Macç”µè„‘éœ€è¦å®‰è£…,&lt;code>mysql-client&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew install mysql-client
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># äºŒè¿›åˆ¶ç›®å½•(éœ€è¦æ‰‹åŠ¨å¤åˆ¶åˆ°ä¸Šå›¾çš„è·¯å¾„):&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/opt/mysql-client/bin/mysqldump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="å¯¼å…¥sql">å¯¼å…¥SQL&lt;/h1>
&lt;p>è¦åœ¨åº“åä¸Šç‚¹å³é”®&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414735.png" alt="image-20231201154603739">&lt;/p>
&lt;p>è¿™ä¸ªåŠŸèƒ½ç±»ä¼¼äº&lt;/p>
&lt;img src="https://image.runtimes.cc/202404051414049.png" alt="image-20231201154745846" style="zoom:50%;" /></description><content>&lt;h1 id="æŸ¥çœ‹ddlå’Œå¤åˆ¶ä¸ºinsertè¯­å¥">æŸ¥çœ‹ddlå’Œå¤åˆ¶ä¸ºinsertè¯­å¥&lt;/h1>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051411320.png" alt="">&lt;/p>
&lt;h1 id="æ˜¾ç¤º">æ˜¾ç¤º&lt;/h1>
&lt;h2 id="è®¾ç½®æ•°æ®åº“é¢œè‰²">è®¾ç½®æ•°æ®åº“é¢œè‰²&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051411473.png" alt="image-20230723151325737">&lt;/p>
&lt;h2 id="æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„">æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412133.png" alt="image-20230726133150472">&lt;/p>
&lt;h2 id="æ˜¾ç¤ºè¡¨çš„commnet">æ˜¾ç¤ºè¡¨çš„commnet&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412038.png" alt="image-20230726133353607">&lt;/p>
&lt;h2 id="æ˜¾ç¤ºæ•°æ®åº“ddlæœ€åä¸€æ¬¡æ›´æ–°çš„æ—¶é—´">æ˜¾ç¤ºæ•°æ®åº“DDLæœ€åä¸€æ¬¡æ›´æ–°çš„æ—¶é—´&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412291.png" alt="image-20230726133451693">&lt;/p>
&lt;h1 id="åŒæ­¥æ¯”è¾ƒä¸¤ä¸ªè¡¨çš„æ•°æ®ç»“æ„">åŒæ­¥/æ¯”è¾ƒä¸¤ä¸ªè¡¨çš„æ•°æ®ç»“æ„&lt;/h1>
&lt;p>ç”¨command é€‰ä¸­ ä¸¤ä¸ªæƒ³è¦æ¯”è¾ƒçš„è¡¨,ç„¶ååœ¨å…¶ä¸­ä¸€ä¸ªè¡¨,é€‰æ‹©&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412792.png" alt="image-20230723151708711">&lt;/p>
&lt;p>åªæ˜¾ç¤ºä¸ä¸€æ ·çš„å­—æ®µ
&lt;img src="https://image.runtimes.cc/202404051412925.png" alt="image-20230723151821734">&lt;/p>
&lt;p>æ˜¾ç¤ºå…¨éƒ¨å­—æ®µ,ç»¿è‰²è¡¨ç¤ºä¸ä¸€æ ·&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412733.png" alt="image-20230723151913910">&lt;/p>
&lt;p>ä¹Ÿå¯ä»¥æ¯”è¾ƒä¸¤ä¸ªåº“,è¿˜æ˜¯åˆšæ‰çš„æ–¹æ³•,é€‰ä¸­ä¸¤ä¸ªåº“,å†æ¯”è¾ƒ&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051412216.png" alt="image-20230723153819424">&lt;/p>
&lt;p>ç›¸å½“äºNavicatçš„è¿™ä¸ªåŠŸèƒ½&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051413066.png" alt="image-20230723153427586">&lt;/p>
&lt;h1 id="å¤åˆ¶åŠŸèƒ½">å¤åˆ¶åŠŸèƒ½&lt;/h1>
&lt;p>æ ‡è®°1,é€‰ä¸­è¡¨,&lt;code>Command + c&lt;/code> å°±æ˜¯å¤åˆ¶çš„è¡¨å&lt;/p>
&lt;p>æ ‡è®°2,é€‰ä¸­åº“,&lt;code>Command + c&lt;/code> å°±æ˜¯å¤åˆ¶çš„åº“å&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414322.png" alt="image-20230726133739963">&lt;/p>
&lt;p>å³è¾¹çš„é€‰é¡¹,è®©ä½ å¤åˆ¶å‡ºçš„SQLæ ¼å¼æ˜¯ä»€ä¹ˆæ ·çš„,æ¯”å¦‚å¤åˆ¶å‡ºinsertçš„sql,æˆ–è€…updateçš„sql,æˆ–è€…å¯¼å‡ºxml æˆ–è€…,å¤šæ¡è®°å½•å¤åˆ¶å‡ºä¸€æ¡sqlè¯­å¥,ç®€å•ä½¿ç”¨å¯ä»¥å°è¯•&lt;/p>
&lt;p>build-in:&lt;/p>
&lt;ul>
&lt;li>sql inserts&lt;/li>
&lt;li>sql updates&lt;/li>
&lt;/ul>
&lt;p>scripted:&lt;/p>
&lt;ul>
&lt;li>sql-insert-multirow&lt;/li>
&lt;li>Sql-insert-statements&lt;/li>
&lt;li>&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414566.png" alt="image-20230726133946342">&lt;/p>
&lt;h1 id="å¯¼å‡ºçš„åŠŸèƒ½">å¯¼å‡ºçš„åŠŸèƒ½&lt;/h1>
&lt;p>ä½¿ç”¨mysqldump,å¯¼å‡ºæ•´ä¸ªåº“&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414556.png" alt="image-20230726134405227">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414094.png" alt="image-20230726134504395">&lt;/p>
&lt;p>Macç”µè„‘éœ€è¦å®‰è£…,&lt;code>mysql-client&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew install mysql-client
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># äºŒè¿›åˆ¶ç›®å½•(éœ€è¦æ‰‹åŠ¨å¤åˆ¶åˆ°ä¸Šå›¾çš„è·¯å¾„):&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/opt/mysql-client/bin/mysqldump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="å¯¼å…¥sql">å¯¼å…¥SQL&lt;/h1>
&lt;p>è¦åœ¨åº“åä¸Šç‚¹å³é”®&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051414735.png" alt="image-20231201154603739">&lt;/p>
&lt;p>è¿™ä¸ªåŠŸèƒ½ç±»ä¼¼äº&lt;/p>
&lt;img src="https://image.runtimes.cc/202404051414049.png" alt="image-20231201154745846" style="zoom:50%;" /></content></item><item><title>ElasticSearch</title><link>https://connorzhangyu.com/posts/elasticsearch/</link><pubDate>Sat, 19 Nov 2022 18:25:00 +0000</pubDate><guid>https://connorzhangyu.com/posts/elasticsearch/</guid><description>&lt;h1 id="æ‰‹åŠ¨å®‰è£…7x">æ‰‹åŠ¨å®‰è£…7.x&lt;/h1>
&lt;h2 id="æ‰‹åŠ¨å®‰è£…å•æœºelasticsearch7x">æ‰‹åŠ¨å®‰è£…å•æœºElasticSearch7.x&lt;/h2>
&lt;pre tabindex="0">&lt;code># ä¸‹è½½taråŒ…,(6.6.2)
wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.6.2.tar.gz
# è§£å‹ç¼©ä¹‹åä¿®æ”¹é…ç½®æ–‡ä»¶
vi /elasticsearch-7.10.1/config/elasticsearch.yml
network.host: 0.0.0.0 #è®¾ç½®æˆå¤–ç½‘ä¹Ÿå¯ä»¥è®¿é—®
# è¿½åŠ å†…å®¹,ä¿®æ”¹ç³»ç»Ÿç¯å¢ƒè¯¥å˜é‡,ä¿®æ”¹å®Œéœ€è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆ
vi /etc/sysctl.conf
vm.max_map_count=262144
# åŠ è½½å‚æ•°
anthony@base:/usr/local/elasticsearch-6.6.2$ sudo sysctl -p
vm.max_map_count = 262144
# å…è®¸æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°,åŠ å…¥
vim /etc/security/limits.conf
* soft nofile 65536
* hard nofile 65536
* soft nproc 4096 æˆ–è€…(65536)
* hard nproc 4096 æˆ–è€…(65536)
# ä¿®æ”¹JVMåˆ†é…å¤§å° è¿™ä¸¤ä¸ªå€¼è¦ä¸€è‡´
vi config/jvm.options
-Xms4g
-Xmx4g
# å¯åŠ¨
bin/elasticsearch
bin/elasticsearch -d #åå°å¯åŠ¨
&lt;/code>&lt;/pre>&lt;ol>
&lt;li>å®‰è£…åˆ†è¯å™¨ä¸‹è½½è§£å‹ç¼©çš„å“¦elasticsearchçš„pluginç›®å½•ä¸‹IKåˆ†è¯å™¨&lt;a href="https://github.com/medcl/elasticsearch-analysis-ik/releases/tag/v6.6.2">https://github.com/medcl/elasticsearch-analysis-ik/releases/tag/v6.6.2&lt;/a>&lt;/li>
&lt;/ol>
&lt;pre tabindex="0">&lt;code>POST /_analyze { &amp;#34;analyzer&amp;#34;: &amp;#34;ik_smart&amp;#34;, &amp;#34;text&amp;#34;: &amp;#34; ç¨‹åºå‘˜ }
&lt;/code>&lt;/pre>&lt;p>æ‹¼éŸ³åˆ†è¯å™¨&lt;a href="https://github.com/medcl/elasticsearch-analysis-pinyin/releases/tag/v6.6.2">https://github.com/medcl/elasticsearch-analysis-pinyin/releases/tag/v6.6.2&lt;/a>&lt;/p></description><content>&lt;h1 id="æ‰‹åŠ¨å®‰è£…7x">æ‰‹åŠ¨å®‰è£…7.x&lt;/h1>
&lt;h2 id="æ‰‹åŠ¨å®‰è£…å•æœºelasticsearch7x">æ‰‹åŠ¨å®‰è£…å•æœºElasticSearch7.x&lt;/h2>
&lt;pre tabindex="0">&lt;code># ä¸‹è½½taråŒ…,(6.6.2)
wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.6.2.tar.gz
# è§£å‹ç¼©ä¹‹åä¿®æ”¹é…ç½®æ–‡ä»¶
vi /elasticsearch-7.10.1/config/elasticsearch.yml
network.host: 0.0.0.0 #è®¾ç½®æˆå¤–ç½‘ä¹Ÿå¯ä»¥è®¿é—®
# è¿½åŠ å†…å®¹,ä¿®æ”¹ç³»ç»Ÿç¯å¢ƒè¯¥å˜é‡,ä¿®æ”¹å®Œéœ€è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆ
vi /etc/sysctl.conf
vm.max_map_count=262144
# åŠ è½½å‚æ•°
anthony@base:/usr/local/elasticsearch-6.6.2$ sudo sysctl -p
vm.max_map_count = 262144
# å…è®¸æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°,åŠ å…¥
vim /etc/security/limits.conf
* soft nofile 65536
* hard nofile 65536
* soft nproc 4096 æˆ–è€…(65536)
* hard nproc 4096 æˆ–è€…(65536)
# ä¿®æ”¹JVMåˆ†é…å¤§å° è¿™ä¸¤ä¸ªå€¼è¦ä¸€è‡´
vi config/jvm.options
-Xms4g
-Xmx4g
# å¯åŠ¨
bin/elasticsearch
bin/elasticsearch -d #åå°å¯åŠ¨
&lt;/code>&lt;/pre>&lt;ol>
&lt;li>å®‰è£…åˆ†è¯å™¨ä¸‹è½½è§£å‹ç¼©çš„å“¦elasticsearchçš„pluginç›®å½•ä¸‹IKåˆ†è¯å™¨&lt;a href="https://github.com/medcl/elasticsearch-analysis-ik/releases/tag/v6.6.2">https://github.com/medcl/elasticsearch-analysis-ik/releases/tag/v6.6.2&lt;/a>&lt;/li>
&lt;/ol>
&lt;pre tabindex="0">&lt;code>POST /_analyze { &amp;#34;analyzer&amp;#34;: &amp;#34;ik_smart&amp;#34;, &amp;#34;text&amp;#34;: &amp;#34; ç¨‹åºå‘˜ }
&lt;/code>&lt;/pre>&lt;p>æ‹¼éŸ³åˆ†è¯å™¨&lt;a href="https://github.com/medcl/elasticsearch-analysis-pinyin/releases/tag/v6.6.2">https://github.com/medcl/elasticsearch-analysis-pinyin/releases/tag/v6.6.2&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /medcl/_analyze
{
&amp;#34;text&amp;#34;: [&amp;#34;ç¨‹åºå‘˜&amp;#34;],
&amp;#34;analyzer&amp;#34;: &amp;#34;pinyin_analyzer&amp;#34;
}
&lt;/code>&lt;/pre>&lt;p>æŠ¥é”™åŸå› :&lt;/p>
&lt;pre tabindex="0">&lt;code># chown -R ç”¨æˆ·å:ç”¨æˆ·å ç›®å½•å
Exception in thread &amp;#34;main&amp;#34; java.nio.file.AccessDeniedException: /root/home/searchengine/elasticsearch-6.2.4/config/jvm.options
at sun.nio.fs.UnixException.translateToIOException(UnixException.java:84)
at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)
at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)
at sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:214)
at java.nio.file.Files.newByteChannel(Files.java:361)
at java.nio.file.Files.newByteChannel(Files.java:407)
at java.nio.file.spi.FileSystemProvider.newInputStream(FileSystemProvider.java:384)
at java.nio.file.Files.newInputStream(Files.java:152)
at org.elasticsearch.tools.launchers.JvmOptionsParser.main(JvmOptionsParser.java:58)
&lt;/code>&lt;/pre>&lt;h2 id="æ‰‹åŠ¨å®‰è£…é›†ç¾¤elasticsearch7x">æ‰‹åŠ¨å®‰è£…é›†ç¾¤ElasticSearch7.x&lt;/h2>
&lt;p>1.ä¿®æ”¹ä¸€å°elasticsearchçš„elasticsearch.yml&lt;/p>
&lt;pre tabindex="0">&lt;code>cluster.name: kkb-es
node.name: node0
node.master: true
network.host: 0.0.0.0
http.port: 9200
transport.tcp.port: 9300
discovery.zen.ping.unicast.hosts: [&amp;#34;127.0.0.1:9300&amp;#34;,&amp;#34;127.0.0.1:9301&amp;#34;,&amp;#34;127.0.0
.1:9302&amp;#34;]
discovery.zen.minimum_master_nodes: 2
http.cors.enabled: true
http.cors.allow-origin: &amp;#34;*&amp;#34;
&lt;/code>&lt;/pre>&lt;p>2.æ‹·è´åˆ°å…¶ä»–çš„æœåŠ¡å™¨&lt;/p>
&lt;p>ä¿®æ”¹ä¸Šé¢å‘¢çš„é…ç½®æ–‡ä»¶ä¸­çš„3ä¸ªé…ç½®&lt;/p>
&lt;pre tabindex="0">&lt;code>node.name: node0
http.port: 9200
transport.tcp.port: 9300
&lt;/code>&lt;/pre>&lt;p>3.æ£€æŸ¥å¥åº·çŠ¶æ€&lt;/p>
&lt;pre tabindex="0">&lt;code>http://localhost:9200/_cat/health?v
&lt;/code>&lt;/pre>&lt;h2 id="æ‰‹åŠ¨å•æœºkibana7xå®‰è£…">æ‰‹åŠ¨å•æœºKibana7.xå®‰è£…&lt;/h2>
&lt;pre tabindex="0">&lt;code># ä¸‹è½½è§£å‹
https://artifacts.elastic.co/downloads/kibana/kibana-6.6.2-linux-x86_64.tar.gz
# ä¿®æ”¹é…ç½®æ–‡ä»¶
vi kibana-6.4.2-linux-x86_64/config/kibana.yml
server.port: 5600
server.host: &amp;#34;0.0.0.0&amp;#34;
elasticsearch.url: &amp;#34;http://localhost:9200&amp;#34;
# å¯åŠ¨,åå°å¯åŠ¨
./bin/kibana &amp;amp;
&lt;/code>&lt;/pre>&lt;h2 id="æ‰‹åŠ¨å•æœºlogstash7xå®‰è£…">æ‰‹åŠ¨å•æœºLogstash7.xå®‰è£…&lt;/h2>
&lt;p>&lt;code>mysql-connector-java-5.1.48.jar&lt;/code>æ˜¯æ”¾åœ¨&lt;code>logstash-6.6.2/logstash-core/lib/jars&lt;/code>,è¿™æ ·å°±ä¸éœ€è¦å†™ç›¸å¯¹è·¯å¾„äº†&lt;/p>
&lt;pre tabindex="0">&lt;code>input {
jdbc {
jdbc_driver_library =&amp;gt; &amp;#34;mysql-connector-java-5.1.48.jar&amp;#34;
jdbc_driver_class =&amp;gt; &amp;#34;com.mysql.jdbc.Driver&amp;#34;
jdbc_connection_string =&amp;gt; &amp;#34;jdbc:mysql://192.168.111.128:3306/ssm&amp;#34;
jdbc_user =&amp;gt; &amp;#34;root&amp;#34;
jdbc_password =&amp;gt; &amp;#34;123456&amp;#34;
jdbc_paging_enabled =&amp;gt; &amp;#34;true&amp;#34;
jdbc_page_size =&amp;gt; &amp;#34;2&amp;#34;
statement =&amp;gt; &amp;#34;SELECT id,&amp;#39;name&amp;#39;,phone FROM phone where update_data &amp;gt;= :sql_last_value&amp;#34;
tracking_column_type =&amp;gt; &amp;#34;timestamp&amp;#34;
tracking_column =&amp;gt; &amp;#34;update_date&amp;#34;
schedule =&amp;gt; &amp;#34;* * * * *&amp;#34;
}
}
output {
elasticsearch {
index =&amp;gt; &amp;#34;phone&amp;#34;
document_id=&amp;gt; &amp;#34;%{id}&amp;#34;
hosts =&amp;gt; [&amp;#34;http://192.168.111.128:9200&amp;#34;]
}
}
&lt;/code>&lt;/pre>&lt;p>å¯åŠ¨å‘½ä»¤&lt;/p>
&lt;pre tabindex="0">&lt;code>./logstash -f ../config/logstash-sample.conf
&lt;/code>&lt;/pre>&lt;h1 id="æ‰‹åŠ¨å®‰è£…8x">æ‰‹åŠ¨å®‰è£…8.x&lt;/h1>
&lt;aside>
ğŸ“Œ 8.0 å·²ç»è‡ªå¸¦äº†jdk
&lt;/aside>
&lt;h2 id="äºŒè¿›åˆ¶åŒ…å®‰è£…es">äºŒè¿›åˆ¶åŒ…å®‰è£…ES&lt;/h2>
&lt;h3 id="å®‰è£…">å®‰è£…&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¸‹è½½åŒ…å¹¶è§£å‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wget https://xxxx.tar
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¯åŠ¨./elasticsearch&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./bin/elasticsearch
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="è¿è¡Œç»“æœ">è¿è¡Œç»“æœ&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>âœ… Elasticsearch security features have been automatically configured!
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>âœ… Authentication is enabled and cluster connections are encrypted.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â„¹ï¸ Password &lt;span style="color:#66d9ef">for&lt;/span> the elastic user &lt;span style="color:#f92672">(&lt;/span>reset with &lt;span style="color:#e6db74">`&lt;/span>bin/elasticsearch-reset-password -u elastic&lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#f92672">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Shb2+OuCKthxFTxD-*jE
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â„¹ï¸ HTTP CA certificate SHA-256 fingerprint:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ceb6add33653a4c8f3493bddde839cdfcf1035a3a50cb01247962495f15ea40f
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â„¹ï¸ Configure Kibana to use this cluster:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â€¢ Run Kibana and click the configuration link in the terminal when Kibana starts.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â€¢ Copy the following enrollment token and paste it into Kibana in your browser &lt;span style="color:#f92672">(&lt;/span>valid &lt;span style="color:#66d9ef">for&lt;/span> the next &lt;span style="color:#ae81ff">30&lt;/span> minutes&lt;span style="color:#f92672">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> eyJ2ZXIiOiI4LjAuMCIsImFkciI6WyIxMC4wLjIuNDo5MjAwIl0sImZnciI6ImNlYjZhZGQzMzY1M2E0YzhmMzQ5M2JkZGRlODM5Y2RmY2YxMDM1YTNhNTBjYjAxMjQ3OTYyNDk1ZjE1ZWE0MGYiLCJrZXkiOiJXaEV4SDM4QlZXV242cU9KejgxNTprUVliUEY0dlJfaU56MnRFaDlRY0hnIn0&lt;span style="color:#f92672">=&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â„¹ï¸ Configure other nodes to join this cluster:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â€¢ On this node:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> âƒ Create an enrollment token with &lt;span style="color:#e6db74">`&lt;/span>bin/elasticsearch-create-enrollment-token -s node&lt;span style="color:#e6db74">`&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> âƒ Uncomment the transport.host setting at the end of config/elasticsearch.yml.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> âƒ Restart Elasticsearch.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>â€¢ On other nodes:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> âƒ Start Elasticsearch with &lt;span style="color:#e6db74">`&lt;/span>bin/elasticsearch --enrollment-token &amp;lt;token&amp;gt;&lt;span style="color:#e6db74">`&lt;/span>, using the enrollment token that you generated.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="åœæ­¢æœåŠ¡ä¿®æ”¹é…ç½®æ–‡ä»¶">åœæ­¢æœåŠ¡,ä¿®æ”¹é…ç½®æ–‡ä»¶&lt;/h3>
&lt;p>ç„¶åè¾“å…¥ï¼šcurl 127.0.0.1:9200,è¿”å›æ˜¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>hy@localhost ~&lt;span style="color:#f92672">]&lt;/span>$ curl 127.0.0.1:9200
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl: &lt;span style="color:#f92672">(&lt;/span>52&lt;span style="color:#f92672">)&lt;/span> Empty reply from server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€ŒESé‚£è¾¹ä¹Ÿæœ‰å“åº”&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># çœ‹æ¥è¿™å’Œä»¥å‰çš„7.1.1ç‰ˆæœ¬ä¸ä¸€æ ·äº†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>2022-02-19T05:02:02,812&lt;span style="color:#f92672">][&lt;/span>WARN &lt;span style="color:#f92672">][&lt;/span>o.e.x.s.t.n.SecurityNetty4HttpServerTransport&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">[&lt;/span>localhost.localdomain&lt;span style="color:#f92672">]&lt;/span> received plaintext http traffic on an https channel, closing connection Netty4HttpChannel&lt;span style="color:#f92672">{&lt;/span>localAddress&lt;span style="color:#f92672">=&lt;/span>/127.0.0.1:9200, remoteAddress&lt;span style="color:#f92672">=&lt;/span>/127.0.0.1:38518&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>2022-02-19T05:02:27,144&lt;span style="color:#f92672">][&lt;/span>WARN &lt;span style="color:#f92672">][&lt;/span>o.e.x.s.t.n.SecurityNetty4HttpServerTransport&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#f92672">[&lt;/span>localhost.localdomain&lt;span style="color:#f92672">]&lt;/span> received plaintext http traffic on an https channel, closing connection Netty4HttpChannel&lt;span style="color:#f92672">{&lt;/span>localAddress&lt;span style="color:#f92672">=&lt;/span>/&lt;span style="color:#f92672">[&lt;/span>0:0:0:0:0:0:0:1&lt;span style="color:#f92672">]&lt;/span>:9200, remoteAddress&lt;span style="color:#f92672">=&lt;/span>/&lt;span style="color:#f92672">[&lt;/span>0:0:0:0:0:0:0:1&lt;span style="color:#f92672">]&lt;/span>:56174&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¿®æ”¹é…ç½®æ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># éœ€è¦æŠŠsecurity featureséƒ½å…³é—­ï¼Œå¦åˆ™httpä¸å¯¹å¤–æœåŠ¡äº†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># trueæ”¹æˆfalse&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>xpack.security.http.ssl:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> enabled: false
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> keystore.path: certs/http.p12
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Enable encryption and mutual authentication between cluster nodes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>xpack.security.transport.ssl:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> enabled: false
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æµ‹è¯•è®¿é—®">æµ‹è¯•è®¿é—®&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>http://localhost:9200
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>éœ€è¦è¾“å…¥è´¦å·å’Œå¯†ç :elastic / Shb2+OuCKthxFTxD-*jE
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="javaè®¿é—®æµ‹è¯•">javaè®¿é—®æµ‹è¯•&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;dependency&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;groupId&amp;gt;&lt;/span>org.elasticsearch.client&lt;span style="color:#f92672">&amp;lt;/groupId&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;artifactId&amp;gt;&lt;/span>elasticsearch-rest-client&lt;span style="color:#f92672">&amp;lt;/artifactId&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;version&amp;gt;&lt;/span>8.0.0&lt;span style="color:#f92672">&amp;lt;/version&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;/dependency&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span>@Bean(destroyMethod = &amp;#34;close&amp;#34;)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>public RestClient restClient() throws CertificateException, IOException, KeyStoreException, NoSuchAlgorithmException, KeyManagementException {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> final CredentialsProvider credentialsProvider =
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new BasicCredentialsProvider();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> credentialsProvider.setCredentials(AuthScope.ANY,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new UsernamePasswordCredentials(&amp;#34;elastic&amp;#34;, &amp;#34;VWFjE60dbpKIjbajGJQ4&amp;#34;));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Path caCertificatePath = Paths.get(&amp;#34;E:\\es\\elasticsearch-8.0.0-windows-x86_64\\elasticsearch-8.0.0\\config\\certs\\http_ca.crt&amp;#34;);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CertificateFactory factory =
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CertificateFactory.getInstance(&amp;#34;X.509&amp;#34;);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Certificate trustedCa;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> try (InputStream is = Files.newInputStream(caCertificatePath)) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> trustedCa = factory.generateCertificate(is);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> KeyStore trustStore = KeyStore.getInstance(&amp;#34;pkcs12&amp;#34;);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> trustStore.load(null, null);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> trustStore.setCertificateEntry(&amp;#34;ca&amp;#34;, trustedCa);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> SSLContextBuilder sslContextBuilder = SSLContexts.custom()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .loadTrustMaterial(trustStore, null);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> final SSLContext sslContext = sslContextBuilder.build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RestClientBuilder builder = RestClient.builder(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> new HttpHost(&amp;#34;localhost&amp;#34;, 9200, &amp;#34;https&amp;#34;))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .setHttpClientConfigCallback(httpClientBuilder -&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> httpClientBuilder.setDefaultCredentialsProvider(credentialsProvider);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> return httpClientBuilder.setSSLContext(sslContext);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> return builder.build();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-java" data-lang="java">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//æ³¨å…¥client&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">@Autowired&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RestClient restClient;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Request request &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Request(&lt;span style="color:#e6db74">&amp;#34;GET&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;/ess_book/_doc/1&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Response response &lt;span style="color:#f92672">=&lt;/span> restClient.&lt;span style="color:#a6e22e">performRequest&lt;/span>(request);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">return&lt;/span> EntityUtils.&lt;span style="color:#a6e22e">toString&lt;/span>(response.&lt;span style="color:#a6e22e">getEntity&lt;/span>());
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="é›†ç¾¤å®‰è£…es">é›†ç¾¤å®‰è£…ES&lt;/h2>
&lt;p>&lt;a href="https://juejin.cn/post/7066717637564170271">å…¨æ ˆå¼€å‘ä¹‹ElasticSearch8.0åˆ†å¸ƒå¼æœç´¢å¼•æ“é›†ç¾¤åŠå…¶é«˜å¯ç”¨æµ‹è¯• - æ˜é‡‘&lt;/a>&lt;/p>
&lt;h2 id="å®‰è£…kibana">å®‰è£…Kibana&lt;/h2>
&lt;h1 id="å®‰è£…æŠ¥é”™">å®‰è£…æŠ¥é”™&lt;/h1>
&lt;p>max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim /etc/sysctl.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vm.max_map_count&lt;span style="color:#f92672">=&lt;/span>****262144
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä½¿ç”Ÿæ•ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sysctl -p****
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="å®‰è£…æ’ä»¶">å®‰è£…æ’ä»¶&lt;/h1>
&lt;h3 id="å®‰è£…head">å®‰è£…HEAD&lt;/h3>
&lt;p>Headæ˜¯elasticsearchçš„é›†ç¾¤ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ç”¨äºæ•°æ®çš„æµè§ˆå’ŒæŸ¥è¯¢&lt;/p>
&lt;p>(1)elasticsearch-headæ˜¯ä¸€æ¬¾å¼€æºè½¯ä»¶ï¼Œè¢«æ‰˜ç®¡åœ¨githubä¸Šé¢ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨å®ƒï¼Œå¿…é¡»å…ˆå®‰è£…gitï¼Œé€šè¿‡gitè·å–elasticsearch-head&lt;/p>
&lt;p>(2)è¿è¡Œelasticsearch-headä¼šç”¨åˆ°gruntï¼Œè€Œgruntéœ€è¦npmåŒ…ç®¡ç†å™¨ï¼Œæ‰€ä»¥nodejsæ˜¯å¿…é¡»è¦å®‰è£…çš„&lt;/p>
&lt;p>(3)elasticsearch5.0ä¹‹åï¼Œelasticsearch-headä¸åšä¸ºæ’ä»¶æ”¾åœ¨å…¶pluginsç›®å½•ä¸‹äº†ã€‚ä½¿ç”¨gitæ‹·è´elasticsearch-headåˆ°æœ¬åœ°&lt;/p>
&lt;p>cd /usr/local/&lt;/p>
&lt;p>git clone git://github.com/mobz/elasticsearch-head.git&lt;/p>
&lt;p>(4)å®‰è£…elasticsearch-headä¾èµ–åŒ…&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> local]# npm install -g grunt-cli&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> _site]# cd /usr/local/elasticsearch-head/&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> elasticsearch-head]# cnpm install&lt;/p>
&lt;p>(5)ä¿®æ”¹Gruntfile.js&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> _site]# cd /usr/local/elasticsearch-head/&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> elasticsearch-head]# vi Gruntfile.js&lt;/p>
&lt;p>åœ¨connect&amp;ndash;&amp;gt;server&amp;ndash;&amp;gt;optionsä¸‹é¢æ·»åŠ ï¼šhostname:â€™*â€™ï¼Œå…è®¸æ‰€æœ‰IPå¯ä»¥è®¿é—®&lt;/p>
&lt;p>(6)ä¿®æ”¹elasticsearch-headé»˜è®¤è¿æ¥åœ°å€[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> elasticsearch-head]# cd /usr/local/elasticsearch-head/_site/&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> _site]# vi app.js&lt;/p>
&lt;p>å°†this.base_uri = this.config.base_uri || this.prefs.get(&amp;ldquo;app-base_uri&amp;rdquo;) || &amp;ldquo;http://localhost:9200&amp;rdquo;;ä¸­çš„localhostä¿®æ”¹æˆä½ esçš„æœåŠ¡å™¨åœ°å€&lt;/p>
&lt;p>(7)é…ç½®elasticsearchå…è®¸è·¨åŸŸè®¿é—®&lt;/p>
&lt;p>æ‰“å¼€elasticsearchçš„é…ç½®æ–‡ä»¶elasticsearch.ymlï¼Œåœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸‹é¢ä¸¤è¡Œä»£ç å³å¯ï¼š&lt;/p>
&lt;p>http.cors.enabled: true&lt;/p>
&lt;p>http.cors.allow-origin: &amp;ldquo;*&amp;rdquo;&lt;/p>
&lt;p>(8)æ‰“å¼€9100ç«¯å£&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> elasticsearch-head]# firewall-cmd &amp;ndash;zone=public &amp;ndash;add-port=9100/tcp &amp;ndash;permanent&lt;/p>
&lt;p>é‡å¯é˜²ç«å¢™&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> elasticsearch-head]# firewall-cmd &amp;ndash;reload&lt;/p>
&lt;p>(9)å¯åŠ¨elasticsearch&lt;/p>
&lt;p>(10)å¯åŠ¨elasticsearch-head&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> _site]# cd /usr/local/elasticsearch-head/&lt;/p>
&lt;p>[root&lt;a href="#ZgotmplZ">@localhost&lt;/a> elasticsearch-head]# node_modules/grunt/bin/grunt server&lt;/p>
&lt;p>(11)è®¿é—®elasticsearch-head&lt;/p>
&lt;p>å…³é—­é˜²ç«å¢™ï¼šsystemctl stop firewalld.service&lt;/p>
&lt;p>æµè§ˆå™¨è¾“å…¥ç½‘å€ï¼š&lt;a href="http://192.168.25.131:9100/">http://192.168.25.131:9100/&lt;/a>&lt;/p>
&lt;h3 id="å®‰è£…ä¸­æ–‡åˆ†è¯å™¨">å®‰è£…ä¸­æ–‡åˆ†è¯å™¨&lt;/h3>
&lt;p>(1)ä¸‹è½½ä¸­æ–‡åˆ†è¯å™¨&lt;a href="https://github.com/medcl/elasticsearch-analysis-ik">https://github.com/medcl/elasticsearch-analysis-ik&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>ä¸‹è½½elasticsearch-analysis-ik-master.zip
&lt;/code>&lt;/pre>&lt;p>(2)è§£å‹elasticsearch-analysis-ik-master.zip&lt;/p>
&lt;p>unzip elasticsearch-analysis-ik-master.zip&lt;/p>
&lt;p>(3)è¿›å…¥elasticsearch-analysis-ik-masterï¼Œç¼–è¯‘æºç &lt;/p>
&lt;p>mvn clean install -Dmaven.test.skip=true&lt;/p>
&lt;p>(4)åœ¨esçš„pluginsæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºç›®å½•ik&lt;/p>
&lt;p>(5)å°†ç¼–è¯‘åç”Ÿæˆçš„elasticsearch-analysis-ik-ç‰ˆæœ¬.zipç§»åŠ¨åˆ°ikä¸‹ï¼Œå¹¶è§£å‹&lt;/p>
&lt;p>(6)è§£å‹åçš„å†…å®¹ç§»åŠ¨åˆ°ikç›®å½•ä¸‹&lt;/p>
&lt;h3 id="åˆ†è¯å™¨ä»‹ç»åŠå†…ç½®åˆ†è¯å™¨">åˆ†è¯å™¨ä»‹ç»åŠå†…ç½®åˆ†è¯å™¨&lt;/h3>
&lt;p>åˆ†è¯å™¨ï¼šä»ä¸€ä¸²æ–‡æœ¬ä¸­åˆ‡åˆ†å‡ºä¸€ä¸ªä¸€ä¸ªçš„è¯æ¡ï¼Œå¹¶å¯¹æ¯ä¸ªè¯æ¡è¿›è¡Œæ ‡å‡†åŒ–&lt;/p>
&lt;p>åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š&lt;/p>
&lt;p>character filterï¼šåˆ†è¯ä¹‹å‰çš„é¢„å¤„ç†ï¼Œè¿‡æ»¤æ‰HTMLæ ‡ç­¾ï¼Œç‰¹æ®Šç¬¦å·è½¬æ¢ç­‰&lt;/p>
&lt;p>tokenizerï¼šåˆ†è¯&lt;/p>
&lt;p>token filterï¼šæ ‡å‡†åŒ–&lt;/p>
&lt;p>å†…ç½®åˆ†è¯å™¨ï¼š&lt;/p>
&lt;p>standard åˆ†è¯å™¨ï¼š(é»˜è®¤çš„)ä»–ä¼šå°†è¯æ±‡å•å…ƒè½¬æ¢æˆå°å†™å½¢å¼ï¼Œå¹¶å»é™¤åœç”¨è¯å’Œæ ‡ç‚¹ç¬¦å·ï¼Œæ”¯æŒä¸­æ–‡é‡‡ç”¨çš„æ–¹æ³•ä¸ºå•å­—åˆ‡åˆ†&lt;/p>
&lt;p>simple åˆ†è¯å™¨ï¼šé¦–å…ˆä¼šé€šè¿‡éå­—æ¯å­—ç¬¦æ¥åˆ†å‰²æ–‡æœ¬ä¿¡æ¯ï¼Œç„¶åå°†è¯æ±‡å•å…ƒç»Ÿä¸€ä¸ºå°å†™å½¢å¼ã€‚è¯¥åˆ†æå™¨ä¼šå»æ‰æ•°å­—ç±»å‹çš„å­—ç¬¦ã€‚&lt;/p>
&lt;p>Whitespace åˆ†è¯å™¨ï¼šä»…ä»…æ˜¯å»é™¤ç©ºæ ¼ï¼Œå¯¹å­—ç¬¦æ²¡æœ‰lowcaseåŒ–,ä¸æ”¯æŒä¸­æ–‡ï¼›å¹¶ä¸”ä¸å¯¹ç”Ÿæˆçš„è¯æ±‡å•å…ƒè¿›è¡Œå…¶ä»–çš„æ ‡å‡†åŒ–å¤„ç†ã€‚&lt;/p>
&lt;p>language åˆ†è¯å™¨ï¼šç‰¹å®šè¯­è¨€çš„åˆ†è¯å™¨ï¼Œä¸æ”¯æŒä¸­æ–‡&lt;/p>
&lt;h1 id="apiç®€å•ä½¿ç”¨">APIç®€å•ä½¿ç”¨&lt;/h1>
&lt;h1 id="æŸ¥è¯¢ç´¢å¼•å’Œæ˜ å°„">æŸ¥è¯¢ç´¢å¼•å’Œæ˜ å°„&lt;/h1>
&lt;pre tabindex="0">&lt;code># è¿™ä¸¤ä¸ªéƒ½æ˜¯æŸ¥çœ‹ç´¢å¼•,åªæ˜¯ç¬¬ä¸‰è¡Œæ¯”ç¬¬ä¸‰è¡Œå¤šå‡ ä¸ªå­—æ®µ
GET lib
GET /lib/_settings
# æŸ¥è¯¢æ‰€æœ‰ç´¢å¼•
GET /_all/_settings
# æŸ¥è¯¢æ˜ å°„
GET /lib2/_mapping
&lt;/code>&lt;/pre>&lt;h1 id="æ·»åŠ ç´¢å¼•">æ·»åŠ ç´¢å¼•&lt;/h1>
&lt;pre tabindex="0">&lt;code># æ–¹å¼ä¸€,ä½¿ç”¨çš„æ˜¯é»˜è®¤çš„é…ç½®
PUT /lib
# æ–¹å¼äºŒ
PUT /lib/
{
&amp;#34;settings&amp;#34;: {
&amp;#34;index&amp;#34;: {
&amp;#34;number_of_shards&amp;#34;: 5,
&amp;#34;number_of_replicas&amp;#34;: 1
}
}
}
# æ–¹å¼ä¸‰,æŒ‡å®šå­—æ®µç±»å‹
PUT /lib3
{
&amp;#34;mappings&amp;#34;: {
&amp;#34;user&amp;#34;:{
&amp;#34;properties&amp;#34;:{
&amp;#34;name&amp;#34;:{&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;},
&amp;#34;address&amp;#34;:{&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;},
&amp;#34;age&amp;#34;:{&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;},
&amp;#34;interests&amp;#34;:{&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;},
&amp;#34;birthday&amp;#34;:{&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;}
}
}
}
}
&lt;/code>&lt;/pre>&lt;h1 id="æ·»åŠ æ–‡æ¡£">æ·»åŠ æ–‡æ¡£&lt;/h1>
&lt;pre tabindex="0">&lt;code># æŒ‡å®šidçš„æ—¶å€™ç”¨PUT
PUT /lib/user/1
{
&amp;#34;first_name&amp;#34;:&amp;#34;Jame&amp;#34;,
&amp;#34;last_name&amp;#34;:&amp;#34;Smith&amp;#34;,
&amp;#34;age&amp;#34;:&amp;#34;32&amp;#34;,
&amp;#34;about&amp;#34;:&amp;#34;I like to collect rock albums&amp;#34;,
&amp;#34;interests&amp;#34;:[&amp;#34;music&amp;#34;]
}
# æ²¡æœ‰æŒ‡å®šIDç”¨POST,åˆ›å»ºçš„æ—¶å€™ä¼šè‡ªåŠ¨ç”ŸæˆID
POST /lib/user/
{
&amp;#34;first_name&amp;#34;:&amp;#34;anthony&amp;#34;,
&amp;#34;last_name&amp;#34;:&amp;#34;Smith&amp;#34;,
&amp;#34;age&amp;#34;:&amp;#34;32&amp;#34;,
&amp;#34;about&amp;#34;:&amp;#34;I like to collect rock albums&amp;#34;,
&amp;#34;interests&amp;#34;:[&amp;#34;music&amp;#34;]
}
&lt;/code>&lt;/pre>&lt;h1 id="æŸ¥è¯¢æ–‡æ¡£">æŸ¥è¯¢æ–‡æ¡£&lt;/h1>
&lt;pre tabindex="0">&lt;code># æŒ‡å®šID
GET /lib/user/1
# æŸ¥çœ‹æ–‡æ¡£ä¸­çš„æŒ‡å®šå­—æ®µ
GET /lib/user/1?_source=age,about
# æŸ¥è¯¢ç´¢å¼•ä¸‹çš„æ‰€æœ‰æ–‡æ¡£
GET /tt/ttt/_search
&lt;/code>&lt;/pre>&lt;h1 id="æ›´æ–°æ–‡æ¡£">æ›´æ–°æ–‡æ¡£&lt;/h1>
&lt;pre tabindex="0">&lt;code># ä»¥è¦†ç›–çš„æ–¹å¼,å¦‚æœæœ‰è¿™ä¸ªid,å°±è¦†ç›–æ›´æ–°,å¦‚æœæ²¡æœ‰id,å°±åˆ›å»º
PUT /lib/user/1
{
&amp;#34;first_name&amp;#34;:&amp;#34;Jame&amp;#34;,
&amp;#34;last_name&amp;#34;:&amp;#34;Smith&amp;#34;,
&amp;#34;age&amp;#34;:&amp;#34;36&amp;#34;,
&amp;#34;about&amp;#34;:&amp;#34;I like to collect rock albums&amp;#34;,
&amp;#34;interests&amp;#34;:[&amp;#34;music&amp;#34;]
}
# åªæ˜¯æ›´æ–°æ–‡æ¡£
POST /lib/user/1/_update
{
&amp;#34;doc&amp;#34;:{
&amp;#34;age&amp;#34;:&amp;#34;37&amp;#34;
}
}
&lt;/code>&lt;/pre>&lt;h1 id="åˆ é™¤æ–‡æ¡£å’Œç´¢å¼•">åˆ é™¤æ–‡æ¡£å’Œç´¢å¼•&lt;/h1>
&lt;pre tabindex="0">&lt;code># åˆ é™¤æ–‡æ¡£
DELETE /lib/user/1
# åˆ é™¤ç´¢å¼•
DELETE /lib
&lt;/code>&lt;/pre>&lt;h1 id="muliget">MuliGet&lt;/h1>
&lt;p>MuliGet éœ€è¦ID,æ‰èƒ½å®ç°&lt;/p>
&lt;pre tabindex="0">&lt;code># æ‰¹é‡æŸ¥è¯¢,è¿™æ˜¯æŸ¥å‡ºå…¨éƒ¨æ•°æ®
GET /_mget
{
&amp;#34;docs&amp;#34;:[
{
&amp;#34;_index&amp;#34;:&amp;#34;lib&amp;#34;,
&amp;#34;_type&amp;#34;:&amp;#34;user&amp;#34;,
&amp;#34;_id&amp;#34;:1
},
{
&amp;#34;_index&amp;#34;:&amp;#34;lib&amp;#34;,
&amp;#34;_type&amp;#34;:&amp;#34;user&amp;#34;,
&amp;#34;_id&amp;#34;:2
},
{
&amp;#34;_index&amp;#34;:&amp;#34;lib&amp;#34;,
&amp;#34;_type&amp;#34;:&amp;#34;user&amp;#34;,
&amp;#34;_id&amp;#34;:3
}
]
}
# æ‰¹é‡æŸ¥è¯¢,ç­›é€‰å­—æ®µ
GET /_mget
{
&amp;#34;docs&amp;#34;:[
{
&amp;#34;_index&amp;#34;:&amp;#34;lib&amp;#34;,
&amp;#34;_type&amp;#34;:&amp;#34;user&amp;#34;,
&amp;#34;_id&amp;#34;:1,
&amp;#34;_source&amp;#34;:&amp;#34;interests&amp;#34;
},
{
&amp;#34;_index&amp;#34;:&amp;#34;lib&amp;#34;,
&amp;#34;_type&amp;#34;:&amp;#34;user&amp;#34;,
&amp;#34;_id&amp;#34;:2,
&amp;#34;_source&amp;#34;:[&amp;#34;interests&amp;#34;,&amp;#34;age&amp;#34;]
}]
}
# MuliGetæ‰¹é‡æŸ¥è¯¢çš„æ˜¯åŒä¸€ä¸ªæ–‡æ¡£æ—¶å€™,å¯ä»¥ç®€å†™æ–¹å¼
GET /lib/user/_mget
{
&amp;#34;docs&amp;#34;: [
{
&amp;#34;_id&amp;#34;: 1
},
{
&amp;#34;_type&amp;#34;: &amp;#34;user&amp;#34;,
&amp;#34;_id&amp;#34;: 2
}
]
}
# æ›´ç®€å•çš„æ–¹å¼
GET /lib/user/_mget
{
&amp;#34;ids&amp;#34;: [&amp;#34;1&amp;#34;,&amp;#34;2&amp;#34;]
}
&lt;/code>&lt;/pre>&lt;h1 id="bulkæ‰¹é‡æ’å…¥">Bulkæ‰¹é‡æ’å…¥&lt;/h1>
&lt;p>bulkçš„æ ¼å¼ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>{action:{metadata}}
{requstbody}
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>action:&lt;/li>
&lt;li>createï¼šæ–‡æ¡£ä¸å­˜åœ¨æ—¶åˆ›å»º&lt;/li>
&lt;li>update:æ›´æ–°æ–‡æ¡£&lt;/li>
&lt;li>index:åˆ›å»ºæ–°æ–‡æ¡£æˆ–æ›¿æ¢å·²æœ‰æ–‡æ¡£&lt;/li>
&lt;li>delete:åˆ é™¤ä¸€ä¸ªæ–‡æ¡£&lt;/li>
&lt;li>metadata:&lt;/li>
&lt;li>index&lt;/li>
&lt;li>_type&lt;/li>
&lt;li>_id&lt;/li>
&lt;/ul>
&lt;p>create å’Œindexçš„åŒºåˆ«:å¦‚æœæ•°æ®å­˜åœ¨ï¼Œä½¿ç”¨createæ“ä½œå¤±è´¥ï¼Œä¼šæç¤ºæ–‡æ¡£å·²ç»å­˜åœ¨ï¼Œä½¿ç”¨indexåˆ™å¯ä»¥æˆåŠŸæ‰§è¡Œã€‚&lt;/p>
&lt;p>bulkä¸€æ¬¡æœ€å¤§å¤„ç†å¤šå°‘æ•°æ®é‡:&lt;/p>
&lt;p>bulkä¼šæŠŠå°†è¦å¤„ç†çš„æ•°æ®è½½å…¥å†…å­˜ä¸­ï¼Œæ‰€ä»¥æ•°æ®é‡æ˜¯æœ‰é™åˆ¶çš„ï¼Œæœ€ä½³çš„æ•°æ®é‡ä¸æ˜¯ä¸€ä¸ªç¡®å®šçš„æ•°å€¼ï¼Œå®ƒå–å†³äºä½ çš„ç¡¬ä»¶ï¼Œä½ çš„æ–‡æ¡£å¤§å°ä»¥åŠå¤æ‚æ€§ï¼Œä½ çš„ç´¢å¼•ä»¥åŠæœç´¢çš„è´Ÿè½½ã€‚ä¸€èˆ¬å»ºè®®æ˜¯1000-5000ä¸ªæ–‡æ¡£ï¼Œå¤§å°å»ºè®®æ˜¯5-15MBï¼Œé»˜è®¤ä¸èƒ½è¶…è¿‡100Mï¼Œå¯ä»¥åœ¨esçš„é…ç½®æ–‡ä»¶ï¼ˆå³$ES_HOMEä¸‹çš„configä¸‹çš„elasticsearch.ymlï¼‰ä¸­ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code># æ‰¹é‡åˆ é™¤,deleteä¸éœ€è¦è¯·æ±‚ä½“
{&amp;#34;delete&amp;#34;:{&amp;#34;_index&amp;#34;:&amp;#34;lib&amp;#34;,&amp;#34;_type&amp;#34;:&amp;#34;user&amp;#34;,&amp;#34;_id&amp;#34;:&amp;#34;1&amp;#34;}}
# æ‰¹é‡æ·»åŠ 
POST /lib2/books/_bulk
{&amp;#34;index&amp;#34;:{&amp;#34;_id&amp;#34;:1}}
{&amp;#34;title&amp;#34;:&amp;#34;java&amp;#34;,&amp;#34;price&amp;#34;:55}
{&amp;#34;index&amp;#34;:{&amp;#34;_id&amp;#34;:2}}
{&amp;#34;title&amp;#34;:&amp;#34;html5&amp;#34;,&amp;#34;price&amp;#34;:55}
{&amp;#34;index&amp;#34;:{&amp;#34;_id&amp;#34;:3}}
{&amp;#34;title&amp;#34;:&amp;#34;php&amp;#34;,&amp;#34;price&amp;#34;:35}
{&amp;#34;index&amp;#34;:{&amp;#34;_id&amp;#34;:4}}
{&amp;#34;title&amp;#34;:&amp;#34;python&amp;#34;,&amp;#34;price&amp;#34;:50}
# æ‰¹é‡è·å–
GET /lib2/books/_mget
{
&amp;#34;ids&amp;#34;: [&amp;#34;1&amp;#34;,&amp;#34;2&amp;#34;,&amp;#34;3&amp;#34;,&amp;#34;4&amp;#34;]
}
# æ‰¹é‡æ“ä½œ
POST /lib2/books/_bulk
{&amp;#34;delete&amp;#34;:{&amp;#34;_index&amp;#34;:&amp;#34;lib2&amp;#34;,&amp;#34;_type&amp;#34;:&amp;#34;books&amp;#34;,&amp;#34;_id&amp;#34;:4}}
{&amp;#34;create&amp;#34;:{&amp;#34;_index&amp;#34;:&amp;#34;tt&amp;#34;,&amp;#34;_type&amp;#34;:&amp;#34;ttt&amp;#34;,&amp;#34;_id&amp;#34;:&amp;#34;100&amp;#34;}}
{&amp;#34;name&amp;#34;:&amp;#34;lisi&amp;#34;}
{&amp;#34;index&amp;#34;:{&amp;#34;_index&amp;#34;:&amp;#34;tt&amp;#34;,&amp;#34;_type&amp;#34;:&amp;#34;ttt&amp;#34;}}
{&amp;#34;name&amp;#34;:&amp;#34;zhaosi&amp;#34;}
{&amp;#34;update&amp;#34;:{&amp;#34;_index&amp;#34;:&amp;#34;lib2&amp;#34;,&amp;#34;_type&amp;#34;:&amp;#34;books&amp;#34;,&amp;#34;_id&amp;#34;:&amp;#34;4&amp;#34;}}
{&amp;#34;doc&amp;#34;:{&amp;#34;price&amp;#34;:58}}
&lt;/code>&lt;/pre>&lt;h1 id="åŸºæœ¬æŸ¥è¯¢queryæŸ¥è¯¢">åŸºæœ¬æŸ¥è¯¢(QueryæŸ¥è¯¢)&lt;/h1>
&lt;h3 id="termå’ŒtermsæŸ¥è¯¢">termå’ŒtermsæŸ¥è¯¢&lt;/h3>
&lt;ul>
&lt;li>term æŸ¥è¯¢ä¼šå»å€’æ’ç´¢å¼•ä¸­å¯»æ‰¾ç¡®åˆ‡çš„tem,å®ƒå¹¶ä¸çŸ¥é“åˆ†è¯å™¨çš„å­˜åœ¨,è¿™ç§æŸ¥è¯¢ä½¿ç”¨keyword,numeric,date,åœ¨æ²¡æœ‰ä½¿ç”¨åˆ†è¯å™¨çš„æ—¶å€™ä½¿ç”¨&lt;/li>
&lt;li>term æŸ¥è¯¢æŸä¸ªå­—æ®µé‡Œå«æœ‰æŸä¸ªå…³é”®è¯çš„æ–‡æ¡£&lt;/li>
&lt;li>terms:æŸ¥è¯¢æŸä¸ªå­—æ®µé‡Œå«æœ‰å¤šä¸ªå…³é”®è¯çš„æ–‡æ¡£&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code># termï¼Œnameå«æœ‰â€œzhaomingâ€
GET /lib3/user/_search/
{
&amp;#34;query&amp;#34;:{
&amp;#34;term&amp;#34;: {&amp;#34;name&amp;#34;: &amp;#34;zhaoming&amp;#34;}
}
}
# termsï¼Œnameå«æœ‰â€œzhouâ€æˆ–è€…è¿˜æœ‰&amp;#34;yang&amp;#34;çš„æŸ¥å‡ºæ¥
GET /lib3/user/_search/
{
&amp;#34;query&amp;#34;:{
&amp;#34;terms&amp;#34;: {
&amp;#34;name&amp;#34;: [&amp;#34;zhou&amp;#34;,&amp;#34;yang&amp;#34;]
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="formå’Œsizeåˆ†é¡µ">formå’Œsizeåˆ†é¡µ&lt;/h3>
&lt;p>formæ˜¯ä»0å¼€å§‹çš„,sizeæ˜¯å–å¤šå°‘ä¸ª&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /lib3/user/_search/
{
&amp;#34;version&amp;#34;: true, # æŸ¥è¯¢çš„æ—¶å€™å¦‚æœéœ€è¦è¿”å›versionçš„è¯
&amp;#34;from&amp;#34;: 0,
&amp;#34;size&amp;#34;: 1,
&amp;#34;query&amp;#34;:{
&amp;#34;terms&amp;#34;: {
&amp;#34;name&amp;#34;: [&amp;#34;zhou&amp;#34;,&amp;#34;lisi&amp;#34;]
}
}
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>GET article/_count
{
&amp;#34;query&amp;#34;: {
&amp;#34;match&amp;#34;: {
&amp;#34;title&amp;#34;: &amp;#34;é‡‘è&amp;#34;
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="matchæŸ¥è¯¢">matchæŸ¥è¯¢&lt;/h3>
&lt;p>match queryçŸ¥é“åˆ†è¯å™¨çš„å­˜åœ¨ï¼Œä¼šå¯¹filedè¿›è¡Œåˆ†è¯æ“ä½œï¼Œç„¶åå†æŸ¥è¯¢&lt;/p>
&lt;ul>
&lt;li>match_all:æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£&lt;/li>
&lt;li>match:æŸ¥è¯¢ä¸€ä¸ªå­—æ®µ&lt;/li>
&lt;li>multi_match:æŸ¥è¯¢å¤šä¸ªå­—æ®µ&lt;/li>
&lt;li>match_phrase:åŒ…å«å¾—å«æœ‰ä¸€æ ·çš„,è€Œä¸”é¡ºåºè¿˜ä¸€æ ·çš„,å¯ä»¥ä¸ç”¨å®Œæ•´&lt;/li>
&lt;li>match_phrase_prefix: å‰ç¼€åŒ¹é…&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code># matchæ˜¯çŸ¥é“åˆ†è¯å™¨çš„å­˜åœ¨çš„,æ‰€ä»¥ä¼šå»æŸ¥è¯¢nameæ˜¯lisiçš„,æˆ–è€…nameæ˜¯zhaomingçš„(orçš„å…³ç³»)
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;:{
&amp;#34;match&amp;#34;: {
&amp;#34;name&amp;#34;: &amp;#34;lisi zhaoming&amp;#34;
}
}
}
# å¯ä»¥æŒ‡å®šå¤šä¸ªå­—æ®µ
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;:{
&amp;#34;multi_match&amp;#34;: {
&amp;#34;query&amp;#34;: &amp;#34;lvyou&amp;#34;,
&amp;#34;fields&amp;#34;: [&amp;#34;interests&amp;#34;,&amp;#34;name&amp;#34;]
}
}
}
# çŸ­è¯­åŒ¹é…(è¦å®Œå…¨åŒ¹é…),åŒ…å«çš„å…³ç³»
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;:{
&amp;#34;match_phrase&amp;#34;: {
&amp;#34;interests&amp;#34;: &amp;#34;lvyou, duanlian &amp;#34;
}
}
}
# å‰ç¼€åŒ¹é…
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;:{
&amp;#34;match_phrase_prefix&amp;#34;: {
&amp;#34;name&amp;#34;: &amp;#34;zhao&amp;#34;
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="_sourceæ§åˆ¶è¿”å›å­—æ®µ">_sourceæ§åˆ¶è¿”å›å­—æ®µ&lt;/h3>
&lt;pre tabindex="0">&lt;code># æŒ‡å®šè¿”å›çš„å­—æ®µ
GET /lib3/user/_search
{
&amp;#34;_source&amp;#34;: [&amp;#34;address&amp;#34;,&amp;#34;name&amp;#34;],
&amp;#34;query&amp;#34;: {
&amp;#34;match&amp;#34;: {
&amp;#34;interests&amp;#34;: &amp;#34;changge&amp;#34;
}
}
}
# åŒ…å«å’Œæ’é™¤è¿”å›å­—æ®µ
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;match_all&amp;#34;: {}
},
&amp;#34;_source&amp;#34;: {
&amp;#34;includes&amp;#34;: [&amp;#34;name&amp;#34;,&amp;#34;address&amp;#34;], # åŒ…å«è¿™äº›å­—æ®µ
&amp;#34;excludes&amp;#34;: [&amp;#34;age&amp;#34;,&amp;#34;birthday&amp;#34;] # æ’é™¤è¿™äº›å­—æ®µ
}
}
# ä½¿ç”¨é€šé…ç¬¦*
GET /lib3/user/_search
{
&amp;#34;_source&amp;#34;: {
&amp;#34;includes&amp;#34;: &amp;#34;addr*&amp;#34;,
&amp;#34;excludes&amp;#34;: [&amp;#34;name&amp;#34;,&amp;#34;bir*&amp;#34;]
},
&amp;#34;query&amp;#34;: {
&amp;#34;match_all&amp;#34;: {}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="sortæ’åº">sortæ’åº&lt;/h3>
&lt;pre tabindex="0">&lt;code># æŒ‡å®šæ’åºå­—æ®µ
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;:{
&amp;#34;match_all&amp;#34;: {}
},
&amp;#34;sort&amp;#34;: [
{
&amp;#34;age&amp;#34;: {
&amp;#34;order&amp;#34;: &amp;#34;desc&amp;#34;
}
}
]
}
# æ§åˆ¶èŒƒå›´
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;:{
&amp;#34;range&amp;#34;: {
&amp;#34;age&amp;#34;: {
&amp;#34;gte&amp;#34;: 20,
&amp;#34;lte&amp;#34;: 38,
&amp;#34;include_lower&amp;#34;:true, # trueåŒ…å«,falseä¸åŒ…å«,ä¸‹é™
&amp;#34;include_upper&amp;#34;:true # trueåŒ…å«,falseä¸åŒ…å«,ä¸Šé™
}
}
},
&amp;#34;sort&amp;#34;: [
{
&amp;#34;age&amp;#34;: {
&amp;#34;order&amp;#34;: &amp;#34;asc&amp;#34;
}
}
]
}
&lt;/code>&lt;/pre>&lt;h3 id="wildcardé€šé…ç¬¦æŸ¥è¯¢">wildcardé€šé…ç¬¦æŸ¥è¯¢&lt;/h3>
&lt;p>å…è®¸ä½¿ç”¨é€šé…ç¬¦* å’Œ ?æ¥è¿›è¡ŒæŸ¥è¯¢&lt;/p>
&lt;ul>
&lt;li>ä»£è¡¨0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦&lt;/li>
&lt;/ul>
&lt;p>ï¼Ÿä»£è¡¨ä»»æ„ä¸€ä¸ªå­—ç¬¦&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /lib3/user/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;wildcard&amp;#34;: {
&amp;#34;name&amp;#34;: &amp;#34;zhao*&amp;#34;
}
}
}
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;wildcard&amp;#34;: {
&amp;#34;name&amp;#34;: {
&amp;#34;value&amp;#34;: &amp;#34;li?i&amp;#34;
}
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="fuzzyæ¨¡ç³ŠæŸ¥è¯¢">fuzzyæ¨¡ç³ŠæŸ¥è¯¢&lt;/h3>
&lt;ul>
&lt;li>valueï¼šæŸ¥è¯¢çš„å…³é”®å­—&lt;/li>
&lt;li>boostï¼šæŸ¥è¯¢çš„æƒå€¼ï¼Œé»˜è®¤å€¼æ˜¯1.0&lt;/li>
&lt;li>min_similarity:è®¾ç½®åŒ¹é…çš„æœ€å°ç›¸ä¼¼åº¦ï¼Œé»˜è®¤å€¼ä¸º0.5ï¼Œå¯¹äºå­—ç¬¦ä¸²ï¼Œå–å€¼ä¸º0-1(åŒ…æ‹¬0å’Œ1);å¯¹äºæ•°å€¼ï¼Œå–å€¼å¯èƒ½å¤§äº1;å¯¹äºæ—¥æœŸå‹å–å€¼ä¸º1d,1mç­‰ï¼Œ1då°±ä»£è¡¨1å¤©&lt;/li>
&lt;li>prefix_length:æŒ‡æ˜åŒºåˆ†è¯é¡¹çš„å…±åŒå‰ç¼€é•¿åº¦ï¼Œé»˜è®¤æ˜¯0&lt;/li>
&lt;li>max_expansions:æŸ¥è¯¢ä¸­çš„è¯é¡¹å¯ä»¥æ‰©å±•çš„æ•°ç›®ï¼Œé»˜è®¤å¯ä»¥æ— é™å¤§&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>GET /lib3/user/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;fuzzy&amp;#34;: {
&amp;#34;name&amp;#34;: {
&amp;#34;value&amp;#34;: &amp;#34;zhaoimng&amp;#34; # zhaomingå†™åäº†,ä¹Ÿå¯ä»¥æŸ¥å‡ºæ¥
}
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="é«˜äº®æœç´¢">é«˜äº®æœç´¢&lt;/h3>
&lt;pre tabindex="0">&lt;code>GET /lib3/user/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;fuzzy&amp;#34;: {
&amp;#34;name&amp;#34;: {
&amp;#34;value&amp;#34;: &amp;#34;zhaoimng&amp;#34;
}
}
},
&amp;#34;highlight&amp;#34;: {
&amp;#34;fields&amp;#34;: {
&amp;#34;name&amp;#34;:{}
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="filteræŸ¥è¯¢">FilteræŸ¥è¯¢&lt;/h3>
&lt;p>æ˜¯ä¸è®¡ç®—ç›¸å…³æ€§çš„,åŒæ—¶å¯ä»¥ç¼“å­˜,å› æ­¤,filteré€Ÿåº¦è¦å¿«äºquery&lt;/p>
&lt;pre tabindex="0">&lt;code># è¿‡æ»¤ä»·æ ¼æ˜¯40çš„
GET /lib4/items/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;bool&amp;#34;: {
&amp;#34;filter&amp;#34;: {
&amp;#34;term&amp;#34;:{&amp;#34;price&amp;#34;: &amp;#34;40&amp;#34;}
}
}
}
}
# è¿‡æ»¤ä»·æ ¼æ˜¯25çš„å’Œ40çš„
GET /lib4/items/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;bool&amp;#34;: {
&amp;#34;filter&amp;#34;: {
&amp;#34;terms&amp;#34;:{&amp;#34;price&amp;#34;: [25,40]}
}
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="boolè¿‡æ»¤æŸ¥è¯¢">boolè¿‡æ»¤æŸ¥è¯¢&lt;/h3>
&lt;p>å¯ä»¥å®ç°ç»„åˆè¿‡æ»¤æŸ¥è¯¢&lt;/p>
&lt;p>æ ¼å¼ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>{
&amp;#34;bool&amp;#34;: {
&amp;#34;must&amp;#34;: [],
&amp;#34;should&amp;#34;: [],
&amp;#34;must_not&amp;#34;: []
}
}
&lt;/code>&lt;/pre>&lt;p>must:å¿…é¡»æ»¡è¶³çš„æ¡ä»¶&amp;mdash;and&lt;/p>
&lt;p>shouldï¼šå¯ä»¥æ»¡è¶³ä¹Ÿå¯ä»¥ä¸æ»¡è¶³çš„æ¡ä»¶&amp;ndash;or&lt;/p>
&lt;p>must_not:ä¸éœ€è¦æ»¡è¶³çš„æ¡ä»¶&amp;ndash;not&lt;/p>
&lt;pre tabindex="0">&lt;code># ç¿»è¯‘è¿‡æ¥:è¦æ˜¯æ˜¯ä»·æ ¼æ˜¯250,æˆ–è€…æ˜¯itemIDæ˜¯:id100123,å¹¶ä¸”priceä¸èƒ½æ˜¯30
GET /lib4/items/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;bool&amp;#34;: {
&amp;#34;should&amp;#34;: [
{&amp;#34;term&amp;#34;:{&amp;#34;price&amp;#34;:250}},
{&amp;#34;term&amp;#34;:{&amp;#34;itemID&amp;#34;:&amp;#34;id100123&amp;#34;}}
],
&amp;#34;must_not&amp;#34;: [
{&amp;#34;term&amp;#34;:{&amp;#34;price&amp;#34;:30}}
]
}
}
}
&lt;/code>&lt;/pre>&lt;p>è¿‡æ»¤,è¦æƒ³æ˜ç™½è·Ÿæ™®é€šæŸ¥è¯¢çš„è¿‡æ»¤æœ‰ä»€ä¹ˆä¸ä¸€æ ·&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /lib4/items/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;bool&amp;#34;: {
&amp;#34;filter&amp;#34;: {
&amp;#34;range&amp;#34;: {
&amp;#34;price&amp;#34;: {
&amp;#34;gte&amp;#34;: 40,
&amp;#34;lte&amp;#34;: 250
}
}
}
}
}
}
&lt;/code>&lt;/pre>&lt;p>è·å–éç©ºçš„æ–‡æ¡£&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /lib4/items/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;bool&amp;#34;: {
&amp;#34;filter&amp;#34;: {
&amp;#34;exists&amp;#34;: {
&amp;#34;field&amp;#34;: &amp;#34;price&amp;#34;
}
}
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="èšåˆæŸ¥è¯¢">èšåˆæŸ¥è¯¢&lt;/h3>
&lt;pre tabindex="0">&lt;code>GET /lib4/items/_search
{
&amp;#34;size&amp;#34;:0, # åªæ˜¾ç¤ºæ€»å’Œ
&amp;#34;aggs&amp;#34;:{
&amp;#34;price_of_sum&amp;#34;:{
&amp;#34;sum&amp;#34;:{
&amp;#34;field&amp;#34;:&amp;#34;price&amp;#34;
}
}
}
}
# æœ€å¤§å€¼
GET /lib4/items/_search
{
&amp;#34;aggs&amp;#34;:{
&amp;#34;price_of_sum&amp;#34;:{
&amp;#34;max&amp;#34;:{
&amp;#34;field&amp;#34;:&amp;#34;price&amp;#34;
}
}
}
}
# æœ€å°å€¼
GET /lib4/items/_search
{
&amp;#34;aggs&amp;#34;:{
&amp;#34;price_of_sum&amp;#34;:{ # price_of_sumè¿™ä¸ªåå­—éšä¾¿èµ·çš„
&amp;#34;min&amp;#34;:{
&amp;#34;field&amp;#34;:&amp;#34;price&amp;#34;
}
}
}
}
# æ±‚å¹³å‡æ•°
GET /lib4/items/_search
{
&amp;#34;aggs&amp;#34;:{
&amp;#34;price_of_sum&amp;#34;:{
&amp;#34;avg&amp;#34;:{
&amp;#34;field&amp;#34;:&amp;#34;price&amp;#34;
}
}
}
}
# ä»·æ ¼æœ‰ä¸ç›¸åŒçš„æ•°
GET /lib4/items/_search
{
&amp;#34;aggs&amp;#34;:{
&amp;#34;price_of_sum&amp;#34;:{
&amp;#34;cardinality&amp;#34;:{
&amp;#34;field&amp;#34;:&amp;#34;price&amp;#34;
}
}
}
}
# åˆ†ç»„
GET /lib4/items/_search
{
&amp;#34;size&amp;#34;: 0,
&amp;#34;aggs&amp;#34;:{
&amp;#34;price_of_sum&amp;#34;:{
&amp;#34;terms&amp;#34;:{
&amp;#34;field&amp;#34;:&amp;#34;price&amp;#34;
}
}
}
}
&lt;/code>&lt;/pre>&lt;h1 id="apié«˜çº§">APIé«˜çº§&lt;/h1>
&lt;h3 id="ç‰ˆæœ¬æ§åˆ¶">ç‰ˆæœ¬æ§åˆ¶&lt;/h3>
&lt;p>ElasticSearché‡‡ç”¨äº†ä¹è§‚é”æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç”¨æˆ·å¯¹documentè¿›è¡Œæ“ä½œæ—¶ï¼Œå¹¶ä¸éœ€è¦å¯¹è¯¥documentä½œåŠ é”å’Œè§£é”çš„æ“ä½œï¼Œåªéœ€è¦æŒ‡å®šè¦æ“ä½œçš„ç‰ˆæœ¬å³å¯ã€‚å½“ç‰ˆæœ¬å·ä¸€è‡´æ—¶ï¼ŒElasticSearchä¼šå…è®¸è¯¥æ“ä½œé¡ºåˆ©æ‰§è¡Œï¼Œè€Œå½“ç‰ˆæœ¬å·å­˜åœ¨å†²çªæ—¶ï¼ŒElasticSearchä¼šæç¤ºå†²çªå¹¶æŠ›å‡ºå¼‚å¸¸ï¼ˆVersionConflictEngineExceptionå¼‚å¸¸ï¼‰ã€‚&lt;/p>
&lt;p>ElasticSearchçš„ç‰ˆæœ¬å·çš„å–å€¼èŒƒå›´ä¸º1åˆ°2^63-1ã€‚&lt;/p>
&lt;p>å†…éƒ¨ç‰ˆæœ¬æ§åˆ¶ï¼šä½¿ç”¨çš„æ˜¯_version&lt;/p>
&lt;p>å¤–éƒ¨ç‰ˆæœ¬æ§åˆ¶ï¼šelasticsearchåœ¨å¤„ç†å¤–éƒ¨ç‰ˆæœ¬å·æ—¶ä¼šä¸å¯¹å†…éƒ¨ç‰ˆæœ¬å·çš„å¤„ç†æœ‰äº›ä¸åŒã€‚å®ƒä¸å†æ˜¯æ£€æŸ¥&lt;em>versionæ˜¯å¦ä¸è¯·æ±‚ä¸­æŒ‡å®šçš„æ•°å€¼&lt;/em>ç›¸åŒ*,è€Œæ˜¯æ£€æŸ¥å½“å‰çš„*versionæ˜¯å¦æ¯”æŒ‡å®šçš„æ•°å€¼å°ã€‚å¦‚æœè¯·æ±‚æˆåŠŸï¼Œé‚£ä¹ˆå¤–éƒ¨çš„ç‰ˆæœ¬å·å°±ä¼šè¢«å­˜å‚¨åˆ°æ–‡æ¡£ä¸­çš„_versionä¸­ã€‚&lt;/p>
&lt;p>ä¸ºäº†ä¿æŒ_versionä¸å¤–éƒ¨ç‰ˆæœ¬æ§åˆ¶çš„æ•°æ®ä¸€è‡´ä½¿ç”¨version_type=external&lt;/p>
&lt;h3 id="æ•°æ®ç±»å‹">æ•°æ®ç±»å‹&lt;/h3>
&lt;p>æ ¸å¿ƒæ•°æ®ç±»å‹ï¼ˆCore datatypesï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>å­—ç¬¦å‹ï¼šstringï¼Œstringç±»å‹åŒ…æ‹¬
text å’Œ keyword
textç±»å‹è¢«ç”¨æ¥ç´¢å¼•é•¿æ–‡æœ¬ï¼Œåœ¨å»ºç«‹ç´¢å¼•å‰ä¼šå°†è¿™äº›æ–‡æœ¬è¿›è¡Œåˆ†è¯ï¼Œè½¬åŒ–ä¸ºè¯çš„ç»„åˆï¼Œå»ºç«‹ç´¢å¼•ã€‚å…è®¸esæ¥æ£€ç´¢è¿™äº›è¯è¯­ã€‚textç±»å‹ä¸èƒ½ç”¨æ¥æ’åºå’Œèšåˆã€‚
Keywordç±»å‹ä¸éœ€è¦è¿›è¡Œåˆ†è¯ï¼Œå¯ä»¥è¢«ç”¨æ¥æ£€ç´¢è¿‡æ»¤ã€æ’åºå’Œèšåˆã€‚keyword ç±»å‹å­—æ®µåªèƒ½ç”¨æœ¬èº«æ¥è¿›è¡Œæ£€ç´¢
æ•°å­—å‹ï¼šlong, integer, short, byte, double, float
æ—¥æœŸå‹ï¼šdate
å¸ƒå°”å‹ï¼šboolean
äºŒè¿›åˆ¶å‹ï¼šbinary
&lt;/code>&lt;/pre>&lt;p>å¤æ‚æ•°æ®ç±»å‹ï¼ˆComplex datatypesï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>æ•°ç»„ç±»å‹ï¼ˆArray datatypeï¼‰ï¼šæ•°ç»„ç±»å‹ä¸éœ€è¦ä¸“é—¨æŒ‡å®šæ•°ç»„å…ƒç´ çš„typeï¼Œä¾‹å¦‚ï¼š
å­—ç¬¦å‹æ•°ç»„: [ &amp;#34;one&amp;#34;, &amp;#34;two&amp;#34; ]
æ•´å‹æ•°ç»„ï¼š[ 1, 2 ]
æ•°ç»„å‹æ•°ç»„ï¼š[ 1, [ 2, 3 ]] ç­‰ä»·äº[ 1, 2, 3 ]
å¯¹è±¡æ•°ç»„ï¼š[ { &amp;#34;name&amp;#34;: &amp;#34;Mary&amp;#34;, &amp;#34;age&amp;#34;: 12 }, { &amp;#34;name&amp;#34;: &amp;#34;John&amp;#34;, &amp;#34;age&amp;#34;: 10 }]
å¯¹è±¡ç±»å‹ï¼ˆObject datatypeï¼‰ï¼š_ object _ ç”¨äºå•ä¸ªJSONå¯¹è±¡ï¼›
åµŒå¥—ç±»å‹ï¼ˆNested datatypeï¼‰ï¼š_ nested _ ç”¨äºJSONæ•°ç»„ï¼›
&lt;/code>&lt;/pre>&lt;p>åœ°ç†ä½ç½®ç±»å‹ï¼ˆGeo datatypesï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>åœ°ç†åæ ‡ç±»å‹ï¼ˆGeo-point datatypeï¼‰ï¼š_ geo_point _ ç”¨äºç»çº¬åº¦åæ ‡ï¼›
åœ°ç†å½¢çŠ¶ç±»å‹ï¼ˆGeo-Shape datatypeï¼‰ï¼š_ geo_shape _ ç”¨äºç±»ä¼¼äºå¤šè¾¹å½¢çš„å¤æ‚å½¢çŠ¶ï¼›
&lt;/code>&lt;/pre>&lt;p>ç‰¹å®šç±»å‹ï¼ˆSpecialised datatypesï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>IPv4 ç±»å‹ï¼ˆIPv4 datatypeï¼‰ï¼š_ ip _ ç”¨äºIPv4 åœ°å€ï¼›
Completion ç±»å‹ï¼ˆCompletion datatypeï¼‰ï¼š_ completion _æä¾›è‡ªåŠ¨è¡¥å…¨å»ºè®®ï¼›
Token count ç±»å‹ï¼ˆToken count datatypeï¼‰ï¼š_ token_count _ ç”¨äºç»Ÿè®¡åšäº†æ ‡è®°çš„å­—æ®µçš„indexæ•°ç›®ï¼Œè¯¥å€¼ä¼šä¸€ç›´å¢åŠ ï¼Œä¸ä¼šå› ä¸ºè¿‡æ»¤æ¡ä»¶è€Œå‡å°‘ã€‚
mapper-murmur3
ç±»å‹ï¼šé€šè¿‡æ’ä»¶ï¼Œå¯ä»¥é€šè¿‡ _ murmur3 _ æ¥è®¡ç®— index çš„ hash å€¼ï¼›
é™„åŠ ç±»å‹ï¼ˆAttachment datatypeï¼‰ï¼šé‡‡ç”¨ mapper-attachments
æ’ä»¶ï¼Œå¯æ”¯æŒ_ attachments _ ç´¢å¼•ï¼Œä¾‹å¦‚ Microsoft Office æ ¼å¼ï¼ŒOpen Document æ ¼å¼ï¼ŒePub, HTML ç­‰ã€‚
&lt;/code>&lt;/pre>&lt;p>æ”¯æŒçš„å±æ€§ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;#34;store&amp;#34;:false//æ˜¯å¦å•ç‹¬è®¾ç½®æ­¤å­—æ®µçš„æ˜¯å¦å­˜å‚¨è€Œä»_sourceå­—æ®µä¸­åˆ†ç¦»ï¼Œé»˜è®¤æ˜¯falseï¼Œåªèƒ½æœç´¢ï¼Œä¸èƒ½è·å–å€¼
&amp;#34;index&amp;#34;: true//åˆ†è¯ï¼Œä¸åˆ†è¯æ˜¯ï¼šfalseï¼Œè®¾ç½®æˆfalseï¼Œå­—æ®µå°†ä¸ä¼šè¢«ç´¢å¼•
&amp;#34;analyzer&amp;#34;:&amp;#34;ik&amp;#34;//æŒ‡å®šåˆ†è¯å™¨,é»˜è®¤åˆ†è¯å™¨ä¸ºstandard analyzer
&amp;#34;boost&amp;#34;:1.23//å­—æ®µçº§åˆ«çš„åˆ†æ•°åŠ æƒï¼Œé»˜è®¤å€¼æ˜¯1.0
&amp;#34;doc_values&amp;#34;:false//å¯¹not_analyzedå­—æ®µï¼Œé»˜è®¤éƒ½æ˜¯å¼€å¯ï¼Œåˆ†è¯å­—æ®µä¸èƒ½ä½¿ç”¨ï¼Œå¯¹æ’åºå’Œèšåˆèƒ½æå‡è¾ƒå¤§æ€§èƒ½ï¼ŒèŠ‚çº¦å†…å­˜
&amp;#34;fielddata&amp;#34;:{&amp;#34;format&amp;#34;:&amp;#34;disabled&amp;#34;}//é’ˆå¯¹åˆ†è¯å­—æ®µï¼Œå‚ä¸æ’åºæˆ–èšåˆæ—¶èƒ½æé«˜æ€§èƒ½ï¼Œä¸åˆ†è¯å­—æ®µç»Ÿä¸€å»ºè®®ä½¿ç”¨doc_value
&amp;#34;fields&amp;#34;:{&amp;#34;raw&amp;#34;:{&amp;#34;type&amp;#34;:&amp;#34;string&amp;#34;,&amp;#34;index&amp;#34;:&amp;#34;not_analyzed&amp;#34;}} //å¯ä»¥å¯¹ä¸€ä¸ªå­—æ®µæä¾›å¤šç§ç´¢å¼•æ¨¡å¼ï¼ŒåŒä¸€ä¸ªå­—æ®µçš„å€¼ï¼Œä¸€ä¸ªåˆ†è¯ï¼Œä¸€ä¸ªä¸åˆ†è¯
&amp;#34;ignore_above&amp;#34;:100 //è¶…è¿‡100ä¸ªå­—ç¬¦çš„æ–‡æœ¬ï¼Œå°†ä¼šè¢«å¿½ç•¥ï¼Œä¸è¢«ç´¢å¼•
&amp;#34;include_in_all&amp;#34;:ture//è®¾ç½®æ˜¯å¦æ­¤å­—æ®µåŒ…å«åœ¨_allå­—æ®µä¸­ï¼Œé»˜è®¤æ˜¯trueï¼Œé™¤éindexè®¾ç½®æˆnoé€‰é¡¹
&amp;#34;index_options&amp;#34;:&amp;#34;docs&amp;#34;//4ä¸ªå¯é€‰å‚æ•°docsï¼ˆç´¢å¼•æ–‡æ¡£å·ï¼‰ ,freqsï¼ˆæ–‡æ¡£å·+è¯é¢‘ï¼‰ï¼Œpositionsï¼ˆæ–‡æ¡£å·+è¯é¢‘+ä½ç½®ï¼Œé€šå¸¸ç”¨æ¥è·ç¦»æŸ¥è¯¢ï¼‰ï¼Œoffsetsï¼ˆæ–‡æ¡£å·+è¯é¢‘+ä½ç½®+åç§»é‡ï¼Œé€šå¸¸è¢«ä½¿ç”¨åœ¨é«˜äº®å­—æ®µï¼‰åˆ†è¯å­—æ®µé»˜è®¤æ˜¯positionï¼Œå…¶ä»–çš„é»˜è®¤æ˜¯docs
&amp;#34;norms&amp;#34;:{&amp;#34;enable&amp;#34;:true,&amp;#34;loading&amp;#34;:&amp;#34;lazy&amp;#34;}//åˆ†è¯å­—æ®µé»˜è®¤é…ç½®ï¼Œä¸åˆ†è¯å­—æ®µï¼šé»˜è®¤{&amp;#34;enable&amp;#34;:false}ï¼Œå­˜å‚¨é•¿åº¦å› å­å’Œç´¢å¼•æ—¶boostï¼Œå»ºè®®å¯¹éœ€è¦å‚ä¸è¯„åˆ†å­—æ®µä½¿ç”¨ ï¼Œä¼šé¢å¤–å¢åŠ å†…å­˜æ¶ˆè€—é‡
&amp;#34;null_value&amp;#34;:&amp;#34;NULL&amp;#34;//è®¾ç½®ä¸€äº›ç¼ºå¤±å­—æ®µçš„åˆå§‹åŒ–å€¼ï¼Œåªæœ‰stringå¯ä»¥ä½¿ç”¨ï¼Œåˆ†è¯å­—æ®µçš„nullå€¼ä¹Ÿä¼šè¢«åˆ†è¯
&amp;#34;position_increament_gap&amp;#34;:0//å½±å“è·ç¦»æŸ¥è¯¢æˆ–è¿‘ä¼¼æŸ¥è¯¢ï¼Œå¯ä»¥è®¾ç½®åœ¨å¤šå€¼å­—æ®µçš„æ•°æ®ä¸Šç«åˆ†è¯å­—æ®µä¸Šï¼ŒæŸ¥è¯¢æ—¶å¯æŒ‡å®šslopé—´éš”ï¼Œé»˜è®¤å€¼æ˜¯100
&amp;#34;search_analyzer&amp;#34;:&amp;#34;ik&amp;#34;//è®¾ç½®æœç´¢æ—¶çš„åˆ†è¯å™¨ï¼Œé»˜è®¤è·Ÿananlyzeræ˜¯ä¸€è‡´çš„ï¼Œæ¯”å¦‚indexæ—¶ç”¨standard+ngramï¼Œæœç´¢æ—¶ç”¨standardç”¨æ¥å®Œæˆè‡ªåŠ¨æç¤ºåŠŸèƒ½
&amp;#34;similarity&amp;#34;:&amp;#34;BM25&amp;#34;//é»˜è®¤æ˜¯TF/IDFç®—æ³•ï¼ŒæŒ‡å®šä¸€ä¸ªå­—æ®µè¯„åˆ†ç­–ç•¥ï¼Œä»…ä»…å¯¹å­—ç¬¦ä¸²å‹å’Œåˆ†è¯ç±»å‹æœ‰æ•ˆ
&amp;#34;term_vector&amp;#34;:&amp;#34;no&amp;#34;//é»˜è®¤ä¸å­˜å‚¨å‘é‡ä¿¡æ¯ï¼Œæ”¯æŒå‚æ•°yesï¼ˆtermå­˜å‚¨ï¼‰ï¼Œwith_positionsï¼ˆterm+ä½ç½®ï¼‰,with_offsetsï¼ˆterm+åç§»é‡ï¼‰ï¼Œwith_positions_offsets(term+ä½ç½®+åç§»é‡) å¯¹å¿«é€Ÿé«˜äº®fast vector highlighterèƒ½æå‡æ€§èƒ½ï¼Œä½†å¼€å¯åˆä¼šåŠ å¤§ç´¢å¼•ä½“ç§¯ï¼Œä¸é€‚åˆå¤§æ•°æ®é‡ç”¨
&lt;/code>&lt;/pre>&lt;h1 id="elasticsearchåŸç†">ElasticSearchåŸç†&lt;/h1>
&lt;h3 id="è§£æesçš„åˆ†å¸ƒå¼æ¶æ„">è§£æesçš„åˆ†å¸ƒå¼æ¶æ„&lt;/h3>
&lt;p>åˆ†ç‰‡çš„å‰¯æœ¬ï¼š&lt;/p>
&lt;p>é›†ç¾¤å‘ç°æœºåˆ¶(cluster discovery)ï¼šæ¯”å¦‚å½“å‰æˆ‘ä»¬å¯åŠ¨äº†ä¸€ä¸ªesè¿›ç¨‹ï¼Œå½“å¯åŠ¨äº†ç¬¬äºŒä¸ªesè¿›ç¨‹æ—¶ï¼Œè¿™ä¸ªè¿›ç¨‹ä½œä¸ºä¸€ä¸ªnodeè‡ªåŠ¨å°±å‘ç°äº†é›†ç¾¤ï¼Œå¹¶ä¸”åŠ å…¥äº†è¿›å»&lt;/p>
&lt;p>shardè´Ÿè½½å‡è¡¡ï¼šæ¯”å¦‚ç°åœ¨æœ‰10shardï¼Œé›†ç¾¤ä¸­æœ‰3ä¸ªèŠ‚ç‚¹ï¼Œesä¼šè¿›è¡Œå‡è¡¡çš„è¿›è¡Œåˆ†é…ï¼Œä»¥ä¿æŒæ¯ä¸ªèŠ‚ç‚¹å‡è¡¡çš„è´Ÿè½½è¯·æ±‚&lt;/p>
&lt;p>è¯·æ±‚è·¯ç”±&lt;/p>
&lt;h3 id="æ‰©å®¹æœºåˆ¶">æ‰©å®¹æœºåˆ¶&lt;/h3>
&lt;p>å‚ç›´æ‰©å®¹ï¼šè´­ç½®æ–°çš„æœºå™¨ï¼Œæ›¿æ¢å·²æœ‰çš„æœºå™¨&lt;/p>
&lt;p>ä¾‹å­:ä¸€å°æœ‰6å°æœºå™¨,æ¯å°1T,ä¸€å…±6T,ç°åœ¨æ›¿æ¢æ‰å…¶ä¸­çš„ä¸¤å°,1Tå‡çº§åˆ°2T,è¿™æ ·ä¸€å…±å°±æœ‰8T&lt;/p>
&lt;p>æ°´å¹³æ‰©å®¹ï¼šç›´æ¥å¢åŠ æœºå™¨&lt;/p>
&lt;h3 id="rebalance">rebalance&lt;/h3>
&lt;p>å¢åŠ æˆ–å‡å°‘èŠ‚ç‚¹æ—¶ä¼šè‡ªåŠ¨å‡è¡¡&lt;/p>
&lt;h3 id="masterèŠ‚ç‚¹">masterèŠ‚ç‚¹&lt;/h3>
&lt;p>ä¸»èŠ‚ç‚¹çš„ä¸»è¦èŒè´£æ˜¯å’Œé›†ç¾¤æ“ä½œç›¸å…³çš„å†…å®¹ï¼Œå¦‚åˆ›å»ºæˆ–åˆ é™¤ç´¢å¼•ï¼Œè·Ÿè¸ªå“ªäº›èŠ‚ç‚¹æ˜¯ç¾¤é›†çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶å†³å®šå“ªäº›åˆ†ç‰‡åˆ†é…ç»™ç›¸å…³çš„èŠ‚ç‚¹ã€‚ç¨³å®šçš„ä¸»èŠ‚ç‚¹å¯¹é›†ç¾¤çš„å¥åº·æ˜¯éå¸¸é‡è¦çš„ã€‚ä¸€ä¸ªé›†ç¾¤,è‡³å°‘æœ‰ä¸€ä¸ªmaster.å¹¶ä¸æ˜¯æ‰€æœ‰çš„è¯·æ±‚éƒ½è¯·æ±‚master&lt;/p>
&lt;h3 id="èŠ‚ç‚¹å¯¹ç­‰">èŠ‚ç‚¹å¯¹ç­‰&lt;/h3>
&lt;p>æ¯ä¸ªèŠ‚ç‚¹éƒ½èƒ½æ¥æ”¶è¯·æ±‚æ¯ä¸ªèŠ‚ç‚¹æ¥æ”¶åˆ°è¯·æ±‚åéƒ½èƒ½æŠŠè¯¥è¯·æ±‚è·¯ç”±åˆ°æœ‰ç›¸å…³æ•°æ®çš„å…¶å®ƒèŠ‚ç‚¹ä¸Šæ¥æ”¶åŸå§‹è¯·æ±‚çš„èŠ‚ç‚¹è´Ÿè´£é‡‡é›†æ•°æ®å¹¶è¿”å›ç»™å®¢æˆ·ç«¯&lt;/p>
&lt;h3 id="åˆ†ç‰‡å’Œå‰¯æœ¬æœºåˆ¶">åˆ†ç‰‡å’Œå‰¯æœ¬æœºåˆ¶&lt;/h3>
&lt;ol>
&lt;li>indexåŒ…å«å¤šä¸ªshard&lt;/li>
&lt;li>æ¯ä¸ªshardéƒ½æ˜¯ä¸€ä¸ªæœ€å°å·¥ä½œå•å…ƒï¼Œæ‰¿è½½éƒ¨åˆ†æ•°æ®ï¼›æ¯ä¸ªshardéƒ½æ˜¯ä¸€ä¸ªluceneå®ä¾‹ï¼Œæœ‰å®Œæ•´çš„å»ºç«‹ç´¢å¼•å’Œå¤„ç†è¯·æ±‚çš„èƒ½åŠ›&lt;/li>
&lt;li>å¢å‡èŠ‚ç‚¹æ—¶ï¼Œshardä¼šè‡ªåŠ¨åœ¨nodesä¸­è´Ÿè½½å‡è¡¡&lt;/li>
&lt;li>primary shardå’Œreplica shardï¼Œæ¯ä¸ªdocumentè‚¯å®šåªå­˜åœ¨äºæŸä¸€ä¸ªprimary shardä»¥åŠå…¶å¯¹åº”çš„replica shardä¸­ï¼Œä¸å¯èƒ½å­˜åœ¨äºå¤šä¸ªprimary shard&lt;/li>
&lt;li>replica shardæ˜¯primary shardçš„å‰¯æœ¬ï¼Œè´Ÿè´£å®¹é”™ï¼Œä»¥åŠæ‰¿æ‹…è¯»è¯·æ±‚è´Ÿè½½&lt;/li>
&lt;li>primary shardçš„æ•°é‡åœ¨åˆ›å»ºç´¢å¼•çš„æ—¶å€™å°±å›ºå®šäº†ï¼Œreplica shardçš„æ•°é‡å¯ä»¥éšæ—¶ä¿®æ”¹&lt;/li>
&lt;li>primary shardçš„é»˜è®¤æ•°é‡æ˜¯5ï¼Œreplicaé»˜è®¤æ˜¯1ï¼Œé»˜è®¤æœ‰10ä¸ªshardï¼Œ5ä¸ªprimary shardï¼Œ5ä¸ªreplica shard&lt;/li>
&lt;li>primary shardä¸èƒ½å’Œè‡ªå·±çš„replica shardæ”¾åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ˆå¦åˆ™èŠ‚ç‚¹å®•æœºï¼Œprimary shardå’Œå‰¯æœ¬éƒ½ä¸¢å¤±ï¼Œèµ·ä¸åˆ°å®¹é”™çš„ä½œç”¨ï¼‰ï¼Œä½†æ˜¯å¯ä»¥å’Œå…¶ä»–primary shardçš„replica shardæ”¾åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Š&lt;/li>
&lt;/ol>
&lt;h3 id="å•èŠ‚ç‚¹ç¯å¢ƒä¸‹åˆ›å»ºç´¢å¼•åˆ†æ">å•èŠ‚ç‚¹ç¯å¢ƒä¸‹åˆ›å»ºç´¢å¼•åˆ†æ&lt;/h3>
&lt;pre tabindex="0">&lt;code>PUT /myindex
{
&amp;#34;settings&amp;#34; : {
&amp;#34;number_of_shards&amp;#34; : 3, # 3ä¸ªæœ±åˆ†ç‰‡
&amp;#34;number_of_replicas&amp;#34; : 1 # 1ä¸ªè´Ÿåˆ†ç‰‡
}
}
&lt;/code>&lt;/pre>&lt;p>è¿™ä¸ªæ—¶å€™ï¼Œåªä¼šå°†3ä¸ªprimary shardåˆ†é…åˆ°ä»…æœ‰çš„ä¸€ä¸ªnodeä¸Šå»ï¼Œå¦å¤–3ä¸ªreplica shardæ˜¯æ— æ³•åˆ†é…çš„ï¼ˆä¸€ä¸ªshardçš„å‰¯æœ¬replicaï¼Œä»–ä»¬ä¸¤ä¸ªæ˜¯ä¸èƒ½åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹çš„ï¼‰ã€‚é›†ç¾¤å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯ä¸€æ—¦å‡ºç°èŠ‚ç‚¹å®•æœºï¼Œæ•°æ®å…¨éƒ¨ä¸¢å¤±ï¼Œè€Œä¸”é›†ç¾¤ä¸å¯ç”¨ï¼Œæ— æ³•æ¥æ”¶ä»»ä½•è¯·æ±‚ã€‚&lt;/p>
&lt;h3 id="ä¸¤ä¸ªèŠ‚ç‚¹ç¯å¢ƒä¸‹åˆ›å»ºç´¢å¼•åˆ†æ">ä¸¤ä¸ªèŠ‚ç‚¹ç¯å¢ƒä¸‹åˆ›å»ºç´¢å¼•åˆ†æ&lt;/h3>
&lt;p>å°†3ä¸ªprimary shardåˆ†é…åˆ°ä¸€ä¸ªnodeä¸Šå»ï¼Œå¦å¤–3ä¸ªreplica shardåˆ†é…åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Š&lt;/p>
&lt;p>primary shard å’Œreplica shard ä¿æŒåŒæ­¥&lt;/p>
&lt;p>primary shard å’Œreplica shard éƒ½å¯ä»¥å¤„ç†å®¢æˆ·ç«¯çš„è¯»è¯·æ±‚&lt;/p>
&lt;h3 id="æ°´å¹³æ‰©å®¹çš„è¿‡ç¨‹">æ°´å¹³æ‰©å®¹çš„è¿‡ç¨‹&lt;/h3>
&lt;ol>
&lt;li>æ‰©å®¹åprimary shardå’Œreplica shardä¼šè‡ªåŠ¨çš„è´Ÿè½½å‡è¡¡&lt;/li>
&lt;li>æ‰©å®¹åæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„shardä¼šå‡å°‘ï¼Œé‚£ä¹ˆåˆ†é…ç»™æ¯ä¸ªshardçš„CPUï¼Œå†…å­˜ï¼ŒIOèµ„æºä¼šæ›´å¤šï¼Œæ€§èƒ½æé«˜&lt;/li>
&lt;li>æ‰©å®¹çš„æé™ï¼Œå¦‚æœæœ‰6ä¸ªshardï¼Œæ‰©å®¹çš„æé™å°±æ˜¯6ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šä¸€ä¸ªshardï¼Œå¦‚æœæƒ³è¶…å‡ºæ‰©å®¹çš„æé™ï¼Œæ¯”å¦‚è¯´æ‰©å®¹åˆ°9ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥å¢åŠ replica shardçš„ä¸ªæ•°&lt;/li>
&lt;li>6ä¸ªshardï¼Œ3ä¸ªèŠ‚ç‚¹ï¼Œæœ€å¤šèƒ½æ‰¿å—å‡ ä¸ªèŠ‚ç‚¹æ‰€åœ¨çš„æœåŠ¡å™¨å®•æœºï¼Ÿ(å®¹é”™æ€§)ä»»ä½•ä¸€å°æœåŠ¡å™¨å®•æœºéƒ½ä¼šä¸¢å¤±éƒ¨åˆ†æ•°æ®&lt;/li>
&lt;/ol>
&lt;p>ä¸ºäº†æé«˜å®¹é”™æ€§ï¼Œå¢åŠ shardçš„ä¸ªæ•°ï¼š9ä¸ªshardï¼Œ(3ä¸ªprimary shardï¼Œ6ä¸ªreplicashard)ï¼Œè¿™æ ·å°±èƒ½å®¹å¿æœ€å¤šä¸¤å°æœåŠ¡å™¨å®•æœºäº†&lt;/p>
&lt;p>æ€»ç»“ï¼šæ‰©å®¹æ˜¯ä¸ºäº†æé«˜ç³»ç»Ÿçš„ååé‡ï¼ŒåŒæ—¶ä¹Ÿè¦è€ƒè™‘å®¹é”™æ€§ï¼Œä¹Ÿå°±æ˜¯è®©å°½å¯èƒ½å¤šçš„æœåŠ¡å™¨å®•æœºè¿˜èƒ½ä¿è¯æ•°æ®ä¸ä¸¢å¤±&lt;/p>
&lt;h3 id="elasticsearchçš„å®¹é”™æœºåˆ¶">ElasticSearchçš„å®¹é”™æœºåˆ¶&lt;/h3>
&lt;p>ä»¥9ä¸ªshardï¼Œ3ä¸ªèŠ‚ç‚¹ä¸ºä¾‹ï¼š&lt;/p>
&lt;p>1.å¦‚æœmaster node å®•æœºï¼Œæ­¤æ—¶ä¸æ˜¯æ‰€æœ‰çš„primary shardéƒ½æ˜¯Active statusï¼Œæ‰€ä»¥æ­¤æ—¶çš„é›†ç¾¤çŠ¶æ€æ˜¯redã€‚&lt;/p>
&lt;p>å®¹é”™å¤„ç†çš„ç¬¬ä¸€æ­¥:æ˜¯é€‰ä¸¾ä¸€å°æœåŠ¡å™¨ä½œä¸ºmasterå®¹é”™å¤„ç†çš„ç¬¬äºŒæ­¥:æ–°é€‰ä¸¾å‡ºçš„masterä¼šæŠŠæŒ‚æ‰çš„primary shardçš„æŸä¸ªreplica shard æå‡ä¸ºprimary shard,æ­¤æ—¶é›†ç¾¤çš„çŠ¶æ€ä¸ºyellowï¼Œå› ä¸ºå°‘äº†ä¸€ä¸ªreplica shardï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„replica shardéƒ½æ˜¯active status&lt;/p>
&lt;p>å®¹é”™å¤„ç†çš„ç¬¬ä¸‰æ­¥ï¼šé‡å¯æ•…éšœæœºï¼Œæ–°masterä¼šæŠŠæ‰€æœ‰çš„å‰¯æœ¬éƒ½å¤åˆ¶ä¸€ä»½åˆ°è¯¥èŠ‚ç‚¹ä¸Šï¼Œï¼ˆåŒæ­¥ä¸€ä¸‹å®•æœºåå‘ç”Ÿçš„ä¿®æ”¹ï¼‰ï¼Œæ­¤æ—¶é›†ç¾¤çš„çŠ¶æ€ä¸ºgreenï¼Œå› ä¸ºæ‰€æœ‰çš„primary shardå’Œreplica shardéƒ½æ˜¯Active status&lt;/p>
&lt;h3 id="æ–‡æ¡£çš„æ ¸å¿ƒå…ƒæ•°æ®">æ–‡æ¡£çš„æ ¸å¿ƒå…ƒæ•°æ®&lt;/h3>
&lt;ol>
&lt;li>&lt;code>_index&lt;/code>:&lt;/li>
&lt;/ol>
&lt;p>è¯´æ˜äº†ä¸€ä¸ªæ–‡æ¡£å­˜å‚¨åœ¨å“ªä¸ªç´¢å¼•ä¸­&lt;/p>
&lt;p>åŒä¸€ä¸ªç´¢å¼•ä¸‹å­˜æ”¾çš„æ˜¯ç›¸ä¼¼çš„æ–‡æ¡£(æ–‡æ¡£çš„fieldå¤šæ•°æ˜¯ç›¸åŒçš„)&lt;/p>
&lt;p>ç´¢å¼•åå¿…é¡»æ˜¯å°å†™çš„ï¼Œä¸èƒ½ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼Œä¸èƒ½åŒ…æ‹¬é€—å·&lt;/p>
&lt;ol>
&lt;li>&lt;code>_type&lt;/code>:&lt;/li>
&lt;/ol>
&lt;p>è¡¨ç¤ºæ–‡æ¡£å±äºç´¢å¼•ä¸­çš„å“ªä¸ªç±»å‹&lt;/p>
&lt;p>ä¸€ä¸ªç´¢å¼•ä¸‹åªèƒ½æœ‰ä¸€ä¸ªtype&lt;/p>
&lt;p>ç±»å‹åå¯ä»¥æ˜¯å¤§å†™ä¹Ÿå¯ä»¥æ˜¯å°å†™çš„ï¼Œä¸èƒ½ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼Œä¸èƒ½åŒ…æ‹¬é€—å·&lt;/p>
&lt;ol>
&lt;li>&lt;code>_id&lt;/code>:&lt;/li>
&lt;/ol>
&lt;p>æ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†ï¼Œå’Œç´¢å¼•ï¼Œç±»å‹ç»„åˆåœ¨ä¸€èµ·å”¯ä¸€æ ‡è¯†äº†ä¸€ä¸ªæ–‡æ¡£&lt;/p>
&lt;p>å¯ä»¥æ‰‹åŠ¨æŒ‡å®šå€¼ï¼Œä¹Ÿå¯ä»¥ç”±esæ¥ç”Ÿæˆè¿™ä¸ªå€¼&lt;/p>
&lt;h3 id="æ–‡æ¡£idç”Ÿæˆæ–¹å¼">æ–‡æ¡£idç”Ÿæˆæ–¹å¼&lt;/h3>
&lt;p>1.æ‰‹åŠ¨æŒ‡å®š&lt;/p>
&lt;pre tabindex="0">&lt;code>put /index/type/66
&lt;/code>&lt;/pre>&lt;p>é€šå¸¸æ˜¯æŠŠå…¶å®ƒç³»ç»Ÿçš„å·²æœ‰æ•°æ®å¯¼å…¥åˆ°esæ—¶&lt;/p>
&lt;p>2.ç”±esç”Ÿæˆidå€¼&lt;/p>
&lt;pre tabindex="0">&lt;code>post /index/type
&lt;/code>&lt;/pre>&lt;p>esç”Ÿæˆçš„idé•¿åº¦ä¸º20ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨çš„æ˜¯base64ç¼–ç ï¼ŒURLå®‰å…¨ï¼Œä½¿ç”¨çš„æ˜¯GUIDç®—æ³•ï¼Œåˆ†å¸ƒå¼ä¸‹å¹¶å‘ç”Ÿæˆidå€¼æ—¶ä¸ä¼šå†²çª&lt;/p>
&lt;h3 id="_sourceå…ƒæ•°æ®åˆ†æ">_sourceå…ƒæ•°æ®åˆ†æ&lt;/h3>
&lt;p>å…¶å®å°±æ˜¯æˆ‘ä»¬åœ¨æ·»åŠ æ–‡æ¡£æ—¶request bodyä¸­çš„å†…å®¹&lt;/p>
&lt;p>æŒ‡å®šè¿”å›çš„ç»“æœä¸­å«æœ‰å“ªäº›å­—æ®µï¼š&lt;/p>
&lt;p>get /index/type/1?_source=name&lt;/p>
&lt;h3 id="æ”¹å˜æ–‡æ¡£å†…å®¹åŸç†è§£æ">æ”¹å˜æ–‡æ¡£å†…å®¹åŸç†è§£æ&lt;/h3>
&lt;p>æ›¿æ¢æ–¹å¼(å…¨éƒ¨æ›¿æ¢)ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>PUT /lib/user/4
{
&amp;#34;first_name&amp;#34; : &amp;#34;Jane&amp;#34;,
&amp;#34;last_name&amp;#34; : &amp;#34;Lucy&amp;#34;,
&amp;#34;age&amp;#34; : 24,
&amp;#34;about&amp;#34; : &amp;#34;I like to collect rock albums&amp;#34;,
&amp;#34;interests&amp;#34;: [ &amp;#34;music&amp;#34; ]
}
&lt;/code>&lt;/pre>&lt;p>ä¿®æ”¹æ–¹å¼(éƒ¨åˆ†ä¿®æ”¹)ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>POST /lib/user/2/_update
{
&amp;#34;doc&amp;#34;:{
&amp;#34;age&amp;#34;:26
}
}
&lt;/code>&lt;/pre>&lt;p>åˆ é™¤æ–‡æ¡£:&lt;/p>
&lt;pre tabindex="0">&lt;code>delete /lib
&lt;/code>&lt;/pre>&lt;p>ä»¥ä¸Š3ä¸ªæ“ä½œæ–‡æ¡£çš„æ–¹å¼,éƒ½æ˜¯æŠŠå·²æœ‰çš„documentæ ‡è®°ä¸ºdeletedï¼Œéšç€æ•°æ®é‡çš„å¢åŠ ï¼Œesä¼šé€‰æ‹©åˆé€‚çš„æ—¶é—´åˆ é™¤æ‰&lt;/p>
&lt;h3 id="åŸºäºgroovyè„šæœ¬æ‰§è¡Œpartial-update">åŸºäºgroovyè„šæœ¬æ‰§è¡Œpartial update&lt;/h3>
&lt;p>esæœ‰å†…ç½®çš„è„šæœ¬æ”¯æŒï¼Œå¯ä»¥åŸºäºgroovyè„šæœ¬å®ç°å¤æ‚çš„æ“ä½œ&lt;/p>
&lt;pre tabindex="0">&lt;code>1.ä¿®æ”¹å¹´é¾„
POST /lib/user/4/_update
{
&amp;#34;script&amp;#34;: &amp;#34;ctx._source.age+=1&amp;#34;
}
2.ä¿®æ”¹åå­—
POST /lib/user/4/_update
{
&amp;#34;script&amp;#34;: &amp;#34;ctx._source.last_name+=&amp;#39;hehe&amp;#39;&amp;#34;
}
3.æ·»åŠ çˆ±å¥½
POST /lib/user/4/_update
{
&amp;#34;script&amp;#34;: {
&amp;#34;source&amp;#34;: &amp;#34;ctx._source.interests.add(params.tag)&amp;#34;,
&amp;#34;params&amp;#34;: {
&amp;#34;tag&amp;#34;:&amp;#34;picture&amp;#34;
}
}
}
4.åˆ é™¤çˆ±å¥½
POST /lib/user/4/_update
{
&amp;#34;script&amp;#34;: {
&amp;#34;source&amp;#34;: &amp;#34;ctx._source.interests.remove(ctx._source.interests.indexOf(params.tag))&amp;#34;,
&amp;#34;params&amp;#34;: {
&amp;#34;tag&amp;#34;:&amp;#34;picture&amp;#34;
}
}
}
5.åˆ é™¤æ–‡æ¡£
POST /lib/user/4/_update
{
&amp;#34;script&amp;#34;: {
&amp;#34;source&amp;#34;: &amp;#34;ctx.op=ctx._source.age==params.count?&amp;#39;delete&amp;#39;:&amp;#39;none&amp;#39;&amp;#34;,
&amp;#34;params&amp;#34;: {
&amp;#34;count&amp;#34;:29
}
}
}
6.upsert
POST /lib/user/4/_update
{
&amp;#34;script&amp;#34;: &amp;#34;ctx._source.age += 1&amp;#34;,
&amp;#34;upsert&amp;#34;: {
&amp;#34;first_name&amp;#34; : &amp;#34;Jane&amp;#34;,
&amp;#34;last_name&amp;#34; : &amp;#34;Lucy&amp;#34;,
&amp;#34;age&amp;#34; : 20,
&amp;#34;about&amp;#34; : &amp;#34;I like to collect rock albums&amp;#34;,
&amp;#34;interests&amp;#34;: [ &amp;#34;music&amp;#34; ]
}
}
&lt;/code>&lt;/pre>&lt;h3 id="partial-update-å¤„ç†å¹¶å‘å†²çª">partial update å¤„ç†å¹¶å‘å†²çª&lt;/h3>
&lt;p>ä½¿ç”¨çš„æ˜¯ä¹è§‚é”:_version&lt;/p>
&lt;p>retry_on_conflict:&lt;/p>
&lt;pre tabindex="0">&lt;code>POST /lib/user/4/_update?retry_on_conflict=3
&lt;/code>&lt;/pre>&lt;p>é‡æ–°è·å–æ–‡æ¡£æ•°æ®å’Œç‰ˆæœ¬ä¿¡æ¯è¿›è¡Œæ›´æ–°ï¼Œä¸æ–­çš„æ“ä½œï¼Œæœ€å¤šæ“ä½œçš„æ¬¡æ•°å°±æ˜¯retry_on_conflictçš„å€¼&lt;/p>
&lt;h3 id="æ–‡æ¡£æ•°æ®è·¯ç”±åŸç†è§£æ">æ–‡æ¡£æ•°æ®è·¯ç”±åŸç†è§£æ&lt;/h3>
&lt;p>1.æ–‡æ¡£è·¯ç”±åˆ°åˆ†ç‰‡ä¸Šï¼š&lt;/p>
&lt;p>ä¸€ä¸ªç´¢å¼•ç”±å¤šä¸ªåˆ†ç‰‡æ„æˆï¼Œå½“æ·»åŠ (åˆ é™¤ï¼Œä¿®æ”¹)ä¸€ä¸ªæ–‡æ¡£æ—¶ï¼Œeså°±éœ€è¦å†³å®šè¿™ä¸ªæ–‡æ¡£å­˜å‚¨åœ¨å“ªä¸ªåˆ†ç‰‡ä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ç§°ä¸ºæ•°æ®è·¯ç”±(routing)&lt;/p>
&lt;p>2.è·¯ç”±ç®—æ³•ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code> shard=hash(routing) % number_of_pirmary_shards
&lt;/code>&lt;/pre>&lt;p>ç¤ºä¾‹ï¼šä¸€ä¸ªç´¢å¼•ï¼Œ3ä¸ªprimary shard&lt;/p>
&lt;p>(1)æ¯æ¬¡å¢åˆ æ”¹æŸ¥æ—¶ï¼Œéƒ½æœ‰ä¸€ä¸ªroutingå€¼ï¼Œé»˜è®¤æ˜¯æ–‡æ¡£çš„_idçš„å€¼&lt;/p>
&lt;p>(2)å¯¹è¿™ä¸ªroutingå€¼ä½¿ç”¨å“ˆå¸Œå‡½æ•°è¿›è¡Œè®¡ç®—&lt;/p>
&lt;p>(3)è®¡ç®—å‡ºçš„å€¼å†å’Œä¸»åˆ†ç‰‡ä¸ªæ•°å–ä½™æ•°&lt;/p>
&lt;p>ä½™æ•°è‚¯å®šåœ¨0&amp;mdash;ï¼ˆnumber_of_pirmary_shards-1ï¼‰ä¹‹é—´ï¼Œæ–‡æ¡£å°±åœ¨å¯¹åº”çš„shardä¸Š&lt;/p>
&lt;p>routingå€¼é»˜è®¤æ˜¯æ–‡æ¡£çš„_idçš„å€¼ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªå€¼ï¼Œæ‰‹åŠ¨æŒ‡å®šå¯¹äºè´Ÿè½½å‡è¡¡ä»¥åŠæé«˜æ‰¹é‡è¯»å–çš„æ€§èƒ½éƒ½æœ‰å¸®åŠ©&lt;/p>
&lt;p>3.primary shardä¸ªæ•°ä¸€æ—¦ç¡®å®šå°±ä¸èƒ½ä¿®æ”¹äº†&lt;/p>
&lt;h3 id="æ–‡æ¡£å¢åˆ æ”¹å†…éƒ¨åŸç†">æ–‡æ¡£å¢åˆ æ”¹å†…éƒ¨åŸç†&lt;/h3>
&lt;p>1:å‘é€å¢åˆ æ”¹è¯·æ±‚æ—¶ï¼Œå¯ä»¥é€‰æ‹©ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹å°±æˆäº†åè°ƒèŠ‚ç‚¹(coordinating node)&lt;/p>
&lt;p>2.åè°ƒèŠ‚ç‚¹ä½¿ç”¨è·¯ç”±ç®—æ³•è¿›è¡Œè·¯ç”±ï¼Œç„¶åå°†è¯·æ±‚è½¬åˆ°primary shardæ‰€åœ¨èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹å¤„ç†è¯·æ±‚ï¼Œå¹¶æŠŠæ•°æ®åŒæ­¥åˆ°å®ƒçš„replica shard&lt;/p>
&lt;p>3.åè°ƒèŠ‚ç‚¹å¯¹å®¢æˆ·ç«¯åšå‡ºå“åº”&lt;/p>
&lt;h3 id="å†™ä¸€è‡´æ€§åŸç†å’Œquorumæœºåˆ¶">å†™ä¸€è‡´æ€§åŸç†å’Œquorumæœºåˆ¶&lt;/h3>
&lt;ol>
&lt;li>ä»»ä½•ä¸€ä¸ªå¢åˆ æ”¹æ“ä½œéƒ½å¯ä»¥è·Ÿä¸Šä¸€ä¸ªå‚æ•°:``consistency`&lt;/li>
&lt;/ol>
&lt;p>å¯ä»¥ç»™è¯¥å‚æ•°æŒ‡å®šçš„å€¼ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>one: (primary shard)åªè¦æœ‰ä¸€ä¸ªprimary shardæ˜¯æ´»è·ƒçš„å°±å¯ä»¥æ‰§è¡Œ
all: (all shard)æ‰€æœ‰çš„primary shardå’Œreplica shardéƒ½æ˜¯æ´»è·ƒçš„æ‰èƒ½æ‰§è¡Œ
quorum: (default) é»˜è®¤å€¼ï¼Œå¤§éƒ¨åˆ†shardæ˜¯æ´»è·ƒçš„æ‰èƒ½æ‰§è¡Œ ï¼ˆä¾‹å¦‚å…±æœ‰6ä¸ªshardï¼Œè‡³å°‘æœ‰3ä¸ªshardæ˜¯æ´»è·ƒçš„æ‰èƒ½æ‰§è¡Œå†™æ“ä½œï¼‰
&lt;/code>&lt;/pre>&lt;ol>
&lt;li>quorumæœºåˆ¶ï¼šå¤šæ•°shardéƒ½æ˜¯å¯ç”¨çš„ï¼Œ&lt;/li>
&lt;/ol>
&lt;p>int((primary+number_of_replica)/2)+1&lt;/p>
&lt;p>ä¾‹å¦‚ï¼š3ä¸ªprimary shardï¼Œ1ä¸ªreplica&lt;/p>
&lt;p>int((3+1)/2)+1=3&lt;/p>
&lt;p>è‡³å°‘3ä¸ªshardæ˜¯æ´»è·ƒçš„&lt;/p>
&lt;p>æ³¨æ„ï¼šå¯èƒ½å‡ºç°shardä¸èƒ½åˆ†é…é½å…¨çš„æƒ…å†µ&lt;/p>
&lt;p>æ¯”å¦‚ï¼š1ä¸ªprimary shard,1ä¸ªreplicaint((1+1)/2)+1=2ä½†æ˜¯å¦‚æœåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºprimary shardå’Œreplica shardä¸èƒ½åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥ä»ç„¶ä¸èƒ½æ‰§è¡Œå†™æ“ä½œ&lt;/p>
&lt;p>å†ä¸¾ä¾‹ï¼š1ä¸ªprimary shard,3ä¸ªreplica,2ä¸ªèŠ‚ç‚¹&lt;/p>
&lt;p>int((1+3)/2)+1=3&lt;/p>
&lt;p>æœ€å:å½“æ´»è·ƒçš„shardçš„ä¸ªæ•°æ²¡æœ‰è¾¾åˆ°è¦æ±‚æ—¶ï¼Œesé»˜è®¤ä¼šç­‰å¾…ä¸€åˆ†é’Ÿï¼Œå¦‚æœåœ¨ç­‰å¾…çš„æœŸé—´æ´»è·ƒçš„shardçš„ä¸ªæ•°æ²¡æœ‰å¢åŠ ï¼Œåˆ™æ˜¾ç¤ºtimeout&lt;/p>
&lt;p>put /index/type/id?timeout=60s&lt;/p>
&lt;h3 id="æ–‡æ¡£æŸ¥è¯¢å†…éƒ¨åŸç†">æ–‡æ¡£æŸ¥è¯¢å†…éƒ¨åŸç†&lt;/h3>
&lt;p>ç¬¬ä¸€æ­¥ï¼šæŸ¥è¯¢è¯·æ±‚å‘ç»™ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹å°±æˆäº†coordinating nodeï¼Œè¯¥èŠ‚ç‚¹ä½¿ç”¨è·¯ç”±ç®—æ³•ç®—å‡ºæ–‡æ¡£æ‰€åœ¨çš„primary shard&lt;/p>
&lt;p>ç¬¬äºŒæ­¥ï¼šåè°ƒèŠ‚ç‚¹æŠŠè¯·æ±‚è½¬å‘ç»™primary shardä¹Ÿå¯ä»¥è½¬å‘ç»™replica shard(ä½¿ç”¨è½®è¯¢è°ƒåº¦ç®—æ³•(Round-Robin Schedulingï¼ŒæŠŠè¯·æ±‚å¹³å‡åˆ†é…è‡³primary shard å’Œreplica shard)&lt;/p>
&lt;p>ç¬¬ä¸‰æ­¥ï¼šå¤„ç†è¯·æ±‚çš„èŠ‚ç‚¹æŠŠç»“æœè¿”å›ç»™åè°ƒèŠ‚ç‚¹ï¼Œåè°ƒèŠ‚ç‚¹å†è¿”å›ç»™åº”ç”¨ç¨‹åº&lt;/p>
&lt;p>ç‰¹æ®Šæƒ…å†µï¼šè¯·æ±‚çš„æ–‡æ¡£è¿˜åœ¨å»ºç«‹ç´¢å¼•çš„è¿‡ç¨‹ä¸­ï¼Œprimary shardä¸Šå­˜åœ¨ï¼Œä½†replica sharä¸Šä¸å­˜åœ¨ï¼Œä½†æ˜¯è¯·æ±‚è¢«è½¬å‘åˆ°äº†replica shardä¸Šï¼Œè¿™æ—¶å°±ä¼šæç¤ºæ‰¾ä¸åˆ°æ–‡æ¡£&lt;/p>
&lt;h3 id="bulkæ‰¹é‡æ“ä½œçš„jsonæ ¼å¼è§£æ">bulkæ‰¹é‡æ“ä½œçš„jsonæ ¼å¼è§£æ&lt;/h3>
&lt;p>bulkçš„æ ¼å¼ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>{action:{metadata}}\n
{requstbody}\n
&lt;/code>&lt;/pre>&lt;p>ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å¦‚ä¸‹æ ¼å¼ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>[{
&amp;#34;action&amp;#34;: {
},
&amp;#34;data&amp;#34;: {
}
}]
&lt;/code>&lt;/pre>&lt;p>è¿™ç§æ–¹å¼å¯è¯»æ€§å¥½ï¼Œä½†æ˜¯å†…éƒ¨å¤„ç†å°±éº»çƒ¦äº†ï¼š&lt;/p>
&lt;p>1.å°†jsonæ•°ç»„è§£æä¸ºJSONArrayå¯¹è±¡ï¼Œåœ¨å†…å­˜ä¸­å°±éœ€è¦æœ‰ä¸€ä»½jsonæ–‡æœ¬çš„æ‹·è´ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªJSONArrayå¯¹è±¡ã€‚&lt;/p>
&lt;p>2.è§£æjsonæ•°ç»„é‡Œçš„æ¯ä¸ªjsonï¼Œå¯¹æ¯ä¸ªè¯·æ±‚ä¸­çš„documentè¿›è¡Œè·¯ç”±&lt;/p>
&lt;p>3.ä¸ºè·¯ç”±åˆ°åŒä¸€ä¸ªshardä¸Šçš„å¤šä¸ªè¯·æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªè¯·æ±‚æ•°ç»„&lt;/p>
&lt;p>4.å°†è¿™ä¸ªè¯·æ±‚æ•°ç»„åºåˆ—åŒ–&lt;/p>
&lt;p>5.å°†åºåˆ—åŒ–åçš„è¯·æ±‚æ•°ç»„å‘é€åˆ°å¯¹åº”çš„èŠ‚ç‚¹ä¸Šå»&lt;/p>
&lt;p>è€—è´¹æ›´å¤šå†…å­˜ï¼Œå¢åŠ javaè™šæ‹Ÿæœºå¼€é”€&lt;/p>
&lt;p>1.ä¸ç”¨å°†å…¶è½¬æ¢ä¸ºjsonå¯¹è±¡ï¼Œç›´æ¥æŒ‰ç…§æ¢è¡Œç¬¦åˆ‡å‰²jsonï¼Œå†…å­˜ä¸­ä¸éœ€è¦jsonæ–‡æœ¬çš„æ‹·è´&lt;/p>
&lt;p>2.å¯¹æ¯ä¸¤ä¸ªä¸€ç»„çš„jsonï¼Œè¯»å–metaï¼Œè¿›è¡Œdocumentè·¯ç”±&lt;/p>
&lt;p>3.ç›´æ¥å°†å¯¹åº”çš„jsonå‘é€åˆ°nodeä¸Šå»&lt;/p>
&lt;h3 id="æŸ¥è¯¢ç»“æœåˆ†æ">æŸ¥è¯¢ç»“æœåˆ†æ&lt;/h3>
&lt;pre tabindex="0">&lt;code>{
# æŸ¥è¯¢è€—è´¹çš„æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’
&amp;#34;took&amp;#34;: 419,
# è¶…æ—¶æ—¶é—´
&amp;#34;timed_out&amp;#34;: false,
# å…±è¯·æ±‚äº†å¤šå°‘ä¸ªshard
&amp;#34;_shards&amp;#34;: {
# æŸ¥è¯¢å‡ºçš„æ–‡æ¡£æ€»ä¸ªæ•°
&amp;#34;total&amp;#34;: 3,
&amp;#34;successful&amp;#34;: 3,
&amp;#34;skipped&amp;#34;: 0,
&amp;#34;failed&amp;#34;: 0
},
&amp;#34;hits&amp;#34;: {
&amp;#34;total&amp;#34;: 3,
# æœ¬æ¬¡æŸ¥è¯¢ä¸­ï¼Œç›¸å…³åº¦åˆ†æ•°çš„æœ€å¤§å€¼ï¼Œæ–‡æ¡£å’Œæ­¤æ¬¡æŸ¥è¯¢çš„åŒ¹é…åº¦è¶Šé«˜ï¼Œ_scoreçš„å€¼è¶Šå¤§ï¼Œæ’ä½è¶Šé å‰
&amp;#34;max_score&amp;#34;: 0.6931472,
# é»˜è®¤æŸ¥è¯¢å‰10ä¸ªæ–‡æ¡£
&amp;#34;hits&amp;#34;: [
{
&amp;#34;_index&amp;#34;: &amp;#34;lib3&amp;#34;,
&amp;#34;_type&amp;#34;: &amp;#34;user&amp;#34;,
&amp;#34;_id&amp;#34;: &amp;#34;3&amp;#34;,
&amp;#34;_score&amp;#34;: 0.6931472,
&amp;#34;_source&amp;#34;: {
&amp;#34;address&amp;#34;: &amp;#34;bei jing hai dian qu qing he zhen&amp;#34;,
&amp;#34;name&amp;#34;: &amp;#34;lisi&amp;#34;
}
},
{
&amp;#34;_index&amp;#34;: &amp;#34;lib3&amp;#34;,
&amp;#34;_type&amp;#34;: &amp;#34;user&amp;#34;,
&amp;#34;_id&amp;#34;: &amp;#34;2&amp;#34;,
&amp;#34;_score&amp;#34;: 0.47000363,
&amp;#34;_source&amp;#34;: {
&amp;#34;address&amp;#34;: &amp;#34;bei jing hai dian qu qing he zhen&amp;#34;,
&amp;#34;name&amp;#34;: &amp;#34;zhaoming&amp;#34;
}
}
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code># è®¾ç½®è¶…æ—¶æ—¶é—´
GET /lib3/user/_search?timeout=10ms
{
&amp;#34;_source&amp;#34;: [&amp;#34;address&amp;#34;,&amp;#34;name&amp;#34;],
&amp;#34;query&amp;#34;: {
&amp;#34;match&amp;#34;: {
&amp;#34;interests&amp;#34;: &amp;#34;changge&amp;#34;
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="åˆ†é¡µæŸ¥è¯¢ä¸­çš„deep-pagingé—®é¢˜">åˆ†é¡µæŸ¥è¯¢ä¸­çš„deep pagingé—®é¢˜&lt;/h3>
&lt;pre tabindex="0">&lt;code>GET /lib3/user/_search
{
&amp;#34;from&amp;#34;:0,
&amp;#34;size&amp;#34;:2,
&amp;#34;query&amp;#34;:{
&amp;#34;terms&amp;#34;:{
&amp;#34;interests&amp;#34;: [&amp;#34;hejiu&amp;#34;,&amp;#34;changge&amp;#34;]
}
}
}
GET /_search?from=0&amp;amp;size=3
&lt;/code>&lt;/pre>&lt;p>deep paging:æŸ¥è¯¢çš„å¾ˆæ·±ï¼Œæ¯”å¦‚ä¸€ä¸ªç´¢å¼•æœ‰ä¸‰ä¸ªprimary shardï¼Œåˆ†åˆ«å­˜å‚¨äº†6000æ¡æ•°æ®ï¼Œæˆ‘ä»¬è¦å¾—åˆ°ç¬¬100é¡µçš„æ•°æ®(æ¯é¡µ10æ¡)ï¼Œç±»ä¼¼è¿™ç§æƒ…å†µå°±å«deep paging&lt;/p>
&lt;p>å¦‚ä½•å¾—åˆ°ç¬¬100é¡µçš„10æ¡æ•°æ®ï¼Ÿ&lt;/p>
&lt;p>åœ¨æ¯ä¸ªshardä¸­æœç´¢990åˆ°999è¿™10æ¡æ•°æ®ï¼Œç„¶åç”¨è¿™30æ¡æ•°æ®æ’åºï¼Œæ’åºä¹‹åå–10æ¡æ•°æ®å°±æ˜¯è¦æœç´¢çš„æ•°æ®ï¼Œè¿™ç§åšæ³•æ˜¯é”™çš„ï¼Œå› ä¸º3ä¸ªshardä¸­çš„æ•°æ®çš„&lt;em>scoreåˆ†æ•°ä¸ä¸€æ ·ï¼Œå¯èƒ½è¿™æŸä¸€ä¸ªshardä¸­ç¬¬ä¸€æ¡æ•°æ®çš„&lt;/em>scoreåˆ†æ•°æ¯”å¦ä¸€ä¸ªshardä¸­ç¬¬1000æ¡éƒ½è¦é«˜ï¼Œæ‰€ä»¥åœ¨æ¯ä¸ªshardä¸­æœç´¢990åˆ°999è¿™10æ¡æ•°æ®ç„¶åæ’åºçš„åšæ³•æ˜¯ä¸æ­£ç¡®çš„ã€‚&lt;/p>
&lt;p>æ­£ç¡®çš„åšæ³•æ˜¯æ¯ä¸ªshardæŠŠ0åˆ°999æ¡æ•°æ®å…¨éƒ¨æœç´¢å‡ºæ¥ï¼ˆæŒ‰æ’åºé¡ºåºï¼‰ï¼Œç„¶åå…¨éƒ¨è¿”å›ç»™coordinate nodeï¼Œç”±coordinate nodeæŒ‰_scoreåˆ†æ•°æ’åºåï¼Œå–å‡ºç¬¬100é¡µçš„10æ¡æ•°æ®ï¼Œç„¶åè¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/p>
&lt;p>deep pagingæ€§èƒ½é—®é¢˜&lt;/p>
&lt;p>1.è€—è´¹ç½‘ç»œå¸¦å®½ï¼Œå› ä¸ºæœç´¢è¿‡æ·±çš„è¯ï¼Œå„shardè¦æŠŠæ•°æ®ä¼ é€ç»™coordinate nodeï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æœ‰å¤§é‡æ•°æ®ä¼ é€’çš„ï¼Œæ¶ˆè€—ç½‘ç»œï¼Œ&lt;/p>
&lt;p>2.æ¶ˆè€—å†…å­˜ï¼Œå„shardè¦æŠŠæ•°æ®ä¼ é€ç»™coordinate nodeï¼Œè¿™ä¸ªä¼ é€’å›æ¥çš„æ•°æ®ï¼Œæ˜¯è¢«coordinate nodeä¿å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œè¿™æ ·ä¼šå¤§é‡æ¶ˆè€—å†…å­˜ã€‚&lt;/p>
&lt;p>3.æ¶ˆè€—cpu coordinate nodeè¦æŠŠä¼ å›æ¥çš„æ•°æ®è¿›è¡Œæ’åºï¼Œè¿™ä¸ªæ’åºè¿‡ç¨‹å¾ˆæ¶ˆè€—cpu.&lt;/p>
&lt;p>é‰´äºdeep pagingçš„æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥åº”å°½é‡å‡å°‘ä½¿ç”¨ã€‚&lt;/p>
&lt;h3 id="query-stringæŸ¥è¯¢åŠcopy_toè§£æ">query stringæŸ¥è¯¢åŠcopy_toè§£æ&lt;/h3>
&lt;p>GET /lib3/user/_search?q=interests:changge&lt;/p>
&lt;p>GET /lib3/user/_search?q=+interests:changge&lt;/p>
&lt;p>GET /lib3/user/_search?q=-interests:changge&lt;/p>
&lt;p>copy_toå­—æ®µæ˜¯æŠŠå…¶å®ƒå­—æ®µä¸­çš„å€¼ï¼Œä»¥ç©ºæ ¼ä¸ºåˆ†éš”ç¬¦ç»„æˆä¸€ä¸ªå¤§å­—ç¬¦ä¸²ï¼Œç„¶åè¢«åˆ†æå’Œç´¢å¼•ï¼Œä½†æ˜¯ä¸å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒèƒ½è¢«æŸ¥è¯¢ï¼Œä½†ä¸èƒ½è¢«å–å›æ˜¾ç¤ºã€‚&lt;/p>
&lt;p>æ³¨æ„:copy_toæŒ‡å‘çš„å­—æ®µå­—æ®µç±»å‹è¦ä¸ºï¼štext&lt;/p>
&lt;p>å½“æ²¡æœ‰æŒ‡å®šfieldæ—¶ï¼Œå°±ä¼šä»copy_toå­—æ®µä¸­æŸ¥è¯¢GET /lib3/user/_search?q=changge&lt;/p>
&lt;h3 id="å­—ç¬¦ä¸²æ’åºé—®é¢˜">å­—ç¬¦ä¸²æ’åºé—®é¢˜&lt;/h3>
&lt;p>å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å­—æ®µè¿›è¡Œæ’åºé€šå¸¸ä¸å‡†ç¡®ï¼Œå› ä¸ºå·²ç»è¢«åˆ†è¯æˆå¤šä¸ªè¯æ¡äº†&lt;/p>
&lt;p>è§£å†³æ–¹å¼ï¼šå¯¹å­—æ®µç´¢å¼•ä¸¤æ¬¡ï¼Œä¸€æ¬¡ç´¢å¼•åˆ†è¯ï¼ˆç”¨äºæœç´¢ï¼‰ï¼Œä¸€æ¬¡ç´¢å¼•ä¸åˆ†è¯(ç”¨äºæ’åº)&lt;/p>
&lt;pre tabindex="0">&lt;code># è®¾ç½®mapping
PUT /lib3
{
&amp;#34;settings&amp;#34;:{
&amp;#34;number_of_shards&amp;#34; : 3,
&amp;#34;number_of_replicas&amp;#34; : 0
},
&amp;#34;mappings&amp;#34;:{
&amp;#34;user&amp;#34;:{
&amp;#34;properties&amp;#34;:{
&amp;#34;name&amp;#34;: {&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;},
&amp;#34;address&amp;#34;: {&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;},
&amp;#34;age&amp;#34;: {&amp;#34;type&amp;#34;:&amp;#34;integer&amp;#34;},
&amp;#34;birthday&amp;#34;: {&amp;#34;type&amp;#34;:&amp;#34;date&amp;#34;},
&amp;#34;interests&amp;#34;: {
&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;,
# é‡ç‚¹æ˜¯åœ¨è¿™ä¸‹é¢
&amp;#34;fields&amp;#34;: {
&amp;#34;raw&amp;#34;:{
&amp;#34;type&amp;#34;: &amp;#34;keyword&amp;#34;
}
},
&amp;#34;fielddata&amp;#34;: true
}
}
}
}
}
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;match_all&amp;#34;: {}
},
&amp;#34;sort&amp;#34;: [
{
&amp;#34;interests&amp;#34;: {
&amp;#34;order&amp;#34;: &amp;#34;desc&amp;#34;
}
}
]
}
GET /lib3/user/_search
{
&amp;#34;query&amp;#34;: {
&amp;#34;match_all&amp;#34;: {}
},
&amp;#34;sort&amp;#34;: [
{
&amp;#34;interests.raw&amp;#34;: {
&amp;#34;order&amp;#34;: &amp;#34;asc&amp;#34;
}
}
]
}
&lt;/code>&lt;/pre>&lt;h3 id="å¦‚ä½•è®¡ç®—ç›¸å…³åº¦åˆ†æ•°">å¦‚ä½•è®¡ç®—ç›¸å…³åº¦åˆ†æ•°&lt;/h3>
&lt;p>ä½¿ç”¨çš„æ˜¯TF/IDFç®—æ³•(Term Frequency&amp;amp;Inverse Document Frequency)&lt;/p>
&lt;p>1.Term Frequency:æˆ‘ä»¬æŸ¥è¯¢çš„æ–‡æœ¬ä¸­çš„è¯æ¡åœ¨documentæœ¬ä¸­å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œå‡ºç°æ¬¡æ•°è¶Šå¤šï¼Œç›¸å…³åº¦è¶Šé«˜&lt;/p>
&lt;p>æœç´¢å†…å®¹ï¼š hello world&lt;/p>
&lt;p>Helloï¼ŒI love china.&lt;/p>
&lt;p>Hello world,how are you!&lt;/p>
&lt;p>2.Inverse Document Frequencyï¼šæˆ‘ä»¬æŸ¥è¯¢çš„æ–‡æœ¬ä¸­çš„è¯æ¡åœ¨ç´¢å¼•çš„æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°äº†å¤šå°‘æ¬¡ï¼Œå‡ºç°çš„æ¬¡æ•°è¶Šå¤šï¼Œç›¸å…³åº¦è¶Šä½&lt;/p>
&lt;p>æœç´¢å†…å®¹ï¼šhello world&lt;/p>
&lt;p>helloï¼Œwhat are you doing?&lt;/p>
&lt;p>I like the world.&lt;/p>
&lt;p>hello åœ¨ç´¢å¼•çš„æ‰€æœ‰æ–‡æ¡£ä¸­å‡ºç°äº†500æ¬¡ï¼Œworldå‡ºç°äº†100æ¬¡&lt;/p>
&lt;p>3.Field-length(å­—æ®µé•¿åº¦å½’çº¦) norm:fieldè¶Šé•¿ï¼Œç›¸å…³åº¦è¶Šä½&lt;/p>
&lt;p>æœç´¢å†…å®¹ï¼šhello world&lt;/p>
&lt;p>{&amp;ldquo;title&amp;rdquo;:&amp;ldquo;hello,what&amp;rsquo;s your name?&amp;rdquo;,&amp;ldquo;content&amp;rdquo;:{&amp;ldquo;owieurowieuolsdjflk&amp;rdquo;}}&lt;/p>
&lt;p>{&amp;ldquo;title&amp;rdquo;:&amp;ldquo;hi,good morning&amp;rdquo;,&amp;ldquo;content&amp;rdquo;:{&amp;ldquo;lkjkljkj&amp;hellip;&amp;hellip;.world&amp;rdquo;}}&lt;/p>
&lt;p>æŸ¥çœ‹åˆ†æ•°æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼š&lt;/p>
&lt;p>GET /lib3/user/_search?explain=true{&amp;ldquo;query&amp;rdquo;:{&amp;ldquo;match&amp;rdquo;:{&amp;ldquo;interests&amp;rdquo;: &amp;ldquo;duanlian,changge&amp;rdquo;}}}&lt;/p>
&lt;p>æŸ¥çœ‹ä¸€ä¸ªæ–‡æ¡£èƒ½å¦åŒ¹é…ä¸ŠæŸä¸ªæŸ¥è¯¢ï¼š&lt;/p>
&lt;p>GET /lib3/user/2/_explain{&amp;ldquo;query&amp;rdquo;:{&amp;ldquo;match&amp;rdquo;:{&amp;ldquo;interests&amp;rdquo;: &amp;ldquo;duanlian,changge&amp;rdquo;}}}&lt;/p>
&lt;h3 id="doc-values-è§£æ">Doc Values è§£æ&lt;/h3>
&lt;p>DocValueså…¶å®æ˜¯Luceneåœ¨æ„å»ºå€’æ’ç´¢å¼•æ—¶ï¼Œä¼šé¢å¤–å»ºç«‹ä¸€ä¸ªæœ‰åºçš„æ­£æ’ç´¢å¼•(åŸºäºdocument =&amp;gt; field valueçš„æ˜ å°„åˆ—è¡¨),å­—ç¬¦ä¸²ä¸ä¼šåˆ›å»ºæ­£æ’ç´¢å¼•&lt;/p>
&lt;pre tabindex="0">&lt;code>{&amp;#34;birthday&amp;#34;:&amp;#34;1985-11-11&amp;#34;,age:23}
{&amp;#34;birthday&amp;#34;:&amp;#34;1989-11-11&amp;#34;,age:29}
document age birthday
doc1 23 1985-11-11
doc2 29 1989-11-11
&lt;/code>&lt;/pre>&lt;p>å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼ŒèŠ‚çœå†…å­˜&lt;/p>
&lt;p>å¯¹æ’åºï¼Œåˆ†ç»„å’Œä¸€äº›èšåˆæ“ä½œèƒ½å¤Ÿå¤§å¤§æå‡æ€§èƒ½&lt;/p>
&lt;p>æ³¨æ„ï¼šé»˜è®¤å¯¹ä¸åˆ†è¯çš„å­—æ®µæ˜¯å¼€å¯çš„ï¼Œå¯¹åˆ†è¯å­—æ®µæ— æ•ˆï¼ˆéœ€è¦æŠŠfielddataè®¾ç½®ä¸ºtrueï¼‰&lt;/p>
&lt;pre tabindex="0">&lt;code>PUT /lib3
{
&amp;#34;settings&amp;#34;:{
&amp;#34;number_of_shards&amp;#34; : 3,
&amp;#34;number_of_replicas&amp;#34; : 0
},
&amp;#34;mappings&amp;#34;:{
&amp;#34;user&amp;#34;:{
&amp;#34;properties&amp;#34;:{
&amp;#34;name&amp;#34;: {&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;},
&amp;#34;address&amp;#34;: {&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;},
&amp;#34;age&amp;#34;: {
&amp;#34;type&amp;#34;:&amp;#34;integer&amp;#34;,
&amp;#34;doc_values&amp;#34;:false
},
&amp;#34;interests&amp;#34;: {&amp;#34;type&amp;#34;:&amp;#34;text&amp;#34;},
&amp;#34;birthday&amp;#34;: {&amp;#34;type&amp;#34;:&amp;#34;date&amp;#34;}
}
}
}
}
&lt;/code>&lt;/pre>&lt;h3 id="åŸºäºscrollæŠ€æœ¯æ»šåŠ¨æœç´¢å¤§é‡æ•°æ®">åŸºäºscrollæŠ€æœ¯æ»šåŠ¨æœç´¢å¤§é‡æ•°æ®&lt;/h3>
&lt;p>å¦‚æœä¸€æ¬¡æ€§è¦æŸ¥å‡ºæ¥æ¯”å¦‚10ä¸‡æ¡æ•°æ®ï¼Œé‚£ä¹ˆæ€§èƒ½ä¼šå¾ˆå·®ï¼Œæ­¤æ—¶ä¸€èˆ¬ä¼šé‡‡å–ç”¨scollæ»šåŠ¨æŸ¥è¯¢ï¼Œä¸€æ‰¹ä¸€æ‰¹çš„æŸ¥ï¼Œç›´åˆ°æ‰€æœ‰æ•°æ®éƒ½æŸ¥è¯¢å®Œä¸ºæ­¢ã€‚&lt;/p>
&lt;p>1.scollæœç´¢ä¼šåœ¨ç¬¬ä¸€æ¬¡æœç´¢çš„æ—¶å€™ï¼Œä¿å­˜ä¸€ä¸ªå½“æ—¶çš„è§†å›¾å¿«ç…§ï¼Œä¹‹ååªä¼šåŸºäºè¯¥æ—§çš„è§†å›¾å¿«ç…§æä¾›æ•°æ®æœç´¢ï¼Œå¦‚æœè¿™ä¸ªæœŸé—´æ•°æ®å˜æ›´ï¼Œæ˜¯ä¸ä¼šè®©ç”¨æˆ·çœ‹åˆ°çš„&lt;/p>
&lt;p>2.é‡‡ç”¨åŸºäº&lt;em>doc(ä¸ä½¿ç”¨&lt;/em>score)è¿›è¡Œæ’åºçš„æ–¹å¼ï¼Œæ€§èƒ½è¾ƒé«˜&lt;/p>
&lt;p>3.æ¯æ¬¡å‘é€scrollè¯·æ±‚ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŒ‡å®šä¸€ä¸ªscollå‚æ•°ï¼ŒæŒ‡å®šä¸€ä¸ªæ—¶é—´çª—å£ï¼Œæ¯æ¬¡æœç´¢è¯·æ±‚åªè¦åœ¨è¿™ä¸ªæ—¶é—´çª—å£å†…èƒ½å®Œæˆå°±å¯ä»¥äº†&lt;/p>
&lt;pre tabindex="0">&lt;code>GET /lib3/user/_search?scroll=1m
{
&amp;#34;query&amp;#34;: {
&amp;#34;match_all&amp;#34;: {}
},
&amp;#34;sort&amp;#34;:[&amp;#34;_doc&amp;#34;],
# ä¸€æ‰¹æŸ¥å¤šå°‘ä¸ª
&amp;#34;size&amp;#34;:3
}
GET /_search/scroll
{
&amp;#34;scroll&amp;#34;: &amp;#34;1m&amp;#34;,
# è¿™ä¸ªæ˜¯ä¸Šé¢é‚£ä¸ªæŸ¥è¯¢é‡Œè·å–åˆ°çš„
&amp;#34;scroll_id&amp;#34;: &amp;#34;DnF1ZXJ5VGhlbkZldGNoAwAAAAAAAAAdFkEwRENOVTdnUUJPWVZUd1p2WE5hV2cAAAAAAAAAHhZBMERDTlU3Z1FCT1lWVHdadlhOYVdnAAAAAAAAAB8WQTBEQ05VN2dRQk9ZVlR3WnZYTmFXZw==&amp;#34;
}
&lt;/code>&lt;/pre>&lt;h3 id="dynamic-mappingç­–ç•¥">dynamic mappingç­–ç•¥&lt;/h3>
&lt;p>&lt;strong>dynamic&lt;/strong>:&lt;/p>
&lt;p>1.true:é‡åˆ°é™Œç”Ÿå­—æ®µå°± dynamic mapping&lt;/p>
&lt;p>2.false:é‡åˆ°é™Œç”Ÿå­—æ®µå°±å¿½ç•¥&lt;/p>
&lt;p>3.strict:çº¦åˆ°é™Œç”Ÿå­—æ®µå°±æŠ¥é”™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">PUT&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">/lib&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>{&lt;span style="color:#f92672">&amp;#34;settings&amp;#34;&lt;/span>:{&lt;span style="color:#f92672">&amp;#34;number_of_shards&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">3&lt;/span>,&lt;span style="color:#f92672">&amp;#34;number_of_replicas&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">0&lt;/span>},&lt;span style="color:#f92672">&amp;#34;mappings&amp;#34;&lt;/span>:{&lt;span style="color:#f92672">&amp;#34;user&amp;#34;&lt;/span>:{&lt;span style="color:#f92672">&amp;#34;dynamic&amp;#34;&lt;/span>:&lt;span style="color:#960050;background-color:#1e0010">strict&lt;/span>,&lt;span style="color:#f92672">&amp;#34;properties&amp;#34;&lt;/span>:{&lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>: {&lt;span style="color:#f92672">&amp;#34;type&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;text&amp;#34;&lt;/span>},&lt;span style="color:#f92672">&amp;#34;address&amp;#34;&lt;/span>:{&lt;span style="color:#f92672">&amp;#34;type&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;object&amp;#34;&lt;/span>,&lt;span style="color:#f92672">&amp;#34;dynamic&amp;#34;&lt;/span>:&lt;span style="color:#66d9ef">true&lt;/span>},}}}}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¼šæŠ¥é”™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">PUT&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">/lib&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">/user/&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>{&lt;span style="color:#f92672">&amp;#34;name&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;lisi&amp;#34;&lt;/span>,&lt;span style="color:#f92672">&amp;#34;age&amp;#34;&lt;/span>:&lt;span style="color:#ae81ff">20&lt;/span>,&lt;span style="color:#f92672">&amp;#34;address&amp;#34;&lt;/span>:{&lt;span style="color:#f92672">&amp;#34;province&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;beijing&amp;#34;&lt;/span>,&lt;span style="color:#f92672">&amp;#34;city&amp;#34;&lt;/span>:&lt;span style="color:#e6db74">&amp;#34;beijing&amp;#34;&lt;/span>}}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>date_detection&lt;/strong>:é»˜è®¤ä¼šæŒ‰ç…§ä¸€å®šæ ¼å¼è¯†åˆ«dateï¼Œæ¯”å¦‚yyyy-MM-dd&lt;/p>
&lt;p>å¯ä»¥æ‰‹åŠ¨å…³é—­æŸä¸ªtypeçš„date_detection&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">PUT&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">/lib&lt;/span>&lt;span style="color:#ae81ff">8&lt;/span>{&lt;span style="color:#f92672">&amp;#34;settings&amp;#34;&lt;/span>:{&lt;span style="color:#f92672">&amp;#34;number_of_shards&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">3&lt;/span>,&lt;span style="color:#f92672">&amp;#34;number_of_replicas&amp;#34;&lt;/span> : &lt;span style="color:#ae81ff">0&lt;/span>},&lt;span style="color:#f92672">&amp;#34;mappings&amp;#34;&lt;/span>:{&lt;span style="color:#f92672">&amp;#34;user&amp;#34;&lt;/span>:{&lt;span style="color:#f92672">&amp;#34;date_detection&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,}}}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>å®šåˆ¶ dynamic mapping template(type)&lt;/strong>&lt;/p>
&lt;p>PUT /my_index{&amp;ldquo;mappings&amp;rdquo;: {&amp;ldquo;my_type&amp;rdquo;: {&amp;ldquo;dynamic_templates&amp;rdquo;: [{&amp;ldquo;en&amp;rdquo;: {&amp;ldquo;match&amp;rdquo;: &amp;ldquo;*_en&amp;rdquo;,&amp;ldquo;match_mapping_type&amp;rdquo;: &amp;ldquo;string&amp;rdquo;,&amp;ldquo;mapping&amp;rdquo;: {&amp;ldquo;type&amp;rdquo;: &amp;ldquo;text&amp;rdquo;,&amp;ldquo;analyzer&amp;rdquo;: &amp;ldquo;english&amp;rdquo;}}}]}}}#ä½¿ç”¨äº†æ¨¡æ¿&lt;/p>
&lt;p>PUT /my_index/my_type/3{&amp;ldquo;title_en&amp;rdquo;: &amp;ldquo;this is my dog&amp;rdquo;&lt;/p>
&lt;p>}#æ²¡æœ‰ä½¿ç”¨æ¨¡æ¿&lt;/p>
&lt;p>PUT /my_index/my_type/5{&amp;ldquo;title&amp;rdquo;: &amp;ldquo;this is my cat&amp;rdquo;}&lt;/p>
&lt;p>GET my_index/my_type/_search{&amp;ldquo;query&amp;rdquo;: {&amp;ldquo;match&amp;rdquo;: {&amp;ldquo;title&amp;rdquo;: &amp;ldquo;is&amp;rdquo;}}}&lt;/p>
&lt;h3 id="é‡å»ºç´¢å¼•">é‡å»ºç´¢å¼•&lt;/h3>
&lt;p>ä¸€ä¸ªfieldçš„è®¾ç½®æ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œå¦‚æœè¦ä¿®æ”¹ä¸€ä¸ªfieldï¼Œé‚£ä¹ˆåº”è¯¥é‡æ–°æŒ‰ç…§æ–°çš„mappingï¼Œå»ºç«‹ä¸€ä¸ªindexï¼Œç„¶åå°†æ•°æ®æ‰¹é‡æŸ¥è¯¢å‡ºæ¥ï¼Œé‡æ–°ç”¨bulk apiå†™å…¥åˆ°indexä¸­ã€‚&lt;/p>
&lt;p>æ‰¹é‡æŸ¥è¯¢çš„æ—¶å€™ï¼Œå»ºè®®é‡‡ç”¨scroll apiï¼Œå¹¶ä¸”é‡‡ç”¨å¤šçº¿ç¨‹å¹¶å‘çš„æ–¹å¼æ¥reindexæ•°æ®ï¼Œæ¯æ¬¡scrollå°±æŸ¥è¯¢æŒ‡å®šæ—¥æœŸçš„ä¸€æ®µæ•°æ®ï¼Œäº¤ç»™ä¸€ä¸ªçº¿ç¨‹å³å¯ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code># åŸå§‹çš„æ•°æ®
PUT /index1/type1/4
{
&amp;#34;content&amp;#34;:&amp;#34;1990-12-12&amp;#34;
}
#æŠ¥é”™
PUT /index1/type1/4
{
&amp;#34;content&amp;#34;:&amp;#34;I am very happy.&amp;#34;
}
#ä¿®æ”¹contentçš„ç±»å‹ä¸ºstringç±»å‹,æŠ¥é”™ï¼Œä¸å…è®¸ä¿®æ”¹
PUT /index1/_mapping/type1
{
&amp;#34;properties&amp;#34;: {
&amp;#34;content&amp;#34;:{
&amp;#34;type&amp;#34;: &amp;#34;text&amp;#34;
}
}
}
&lt;/code>&lt;/pre>&lt;p>åˆ›å»ºä¸€ä¸ªæ–°çš„ç´¢å¼•ï¼ŒæŠŠindex1ç´¢å¼•ä¸­çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥å¯¼å…¥åˆ°æ–°çš„ç´¢å¼•ä¸­,ä½†æ˜¯åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ˜¯ä¹‹å‰çš„ç´¢å¼•ï¼Œä¸ºäº†ä¸ç”¨é‡å¯åº”ç”¨ç¨‹åºï¼Œç»™index1è¿™ä¸ªç´¢å¼•èµ·ä¸ª&lt;/p>
&lt;pre tabindex="0">&lt;code># èµ·åˆ«å
PUT /index1/_alias/index2
# åˆ›å»ºæ–°çš„ç´¢å¼•ï¼ŒæŠŠcontentçš„ç±»å‹æ”¹ä¸ºå­—ç¬¦ä¸²
PUT /newindex
{
&amp;#34;mappings&amp;#34;: {
&amp;#34;type1&amp;#34;:{
&amp;#34;properties&amp;#34;: {
&amp;#34;content&amp;#34;:{
&amp;#34;type&amp;#34;: &amp;#34;text&amp;#34;
}
}
}
}
}
# ä½¿ç”¨scrollæ‰¹é‡æŸ¥è¯¢
GET /index1/type1/_search?scroll=1m
{
&amp;#34;query&amp;#34;: {
&amp;#34;match_all&amp;#34;: {}
},
&amp;#34;sort&amp;#34;: [&amp;#34;_doc&amp;#34;],
&amp;#34;size&amp;#34;: 2
}
#ä½¿ç”¨bulkæ‰¹é‡å†™å…¥æ–°çš„ç´¢å¼•
POST /_bulk
{&amp;#34;index&amp;#34;:{&amp;#34;_index&amp;#34;:&amp;#34;newindex&amp;#34;,&amp;#34;_type&amp;#34;:&amp;#34;type1&amp;#34;,&amp;#34;_id&amp;#34;:1}}
{&amp;#34;content&amp;#34;:&amp;#34;1982-12-12&amp;#34;}
#å°†åˆ«åindex2å’Œæ–°çš„ç´¢å¼•å…³è”ï¼Œåº”ç”¨ç¨‹åºä¸ç”¨é‡å¯
POST /_aliases
{
&amp;#34;actions&amp;#34;: [
{&amp;#34;remove&amp;#34;: {&amp;#34;index&amp;#34;:&amp;#34;index1&amp;#34;,&amp;#34;alias&amp;#34;:&amp;#34;index2&amp;#34;}},
{&amp;#34;add&amp;#34;: {&amp;#34;index&amp;#34;: &amp;#34;newindex&amp;#34;,&amp;#34;alias&amp;#34;: &amp;#34;index2&amp;#34;}}
]
}
GET index2/type1/_search
&lt;/code>&lt;/pre>&lt;h3 id="ç´¢å¼•ä¸å¯å˜çš„åŸå› ">ç´¢å¼•ä¸å¯å˜çš„åŸå› &lt;/h3>
&lt;p>å€’æ’ç´¢å¼•åŒ…æ‹¬ï¼š&lt;/p>
&lt;p>æ–‡æ¡£çš„åˆ—è¡¨ï¼Œæ–‡æ¡£çš„æ•°é‡ï¼Œè¯æ¡åœ¨æ¯ä¸ªæ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå‡ºç°çš„ä½ç½®ï¼Œæ¯ä¸ªæ–‡æ¡£çš„é•¿åº¦ï¼Œæ‰€æœ‰æ–‡æ¡£çš„å¹³å‡é•¿åº¦&lt;/p>
&lt;p>ç´¢å¼•ä¸å˜çš„åŸå› ï¼š&lt;/p>
&lt;p>ä¸éœ€è¦é”ï¼Œæå‡äº†å¹¶å‘æ€§èƒ½&lt;/p>
&lt;p>å¯ä»¥ä¸€ç›´ä¿å­˜åœ¨ç¼“å­˜ä¸­ï¼ˆfilterï¼‰&lt;/p>
&lt;p>èŠ‚çœcpuå’Œioå¼€é”€&lt;/p>
&lt;h1 id="å…ˆè®°ç€">å…ˆè®°ç€&lt;/h1>
&lt;p>ç”¨logstashå»åŒæ­¥mysqlçš„çš„å¢é‡,,éœ€è¦ä¸¤ä¸ªå­—æ®µ,ç¬¬ä¸€ä¸ªæ˜¯ id,ä¸»é”®,ç¬¬äºŒä¸ªæ˜¯update_date, ç”¨ç¬¬äºŒä¸ªå­—æ®µå»æŸ¥è¯¢,é»˜è®¤ç”¨idå»å»é‡&lt;/p>
&lt;p>group by çš„æ—¶å€™æŠ¥é”™äº†&lt;/p>
&lt;p>esè¿›è¡Œèšåˆæ“ä½œæ—¶æç¤ºFielddata is disabled on text fields by default&lt;/p>
&lt;p>&lt;a href="https://blog.csdn.net/u011403655/article/details/71107415/">https://blog.csdn.net/u011403655/article/details/71107415/&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code># å……å€¼ç¬”æ•°
GET /shouye/rukuan/_search
{
&amp;#34;aggs&amp;#34;: {
&amp;#34;my_cre&amp;#34;: {
&amp;#34;terms&amp;#34;: {
&amp;#34;field&amp;#34;: &amp;#34;orderId&amp;#34;
}
}
}
}
GET /shouye/rukuan/_count
GET /shouye/_mapping
PUT shouye/_mapping/rukuan/
{
&amp;#34;properties&amp;#34;: {
&amp;#34;orderId&amp;#34;: {
&amp;#34;type&amp;#34;: &amp;#34;text&amp;#34;,
&amp;#34;fielddata&amp;#34;: true
}
}
}
&lt;/code>&lt;/pre>&lt;h1 id="springbootæ•´åˆelasticsearch">springbootæ•´åˆElasticsearch&lt;/h1>
&lt;pre tabindex="0">&lt;code>&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;
&amp;lt;project xmlns=&amp;#34;http://maven.apache.org/POM/4.0.0&amp;#34; xmlns:xsi=&amp;#34;http://www.w3.org/2001/XMLSchema-instance&amp;#34;
xsi:schemaLocation=&amp;#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&amp;#34;&amp;gt;
&amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;
&amp;lt;parent&amp;gt;
&amp;lt;groupId&amp;gt;com.lzkj&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;item2&amp;lt;/artifactId&amp;gt;
&amp;lt;version&amp;gt;0.0.1-SNAPSHOT&amp;lt;/version&amp;gt;
&amp;lt;/parent&amp;gt;
&amp;lt;groupId&amp;gt;com.es&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;es-server&amp;lt;/artifactId&amp;gt;
&amp;lt;version&amp;gt;0.0.1-SNAPSHOT&amp;lt;/version&amp;gt;
&amp;lt;name&amp;gt;es-server&amp;lt;/name&amp;gt;
&amp;lt;description&amp;gt;Demo project for Spring Boot&amp;lt;/description&amp;gt;
&amp;lt;properties&amp;gt;
&amp;lt;java.version&amp;gt;1.8&amp;lt;/java.version&amp;gt;
&amp;lt;/properties&amp;gt;
&amp;lt;dependencies&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-boot-starter-data-elasticsearch&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-boot-starter-web&amp;lt;/artifactId&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&amp;lt;build&amp;gt;
&amp;lt;plugins&amp;gt;
&amp;lt;plugin&amp;gt;
&amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
&amp;lt;artifactId&amp;gt;spring-boot-maven-plugin&amp;lt;/artifactId&amp;gt;
&amp;lt;/plugin&amp;gt;
&amp;lt;/plugins&amp;gt;
&amp;lt;/build&amp;gt;
&amp;lt;/project&amp;gt;
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>spring.elasticsearch.rest.uris=http://192.168.111.132:9200
&lt;/code>&lt;/pre></content></item><item><title>Excel</title><link>https://connorzhangyu.com/posts/excel/</link><pubDate>Sat, 19 Nov 2022 18:25:00 +0000</pubDate><guid>https://connorzhangyu.com/posts/excel/</guid><description>&lt;h1 id="è¡Œå’Œåˆ—">è¡Œå’Œåˆ—&lt;/h1>
&lt;h2 id="éšè—æˆ–æ˜¾ç¤ºè¡Œå’Œåˆ—">éšè—æˆ–æ˜¾ç¤ºè¡Œå’Œåˆ—&lt;/h2>
&lt;p>åœ¨ç”µå­è¡¨æ ¼ä¸­éšè—æˆ–å–æ¶ˆéšè—åˆ—ï¼Œä»¥ä»…æ˜¾ç¤ºéœ€è¦æŸ¥çœ‹æˆ–æ‰“å°çš„æ•°æ®&lt;/p>
&lt;blockquote>
&lt;p>ğŸ“Œ ä¸å½±å“è®¡ç®—&lt;/p>&lt;/blockquote>
&lt;h3 id="éšè—åˆ—">éšè—åˆ—&lt;/h3>
&lt;ol>
&lt;li>é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ï¼Œç„¶åæŒ‰ Ctrl é€‰æ‹©ä¸ç›¸é‚»çš„å…¶ä»–åˆ—ã€‚&lt;/li>
&lt;li>å³é”®å•å‡»é€‰å®šçš„åˆ—ï¼Œç„¶åé€‰æ‹©&lt;code>éšè—&lt;/code>ã€‚
ğŸ“Œ ä¸¤åˆ—ä¹‹é—´çš„åŒçº¿è¡¨ç¤ºéšè—äº†ä¸€ä¸ªåˆ—ã€‚&lt;/li>
&lt;/ol>
&lt;p>âœ… å‚è€ƒ:&lt;a href="https://support.microsoft.com/zh-cn/office/%E9%9A%90%E8%97%8F%E6%88%96%E6%98%BE%E7%A4%BA%E8%A1%8C%E6%88%96%E5%88%97-659c2cad-802e-44ee-a614-dde8443579f8">å¾®è½¯å®˜æ–¹æ–‡æ¡£&lt;/a>&lt;/p>
&lt;h3 id="å–æ¶ˆéšè—åˆ—">å–æ¶ˆéšè—åˆ—&lt;/h3>
&lt;ol>
&lt;li>é€‰æ‹©éšè—åˆ—çš„&lt;code>ç›¸é‚»å·¦åˆ—å’Œç›¸é‚»å³åˆ—&lt;/code>ã€‚&lt;/li>
&lt;li>å³é”®å•å‡»é€‰å®šçš„åˆ—ï¼Œç„¶åé€‰æ‹©â€œ&lt;strong>å–æ¶ˆéšè—&lt;/strong>â€ã€‚&lt;/li>
&lt;/ol>
&lt;p>æˆ–åŒå‡»éšè—åˆ—æ‰€å­˜åœ¨çš„ä¸¤åˆ—ä¹‹é—´çš„åŒçº¿ã€‚&lt;/p>
&lt;h2 id="è‡ªå®šä¹‰åˆ—çš„æ ¼å¼">è‡ªå®šä¹‰åˆ—çš„æ ¼å¼&lt;/h2>
&lt;p>æ¯”å¦‚è¿™é‡Œè¦è®¾ç½®åˆ—çš„æ ¼å¼æ˜¯ å¹´æœˆæ—¥æ˜ŸæœŸå‡ &lt;/p>
&lt;p>é»˜è®¤çš„æ—¥æœŸå’Œæ—¶é—´æ˜¯æ²¡æœ‰ç¬¦åˆè¦æ±‚çš„
&lt;img src="https://image.runtimes.cc/202404051416398.png" alt="">&lt;/p>
&lt;p>è‡ªå®šä¹‰è®¾ç½®
&lt;img src="https://image.runtimes.cc/202404051416110.png" alt="">&lt;/p>
&lt;p>ğŸ“Œ è¿™æ ·è®¾ç½®ä¹‹å,æ¯”å¦‚åœ¨å•å…ƒæ ¼é‡Œå€¼è®¾ç½®çš„æ˜¯ 2021-01-02
å®é™…ä¸Šæ˜¾ç°çš„ä¼šæ˜¯ 2021å¹´1æœˆ2æ—¥ æ˜ŸæœŸå‡ &lt;/p>
&lt;p>âœ… å‚è€ƒ:&lt;a href="https://support.microsoft.com/zh-cn/office/%E6%8C%89%E6%83%B3%E8%A6%81%E7%9A%84%E6%96%B9%E5%BC%8F%E8%AE%BE%E7%BD%AE%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F-8e10019e-d5d8-47a1-ba95-db95123d273e">å¾®è½¯å®˜æ–¹æ–‡æ¡£&lt;/a>&lt;/p></description><content>&lt;h1 id="è¡Œå’Œåˆ—">è¡Œå’Œåˆ—&lt;/h1>
&lt;h2 id="éšè—æˆ–æ˜¾ç¤ºè¡Œå’Œåˆ—">éšè—æˆ–æ˜¾ç¤ºè¡Œå’Œåˆ—&lt;/h2>
&lt;p>åœ¨ç”µå­è¡¨æ ¼ä¸­éšè—æˆ–å–æ¶ˆéšè—åˆ—ï¼Œä»¥ä»…æ˜¾ç¤ºéœ€è¦æŸ¥çœ‹æˆ–æ‰“å°çš„æ•°æ®&lt;/p>
&lt;blockquote>
&lt;p>ğŸ“Œ ä¸å½±å“è®¡ç®—&lt;/p>&lt;/blockquote>
&lt;h3 id="éšè—åˆ—">éšè—åˆ—&lt;/h3>
&lt;ol>
&lt;li>é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ï¼Œç„¶åæŒ‰ Ctrl é€‰æ‹©ä¸ç›¸é‚»çš„å…¶ä»–åˆ—ã€‚&lt;/li>
&lt;li>å³é”®å•å‡»é€‰å®šçš„åˆ—ï¼Œç„¶åé€‰æ‹©&lt;code>éšè—&lt;/code>ã€‚
ğŸ“Œ ä¸¤åˆ—ä¹‹é—´çš„åŒçº¿è¡¨ç¤ºéšè—äº†ä¸€ä¸ªåˆ—ã€‚&lt;/li>
&lt;/ol>
&lt;p>âœ… å‚è€ƒ:&lt;a href="https://support.microsoft.com/zh-cn/office/%E9%9A%90%E8%97%8F%E6%88%96%E6%98%BE%E7%A4%BA%E8%A1%8C%E6%88%96%E5%88%97-659c2cad-802e-44ee-a614-dde8443579f8">å¾®è½¯å®˜æ–¹æ–‡æ¡£&lt;/a>&lt;/p>
&lt;h3 id="å–æ¶ˆéšè—åˆ—">å–æ¶ˆéšè—åˆ—&lt;/h3>
&lt;ol>
&lt;li>é€‰æ‹©éšè—åˆ—çš„&lt;code>ç›¸é‚»å·¦åˆ—å’Œç›¸é‚»å³åˆ—&lt;/code>ã€‚&lt;/li>
&lt;li>å³é”®å•å‡»é€‰å®šçš„åˆ—ï¼Œç„¶åé€‰æ‹©â€œ&lt;strong>å–æ¶ˆéšè—&lt;/strong>â€ã€‚&lt;/li>
&lt;/ol>
&lt;p>æˆ–åŒå‡»éšè—åˆ—æ‰€å­˜åœ¨çš„ä¸¤åˆ—ä¹‹é—´çš„åŒçº¿ã€‚&lt;/p>
&lt;h2 id="è‡ªå®šä¹‰åˆ—çš„æ ¼å¼">è‡ªå®šä¹‰åˆ—çš„æ ¼å¼&lt;/h2>
&lt;p>æ¯”å¦‚è¿™é‡Œè¦è®¾ç½®åˆ—çš„æ ¼å¼æ˜¯ å¹´æœˆæ—¥æ˜ŸæœŸå‡ &lt;/p>
&lt;p>é»˜è®¤çš„æ—¥æœŸå’Œæ—¶é—´æ˜¯æ²¡æœ‰ç¬¦åˆè¦æ±‚çš„
&lt;img src="https://image.runtimes.cc/202404051416398.png" alt="">&lt;/p>
&lt;p>è‡ªå®šä¹‰è®¾ç½®
&lt;img src="https://image.runtimes.cc/202404051416110.png" alt="">&lt;/p>
&lt;p>ğŸ“Œ è¿™æ ·è®¾ç½®ä¹‹å,æ¯”å¦‚åœ¨å•å…ƒæ ¼é‡Œå€¼è®¾ç½®çš„æ˜¯ 2021-01-02
å®é™…ä¸Šæ˜¾ç°çš„ä¼šæ˜¯ 2021å¹´1æœˆ2æ—¥ æ˜ŸæœŸå‡ &lt;/p>
&lt;p>âœ… å‚è€ƒ:&lt;a href="https://support.microsoft.com/zh-cn/office/%E6%8C%89%E6%83%B3%E8%A6%81%E7%9A%84%E6%96%B9%E5%BC%8F%E8%AE%BE%E7%BD%AE%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F-8e10019e-d5d8-47a1-ba95-db95123d273e">å¾®è½¯å®˜æ–¹æ–‡æ¡£&lt;/a>&lt;/p></content></item><item><title>IDEA</title><link>https://connorzhangyu.com/posts/idea/</link><pubDate>Sat, 19 Nov 2022 18:25:00 +0000</pubDate><guid>https://connorzhangyu.com/posts/idea/</guid><description>&lt;h1 id="æ•™ç¨‹">æ•™ç¨‹&lt;/h1>
&lt;h2 id="ideaæŸ¥çœ‹æ–¹æ³•è¢«è°ƒç”¨">IDEAæŸ¥çœ‹æ–¹æ³•è¢«è°ƒç”¨&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051423853.png" alt="">&lt;/p>
&lt;h2 id="ä¿®æ”¹å…‰æ ‡æ‰€åœ¨è¡ŒèƒŒæ™¯é¢œè‰²">ä¿®æ”¹å…‰æ ‡æ‰€åœ¨è¡ŒèƒŒæ™¯é¢œè‰²&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051423630.png" alt="">&lt;/p>
&lt;h2 id="æ–­ç‚¹åˆ¤æ–­æ¡ä»¶">æ–­ç‚¹åˆ¤æ–­æ¡ä»¶&lt;/h2>
&lt;p>åœ¨æ–­ç‚¹ä¸Šç‚¹å³é”®,æ­£å¸¸çš„å†™åˆ¤æ–­ä»£ç å°±è¡Œ&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051423731.png" alt="image-20230803174451532">&lt;/p>
&lt;h2 id="æ’ä»¶">æ’ä»¶&lt;/h2>
&lt;h3 id="rabinbow-brackets">Rabinbow Brackets&lt;/h3>
&lt;p>ä½œè€…:Zhihao Zhang&lt;/p>
&lt;p>ä½¿ç”¨æ–¹æ³•&lt;/p>
&lt;p>&lt;code>Command&lt;/code>+å³é”®,é«˜äº®é€‰ä¸­éƒ¨åˆ†&lt;/p>
&lt;p>&lt;code>Alt&lt;/code>+å³é”®,é«˜äº®é€‰ä¸­éƒ¨åˆ†,å…¶ä½™çš„ä»£ç å˜æš—&lt;/p>
&lt;h3 id="commitmessage">CommitMessage&lt;/h3>
&lt;p>ä½œè€…:éƒ­ç¿°æ—&lt;/p>
&lt;p>ä½¿ç”¨æ–¹æ³•,æäº¤çš„æ—¶å€™,ç‚¹å‡»âœˆï¸çš„å›¾æ ‡&lt;/p>
&lt;h3 id="codeium">Codeium&lt;/h3>
&lt;p>ä½œè€…:Codeium&lt;/p>
&lt;p>å†™ä»£ç çš„æ—¶å€™ä¼šæœ‰è‡ªåŠ¨æç¤º,æŒ‰tabç¡®å®šä½¿ç”¨AIç”Ÿæˆçš„ä»£ç &lt;/p>
&lt;h3 id="key-promoter-x">Key Promoter X&lt;/h3>
&lt;h3 id="translation">Translation&lt;/h3>
&lt;p>ä½œè€…:Yii.Guxing&lt;/p>
&lt;p>é€‰ä¸­è¦ç¿»è¯‘çš„å†…å®¹,å³é”®é€‰æ‹©ç¿»è¯‘&lt;/p></description><content>&lt;h1 id="æ•™ç¨‹">æ•™ç¨‹&lt;/h1>
&lt;h2 id="ideaæŸ¥çœ‹æ–¹æ³•è¢«è°ƒç”¨">IDEAæŸ¥çœ‹æ–¹æ³•è¢«è°ƒç”¨&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051423853.png" alt="">&lt;/p>
&lt;h2 id="ä¿®æ”¹å…‰æ ‡æ‰€åœ¨è¡ŒèƒŒæ™¯é¢œè‰²">ä¿®æ”¹å…‰æ ‡æ‰€åœ¨è¡ŒèƒŒæ™¯é¢œè‰²&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051423630.png" alt="">&lt;/p>
&lt;h2 id="æ–­ç‚¹åˆ¤æ–­æ¡ä»¶">æ–­ç‚¹åˆ¤æ–­æ¡ä»¶&lt;/h2>
&lt;p>åœ¨æ–­ç‚¹ä¸Šç‚¹å³é”®,æ­£å¸¸çš„å†™åˆ¤æ–­ä»£ç å°±è¡Œ&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051423731.png" alt="image-20230803174451532">&lt;/p>
&lt;h2 id="æ’ä»¶">æ’ä»¶&lt;/h2>
&lt;h3 id="rabinbow-brackets">Rabinbow Brackets&lt;/h3>
&lt;p>ä½œè€…:Zhihao Zhang&lt;/p>
&lt;p>ä½¿ç”¨æ–¹æ³•&lt;/p>
&lt;p>&lt;code>Command&lt;/code>+å³é”®,é«˜äº®é€‰ä¸­éƒ¨åˆ†&lt;/p>
&lt;p>&lt;code>Alt&lt;/code>+å³é”®,é«˜äº®é€‰ä¸­éƒ¨åˆ†,å…¶ä½™çš„ä»£ç å˜æš—&lt;/p>
&lt;h3 id="commitmessage">CommitMessage&lt;/h3>
&lt;p>ä½œè€…:éƒ­ç¿°æ—&lt;/p>
&lt;p>ä½¿ç”¨æ–¹æ³•,æäº¤çš„æ—¶å€™,ç‚¹å‡»âœˆï¸çš„å›¾æ ‡&lt;/p>
&lt;h3 id="codeium">Codeium&lt;/h3>
&lt;p>ä½œè€…:Codeium&lt;/p>
&lt;p>å†™ä»£ç çš„æ—¶å€™ä¼šæœ‰è‡ªåŠ¨æç¤º,æŒ‰tabç¡®å®šä½¿ç”¨AIç”Ÿæˆçš„ä»£ç &lt;/p>
&lt;h3 id="key-promoter-x">Key Promoter X&lt;/h3>
&lt;h3 id="translation">Translation&lt;/h3>
&lt;p>ä½œè€…:Yii.Guxing&lt;/p>
&lt;p>é€‰ä¸­è¦ç¿»è¯‘çš„å†…å®¹,å³é”®é€‰æ‹©ç¿»è¯‘&lt;/p></content></item><item><title>Jenkins</title><link>https://connorzhangyu.com/posts/jenkins/</link><pubDate>Sat, 19 Nov 2022 18:25:00 +0000</pubDate><guid>https://connorzhangyu.com/posts/jenkins/</guid><description>&lt;h1 id="rootç”¨æˆ·æƒé™å¯åŠ¨jenkins">Rootç”¨æˆ·æƒé™å¯åŠ¨Jenkins&lt;/h1>
&lt;p>é€‚ç”¨äºUbuntuç¯å¢ƒä¸‹é€šè¿‡&lt;code>apt-get install -y jenkins&lt;/code>å‘½ä»¤åœ¨çº¿å®‰è£…çš„Jenkins&lt;/p>
&lt;p>1.ä¿®æ”¹é…ç½®æ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim /etc/default/jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å°†ä¸‹é¢ä¸¤ä¸ªå‚æ•°ä¿®æ”¹ä¸ºroot&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¿®æ”¹å‰&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>JENKINS_USER&lt;span style="color:#f92672">=&lt;/span>$NAME
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>JENKINS_GROUP&lt;span style="color:#f92672">=&lt;/span>$NAME
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¿®æ”¹å&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>JENKINS_USER&lt;span style="color:#f92672">=&lt;/span>root
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>JENKINS_GROUP&lt;span style="color:#f92672">=&lt;/span>root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>2.æ›´æ”¹ç›®å½•æƒé™&lt;/p>
&lt;p>ä¸çŸ¥é“è¿™æ­¥æœ‰æ²¡æœ‰èµ·ä½œç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd /var/lib/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chown -R root:root ./jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é‡å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl restart jenkins.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="jenkinsä½¿ç”¨æ•™ç¨‹">Jenkinsä½¿ç”¨æ•™ç¨‹&lt;/h1>
&lt;h2 id="é…ç½®jdk">é…ç½®JDK&lt;/h2>
&lt;p>Manage Jenkins &amp;ndash;&amp;gt; Global Tool Configuration&lt;/p>
&lt;ol>
&lt;li>è‡ªåŠ¨å®‰è£…&lt;/li>
&lt;li>æ‰‹åŠ¨å®‰è£…è¦æ³¨æ„,J&lt;code>AVA_HOME&lt;/code>çš„è¾“å…¥æ¡†ä¸‹é¢ï¼Œä¸è¦æœ‰è­¦å‘Šæˆ–è€…é”™è¯¯ä¿¡æ¯ï¼Œå¦åˆ™å°±æ˜¯è·¯å¾„ä¸æ­£ç¡®,å–æ¶ˆå‹¾é€‰è‡ªåŠ¨å®‰è£…&lt;/li>
&lt;/ol>
&lt;h2 id="é…ç½®maven">é…ç½®Maven&lt;/h2>
&lt;ol>
&lt;li>å®‰è£…Maven Integration æ’ä»¶&lt;/li>
&lt;li>é€šå¸¸è‡ªåŠ¨å®‰è£…mavenå°±è¡Œäº†,å¦‚æœæ‰‹åŠ¨å®‰è£…,&lt;code>MAVEN_HOME&lt;/code> è¾“å…¥æ¡†ä¸‹é¢ï¼Œä¸è¦æœ‰è­¦å‘Šæˆ–è€…é”™è¯¯ä¿¡æ¯ï¼Œå¦åˆ™å°±æ˜¯è·¯å¾„ä¸æ­£ç¡®&lt;/li>
&lt;/ol>
&lt;h2 id="è·å–å½“å‰é¡¹ç›®åç§°">è·å–å½“å‰é¡¹ç›®åç§°&lt;/h2>
&lt;p>åœ¨è„šæœ¬ä¸­è¾“å…¥ &lt;code>$JOB_NAME&lt;/code>å°±èƒ½è·å–åˆ°äº†&lt;/p>
&lt;h2 id="å¸è½½jenkins">å¸è½½jenkins&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>//æœåŠ¡
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get remove jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>//å®‰è£…åŒ…ï¼Œæ³¨æ„è¿™é‡Œå¦‚æœä¸æ˜¯ubuntué‚£å°±yum
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get remove --auto-remove jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>//é…ç½®å’Œæ•°æ®
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get purge jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get purge --auto-remove jenkins
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‡çº§jenkins">å‡çº§jenkins&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é€‚ç”¨äºubuntuå®‰è£…çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>apt-get upgrade jenkins
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="åŒæ—¶æ„å»ºä»»åŠ¡çš„ä¸ªæ•°">åŒæ—¶æ„å»ºä»»åŠ¡çš„ä¸ªæ•°&lt;/h2>
&lt;p>ç³»ç»Ÿç®¡ç†&amp;ndash;&amp;gt;ç³»ç»Ÿè®¾ç½®&amp;ndash;&amp;gt;æ‰§è¡Œè€…æ•°é‡&lt;/p></description><content>&lt;h1 id="rootç”¨æˆ·æƒé™å¯åŠ¨jenkins">Rootç”¨æˆ·æƒé™å¯åŠ¨Jenkins&lt;/h1>
&lt;p>é€‚ç”¨äºUbuntuç¯å¢ƒä¸‹é€šè¿‡&lt;code>apt-get install -y jenkins&lt;/code>å‘½ä»¤åœ¨çº¿å®‰è£…çš„Jenkins&lt;/p>
&lt;p>1.ä¿®æ”¹é…ç½®æ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim /etc/default/jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å°†ä¸‹é¢ä¸¤ä¸ªå‚æ•°ä¿®æ”¹ä¸ºroot&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¿®æ”¹å‰&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>JENKINS_USER&lt;span style="color:#f92672">=&lt;/span>$NAME
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>JENKINS_GROUP&lt;span style="color:#f92672">=&lt;/span>$NAME
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¿®æ”¹å&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>JENKINS_USER&lt;span style="color:#f92672">=&lt;/span>root
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>JENKINS_GROUP&lt;span style="color:#f92672">=&lt;/span>root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>2.æ›´æ”¹ç›®å½•æƒé™&lt;/p>
&lt;p>ä¸çŸ¥é“è¿™æ­¥æœ‰æ²¡æœ‰èµ·ä½œç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd /var/lib/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chown -R root:root ./jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é‡å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl restart jenkins.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="jenkinsä½¿ç”¨æ•™ç¨‹">Jenkinsä½¿ç”¨æ•™ç¨‹&lt;/h1>
&lt;h2 id="é…ç½®jdk">é…ç½®JDK&lt;/h2>
&lt;p>Manage Jenkins &amp;ndash;&amp;gt; Global Tool Configuration&lt;/p>
&lt;ol>
&lt;li>è‡ªåŠ¨å®‰è£…&lt;/li>
&lt;li>æ‰‹åŠ¨å®‰è£…è¦æ³¨æ„,J&lt;code>AVA_HOME&lt;/code>çš„è¾“å…¥æ¡†ä¸‹é¢ï¼Œä¸è¦æœ‰è­¦å‘Šæˆ–è€…é”™è¯¯ä¿¡æ¯ï¼Œå¦åˆ™å°±æ˜¯è·¯å¾„ä¸æ­£ç¡®,å–æ¶ˆå‹¾é€‰è‡ªåŠ¨å®‰è£…&lt;/li>
&lt;/ol>
&lt;h2 id="é…ç½®maven">é…ç½®Maven&lt;/h2>
&lt;ol>
&lt;li>å®‰è£…Maven Integration æ’ä»¶&lt;/li>
&lt;li>é€šå¸¸è‡ªåŠ¨å®‰è£…mavenå°±è¡Œäº†,å¦‚æœæ‰‹åŠ¨å®‰è£…,&lt;code>MAVEN_HOME&lt;/code> è¾“å…¥æ¡†ä¸‹é¢ï¼Œä¸è¦æœ‰è­¦å‘Šæˆ–è€…é”™è¯¯ä¿¡æ¯ï¼Œå¦åˆ™å°±æ˜¯è·¯å¾„ä¸æ­£ç¡®&lt;/li>
&lt;/ol>
&lt;h2 id="è·å–å½“å‰é¡¹ç›®åç§°">è·å–å½“å‰é¡¹ç›®åç§°&lt;/h2>
&lt;p>åœ¨è„šæœ¬ä¸­è¾“å…¥ &lt;code>$JOB_NAME&lt;/code>å°±èƒ½è·å–åˆ°äº†&lt;/p>
&lt;h2 id="å¸è½½jenkins">å¸è½½jenkins&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>//æœåŠ¡
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get remove jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>//å®‰è£…åŒ…ï¼Œæ³¨æ„è¿™é‡Œå¦‚æœä¸æ˜¯ubuntué‚£å°±yum
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get remove --auto-remove jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>//é…ç½®å’Œæ•°æ®
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get purge jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get purge --auto-remove jenkins
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‡çº§jenkins">å‡çº§jenkins&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é€‚ç”¨äºubuntuå®‰è£…çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>apt-get upgrade jenkins
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="åŒæ—¶æ„å»ºä»»åŠ¡çš„ä¸ªæ•°">åŒæ—¶æ„å»ºä»»åŠ¡çš„ä¸ªæ•°&lt;/h2>
&lt;p>ç³»ç»Ÿç®¡ç†&amp;ndash;&amp;gt;ç³»ç»Ÿè®¾ç½®&amp;ndash;&amp;gt;æ‰§è¡Œè€…æ•°é‡&lt;/p>
&lt;h2 id="æ„å»ºæˆåŠŸæ‰ç»§ç»­å‘åŒ…">æ„å»ºæˆåŠŸæ‰ç»§ç»­å‘åŒ…&lt;/h2>
&lt;p>åªæ˜¯ä¸ªä¸å¤§ä¸å°çš„åŠŸèƒ½,å¾ˆå®¹æ˜“å¿½ç•¥äº†,åœ¨ ä»»åŠ¡çš„é…ç½®&amp;ndash;&amp;gt;Post Steps &amp;ndash;&amp;gt; Run only if build succeeds&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202405280938281.png" alt="image-20240528093819570">&lt;/p>
&lt;h2 id="ä¿®æ”¹æ—¶åŒº">ä¿®æ”¹æ—¶åŒº&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202408091744504.png" alt="image-20240809174451156">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202408091746778.png" alt="image-20240809174606994">&lt;/p>
&lt;h2 id="webhook">WebHook&lt;/h2>
&lt;p>ä½¿ç”¨çš„åœºæ™¯,Github Pushä»£ç ä¹‹å,è‡ªåŠ¨æ„å»º&lt;/p>
&lt;p>ç¬¬ä¸€æ­¥.jenkinsçš„é…ç½®&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202408091740783.png" alt="image-20240809174000506">&lt;/p>
&lt;p>ç¬¬äºŒæ­¥.Githubçš„é…ç½®&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202408091741395.png" alt="image-20240809174111087">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202408091742218.png" alt="image-20240809174235801">&lt;/p>
&lt;p>ç¬¬ä¸‰æ­¥.è¿”å›jenkinsè®¾ç½®&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202408091743820.png" alt="image-20240809174324197">&lt;/p>
&lt;p>ç¬¬å››æ­¥.pushä»£ç ,æŸ¥çœ‹æœ‰æ²¡æœ‰æ­£å¸¸æ„å»º&lt;/p>
&lt;h1 id="jenkinsdockeréƒ¨ç½²mavenèšåˆå·¥ç¨‹">Jenkins+Dockeréƒ¨ç½²Mavenèšåˆå·¥ç¨‹&lt;/h1>
&lt;p>å®‰è£…Jenkins&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>docker run &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /var/run/docker.sock:/var/run/docker.sock &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v &lt;span style="color:#66d9ef">$(&lt;/span>which docker&lt;span style="color:#66d9ef">)&lt;/span>:/usr/bin/docker &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /root/jenkins:/var/jenkins_home &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --name jenkins &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --user&lt;span style="color:#f92672">=&lt;/span>root &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -p 8080:8080 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -p 50000:50000 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -d &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -u &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> jenkins/jenkins:jdk11
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>ç¬¬2è¡Œæ˜¯å°†å®¿ä¸»æœºçš„/var/run/docker.sockæ˜ å°„åˆ°å®¹å™¨ä¸­ï¼Œè¿™æ ·åœ¨å®¹å™¨ä¸­è¿è¡Œçš„dockerå‘½ä»¤ï¼Œå°±ä¼šåœ¨å®¿ä¸»æœºä¸Šæ¥æ‰§è¡Œã€‚&lt;/li>
&lt;li>ç¬¬3è¡Œæ˜¯å°†å®¿ä¸»æœºçš„dockerç¨‹åºæ˜ å°„è¿›å®¹å™¨ä¸­ï¼Œè¿™æ ·æœ¬èº«æ²¡æœ‰å®‰è£…dockerçš„jenkinså®¹å™¨å°±å¯ä»¥æ‰§è¡Œdockerå‘½ä»¤äº†ï¼ˆäº‹å®ä¸Šå®¹å™¨é‡Œæ˜¯æ²¡æœ‰è¿è¡Œdockerçš„æœåŠ¡çš„ï¼Œæˆ‘ä»¬åªæ˜¯ç”¨è¿™ä¸ªæ˜ å°„è¿›å®¹å™¨çš„dockeræ¥ä½œä¸ºå®¢æˆ·ç«¯å‘é€dockerçš„æŒ‡ä»¤åˆ°/var/run/docker.sockè€Œå·²ï¼Œè€Œ/var/run/docker.sockå·²ç»è¢«é“¾æ¥åˆ°å®¿ä¸»æœºäº†)&lt;/li>
&lt;/ul>
&lt;p>Dockerfile&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-dockerfile" data-lang="dockerfile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">FROM&lt;/span>&lt;span style="color:#e6db74"> openjdk:8-jdk-alpine&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">VOLUME&lt;/span>&lt;span style="color:#e6db74"> /tmp&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">ADD&lt;/span> admin-server-0.0.1-SNAPSHOT.jar app.jar&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">ENTRYPOINT&lt;/span> [&lt;span style="color:#e6db74">&amp;#34;java&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;-Djava.security.egd=file:/dev/./urandom&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;-jar&amp;#34;&lt;/span>,&lt;span style="color:#e6db74">&amp;#34;/app.jar&amp;#34;&lt;/span>]&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Mavençš„pom.xmlé…ç½®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;plugin&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;groupId&amp;gt;&lt;/span>com.spotify&lt;span style="color:#f92672">&amp;lt;/groupId&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;artifactId&amp;gt;&lt;/span>docker-maven-plugin&lt;span style="color:#f92672">&amp;lt;/artifactId&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;version&amp;gt;&lt;/span>0.4.13&lt;span style="color:#f92672">&amp;lt;/version&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;configuration&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;imageName&amp;gt;&lt;/span>springboot/${project.artifactId}&lt;span style="color:#f92672">&amp;lt;/imageName&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;dockerDirectory&amp;gt;&lt;/span>src/main/docker&lt;span style="color:#f92672">&amp;lt;/dockerDirectory&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;resources&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;resource&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;targetPath&amp;gt;&lt;/span>/&lt;span style="color:#f92672">&amp;lt;/targetPath&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;directory&amp;gt;&lt;/span>${project.build.directory}&lt;span style="color:#f92672">&amp;lt;/directory&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;include&amp;gt;&lt;/span>${project.build.finalName}.jar&lt;span style="color:#f92672">&amp;lt;/include&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;/resource&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;/resources&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;/configuration&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">&amp;lt;/plugin&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>imageName&lt;/code>æ‰“çš„é•œåƒåç§°,è¿™é‡Œçš„é•œåƒåç§°æ˜¯:springboot/admin-server&lt;/li>
&lt;li>&lt;code>dockerDirectory&lt;/code>æŒ‡å®šdockeræ–‡ä»¶å¤¹çš„ä½ç½®&lt;/li>
&lt;/ul>
&lt;p>Jobé…ç½®&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051423837.png" alt="">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051424832.png" alt="">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051424206.png" alt="">&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051424089.png" alt="">&lt;/p>
&lt;p>â€¢ &lt;code>-e â€œSPRING_PROFILES_ACTIVE=prereleaseâ€&lt;/code> ,å¯ä»¥çœ‹æˆæ˜¯å¯åŠ¨jarçš„æ—¶å€™çš„,java -jar admin-server.jar â€“spring.profiles.active=prerelease ,æŒ‡å®šè¿è¡Œç¯å¢ƒ&lt;/p>
&lt;h1 id="è„šæœ¬">è„šæœ¬&lt;/h1>
&lt;h2 id="æ£€æµ‹å®¹å™¨çš„è¿è¡Œ">æ£€æµ‹å®¹å™¨çš„è¿è¡Œ&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># &amp;#34;=&amp;#34; ä¸¤è¾¹ä¸èƒ½æœ‰ç©ºæ ¼&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>count&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>docker ps -a | grep sabong-admin-controlfront |awk &lt;span style="color:#e6db74">&amp;#39;{print $1}&amp;#39;&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">[&lt;/span> -n &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$count&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">]&lt;/span>; &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> docker stop $count
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> docker rm $count
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> echo &lt;span style="color:#e6db74">&amp;#34;åœæ­¢å¹¶åˆ é™¤å®¹å™¨&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -itd &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -p 9011:9011 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -e â€œSPRING_PROFILES_ACTIVE&lt;span style="color:#f92672">=&lt;/span>prereleaseâ€ &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --name admin-server &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> springboot/admin-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æ¨é€é•œåƒåˆ°harbor">æ¨é€é•œåƒåˆ°harbor&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ‰“æ ‡ç­¾&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># sabong/sabong-controller-manager:latest å·²ç»buildæˆåŠŸäº†çš„é•œåƒåå­—&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 10.0.0.7/library/sabong/sabong-controller-manager:latest æ–°çš„é•œåƒåå­—&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker tag sabong/sabong-controller-manager:latest 10.0.0.7/library/sabong/sabong-controller-manager:latest
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç™»å½•ç§æœ‰ä»“åº“&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker login -u admin -p &lt;span style="color:#ae81ff">123456&lt;/span> 10.0.0.7
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ¨é€é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker push 10.0.0.7/library/sabong/sabong-controller-manager:latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="vueæ‰“åŒ…æˆé•œåƒ">Vueæ‰“åŒ…æˆé•œåƒ&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>npm install
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npm run build:prod
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># build&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># sabong/sabong-admin-controlfront éšä¾¿èµ·çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker build -t sabong/sabong-admin-controlfront --no-cache .
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ‰“æ ‡ç­¾&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker tag sabong/sabong-admin-controlfront:latest 10.0.0.7/library/sabong/sabong-admin-controlfront:latest
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç™»å½•ç§æœ‰ä»“åº“&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker login -u admin -p &lt;span style="color:#ae81ff">123456&lt;/span> 10.0.0.7
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ¨é€é•œåƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker push 10.0.0.7/library/sabong/sabong-admin-controlfront:latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Dockerfile&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-docker" data-lang="docker">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">From&lt;/span>&lt;span style="color:#e6db74"> nginx&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#66d9ef">COPY&lt;/span> dist/ /usr/share/nginx/html/&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â›” è¿™é‡Œç”¨çš„æ˜¯nginxå®¹å™¨é‡Œé»˜è®¤çš„nginxé…ç½®æ–‡ä»¶,æ‰€ä»¥è¿™é‡Œæ²¡æœ‰ä½¿ç”¨è‡ªå®šä¹‰çš„nginxé…ç½®&lt;/p>
&lt;h2 id="springbooté¡¹ç›®è„šæœ¬">SpringBooté¡¹ç›®è„šæœ¬&lt;/h2>
&lt;p>é€‚ç”¨äºsshä¼ è¾“æ–‡ä»¶,å¯åŠ¨è„šæœ¬&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å…·ä½“ä¸çŸ¥é“æ˜¯å¹²å•¥çš„,åŠ ä¸Šè¿™ä¸ª,è¿™ä¸ªçœ‹æƒ…å†µåŠ &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># BUILD_ID=DONTKILLME&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>APP_NAME&lt;span style="color:#f92672">=&lt;/span>xxx.jar
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ€è¿›ç¨‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pid&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>ps -ef|grep $APP_NAME|grep -v grep|awk &lt;span style="color:#e6db74">&amp;#39;{print $2}&amp;#39;&lt;/span> &lt;span style="color:#e6db74">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">[&lt;/span> -n &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>pid&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">]&lt;/span>; &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> kill -9 $pid
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#39;å‡†å¤‡å¯åŠ¨jaråŒ…&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nohup java -jar /root/$APP_NAME --spring.profiles.active&lt;span style="color:#f92672">=&lt;/span>prod &amp;amp;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sleep &lt;span style="color:#ae81ff">3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo &lt;span style="color:#e6db74">&amp;#39;å¯åŠ¨æˆåŠŸ&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="mavenå¤šæ¨¡å—æ‰“åŒ…">Mavenå¤šæ¨¡å—æ‰“åŒ…&lt;/h1>
&lt;p>æŒ‡å®šæ‰“åŒ…é¡¹ç›®å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>clean package -pl æ¨¡å—å -am
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é…ç½®SSH server&lt;/p>
&lt;p>åœ¨ç³»ç»Ÿç®¡ç†&amp;ndash;&amp;gt;System&amp;mdash;&amp;gt;SSH Serveré…ç½®&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051424215.png" alt="image-20240319175903145">&lt;/p>
&lt;p>é…ç½®SSH Over FTP publish&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051424247.png" alt="image-20240319184601103">&lt;/p>
&lt;p>è¿™é‡Œ&lt;code>Verbose output in console&lt;/code>çš„ä½œç”¨æ˜¯æŠŠè¿œç¨‹çš„æ­¥éª¤,å’Œè¿œç¨‹çš„shellæ‰§è¡Œçš„ç»“æœä¹Ÿæ‰“å°å‡ºæ¥&lt;/p>
&lt;p>è¿™é‡Œ&lt;code>Exec in pty&lt;/code> è¦å‹¾é€‰,ä¸ç„¶é¡¹ç›®å¯åŠ¨å®Œæˆäº†,ä¹Ÿä¸ä¼šåœæ­¢SSHé“¾æ¥&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051424187.png" alt="image-20240319175519104">&lt;/p>
&lt;h1 id="å‰ç«¯æ‰“åŒ…">å‰ç«¯æ‰“åŒ…&lt;/h1>
&lt;p>é€‰æ‹©å·²ç»é…ç½®çš„nodeç‰ˆæœ¬&lt;/p>
&lt;p>&lt;strong>æ„å»ºç¯å¢ƒ&lt;/strong>&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051424037.png" alt="image-20240319183930032">&lt;/p>
&lt;p>&lt;strong>Build Steps&lt;/strong>&lt;/p>
&lt;p>é€‰æ‹©æ‰§è¡Œshell&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>npm install
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>npm run build:prod
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pwd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># åˆ é™¤ä¸Šä¸€æ¬¡æ„å»ºæ‰“çš„åŒ…,ç„¶ådistæ–‡ä»¶å¤¹æ‰“åŒ…æˆdist.zipæ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rm -f dist.zip &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> zip -r dist.zip dist
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://image.runtimes.cc/202404051424098.png" alt="image-20240319184412134">&lt;/p>
&lt;h1 id="å„ç§é—®é¢˜æŠ¥é”™">å„ç§é—®é¢˜æŠ¥é”™&lt;/h1>
&lt;p>1.HTTP ERROR 403 No valid crumb was included in the request&lt;/p>
&lt;p>è§£å†³åŠæ³•:ç½‘ä¸Šéƒ½æ˜¯è¦å»å…³é—­CSRFï¼Œå¾ˆæ˜ç¡®çš„æ˜¯æˆ‘è¿™é‡Œçš„å…¨å±€å®‰å…¨é…ç½®é‡Œé¢æ ¹æœ¬å°±æ²¡æœ‰é€‰é¡¹ï¼Œæˆ‘çš„ç‰ˆæœ¬æ˜¯&lt;code>jenkins 2.293&lt;/code>ã€‚æ‰€ä»¥ç™¾åº¦å‡ºæ¥çš„éƒ½æ˜¯ä¸€å †åƒåœ¾ï¼Œæ— å¥ˆè‡ªå·±è§£å†³ï¼Œå°è¯•ä¸€ç•ªä¹‹åï¼Œæ‰¾åˆ°äº†æ–¹æ³•ï¼Œå¦‚&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051425841.png" alt="image-20231201155420918">&lt;/p>
&lt;p>ä¸‹å›¾æ‰€ç¤ºï¼šè¿˜æ˜¯åœ¨å…¨å±€å®‰å…¨é…ç½®é‡Œé¢ï¼Œå‹¾é€‰ä¸Šè¿™ä¸ªå‚æ•°å³å¯ã€‚&lt;/p>
&lt;hr>
&lt;p>2.Jenkinsé…ç½®ä¸­å®‰è£…æ’ä»¶æ—¶æç¤º&lt;code>No such plugin: cloudbees-folder&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo systemctl start jenkins
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;p>2.Jenkinså’ŒGithub personal access token&lt;/p>
&lt;ul>
&lt;li>ç™»å½•åˆ°æ‚¨çš„ Jenkins æœåŠ¡å™¨ã€‚&lt;/li>
&lt;li>é€‰æ‹©â€œJenkinsâ€&amp;gt;â€œManage Jenkinsâ€&amp;gt;â€œConfigure Systemâ€ã€‚&lt;/li>
&lt;li>æ»šåŠ¨åˆ°â€œGitHubâ€éƒ¨åˆ†ã€‚&lt;/li>
&lt;li>ç‚¹å‡»â€œAdd GitHub Serverâ€æŒ‰é’®ã€‚&lt;/li>
&lt;li>åœ¨â€œAPI URLâ€å­—æ®µä¸­è¾“å…¥æ‚¨çš„ Github API URLï¼ˆä¾‹å¦‚ &lt;a href="https://link.juejin.cn/?target=https%3A%2F%2Fapi.github.com%EF%BC%89%E3%80%82">api.github.comï¼‰ã€‚&lt;/a>&lt;/li>
&lt;li>åœ¨â€œCredentialsâ€å­—æ®µä¸­é€‰æ‹©â€œAddâ€ã€‚&lt;/li>
&lt;li>é€‰æ‹©â€œKindâ€ä¸ºâ€œUsername with passwordâ€ã€‚&lt;/li>
&lt;li>åœ¨â€œUsernameâ€å­—æ®µä¸­è¾“å…¥æ‚¨çš„ Github ç”¨æˆ·åã€‚&lt;/li>
&lt;li>åœ¨â€œPasswordâ€å­—æ®µä¸­è¾“å…¥æ‚¨çš„ Github ä¸ªäººè®¿é—®ä»¤ç‰Œã€‚&lt;/li>
&lt;li>ç‚¹å‡»â€œVerify credentialsâ€æŒ‰é’®ä»¥éªŒè¯å‡­æ®æ˜¯å¦æœ‰æ•ˆã€‚&lt;/li>
&lt;li>å¦‚æœéªŒè¯æˆåŠŸï¼Œè¯·ç‚¹å‡»â€œSaveâ€æŒ‰é’®ä¿å­˜æ›´æ”¹ã€‚&lt;/li>
&lt;/ul>
&lt;p>3.jenkinsæ˜ å°„docker&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¦‚æœdocker run jenkins æ²¡æœ‰æŒ‡å®š&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¿™é‡Œå°±ä¸èƒ½æ‰“åŒ…,å°±æ˜¯å› ä¸ºåœ¨jenkinsé‡Œçš„å®¹å™¨ä¸­,æ²¡æœ‰å®‰è£…å¯¹è±¡,ä½¿ç”¨äº†-v &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å°±æ˜¯æŠŠjenkinsé‡Œæ‰€éœ€è¦çš„dockeræ˜ å°„åˆ°å®¿ä¸»dockerä¸­&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>-v /var/run/docker.sock:/var/run/docker.sock &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span>-v &lt;span style="color:#66d9ef">$(&lt;/span>which docker&lt;span style="color:#66d9ef">)&lt;/span>:/usr/bin/docker
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>4.å®‰è£…æ’ä»¶æ²¡æœ‰æˆåŠŸ&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051425983.png" alt="">
éœ€è¦åˆ°æ’ä»¶ä¸­å¿ƒ,åœ¨å¯æ›´æ–°å’Œå¯é€‰æ’ä»¶é‡Œ,ä¸€ä¸ªä¸€ä¸ªæ‰‹åŠ¨å»æœç´¢å®‰è£…,å¦‚æœè¿˜æœ‰é—®é¢˜,å°±éœ€è¦æ›´æ–°jenkins&lt;/p>
&lt;p>5.&lt;code>npm install&lt;/code>éœ€è¦æƒé™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>Unable to save binary /var/lib/jenkins/workspace/mymanager-/node_modules/node-sass/vendor/linux-x64-83 : Error: EACCES: permission denied, mkdir &lt;span style="color:#e6db74">&amp;#39;/var/lib/jenkins/workspace/lottery-web-24kai-ausk3/node_modules/node-sass/vendor&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="ä¿®æ”¹ç«¯å£">ä¿®æ”¹ç«¯å£&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç¬¬ä¸€æ­¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo vim /etc/init.d/jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 8088æ”¹æˆæƒ³è¦çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>check_tcp_port &lt;span style="color:#e6db74">&amp;#34;http&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$HTTP_PORT&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;8088&amp;#34;&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç¬¬äºŒæ­¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo vim /etc/default/jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 8088æ”¹æˆæƒ³è¦çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>HTTP_PORT&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">8088&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç¬¬ä¸‰æ­¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vim /lib/systemd/system/jenkins.service
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Environment&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;JENKINS_PORT=80&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ‰§è¡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl daemon-reload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl start jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl status jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¿™ä¸ªæ—¶å€™å°±å¯åŠ¨æŠ¥é”™,ç„¶åæ¥ç€ä¿®æ”¹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vim /lib/systemd/system/jenkins.service
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æœ¬æ¥æ˜¯jenkinsçš„,æ”¹æˆroot&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>User&lt;span style="color:#f92672">=&lt;/span>root
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Group&lt;span style="color:#f92672">=&lt;/span>root
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ‰§è¡Œ,å°±å¯ä»¥äº†,ä¸çŸ¥é“ä¸ºå•¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl daemon-reload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl start jenkins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo systemctl status jenkins
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="jenkinsä½¿ç”¨rootè´¦å·ç™»å½•">jenkinsä½¿ç”¨rootè´¦å·ç™»å½•&lt;/h1>
&lt;p>&lt;a href="https://www.baimeidashu.com/13094.html">è®¾ç½®1&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.cnblogs.com/fieldtianye/p/17852160.html">è®¾ç½®2&lt;/a>&lt;/p>
&lt;h1 id="æƒé™ç®¡ç†">æƒé™ç®¡ç†&lt;/h1>
&lt;p>1.å®‰è£…æ’ä»¶,&lt;code>Role-based Authorization Strategy&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202408081650831.png" alt="image-20240808165032732">&lt;/p>
&lt;p>2.ç‚¹å‡» ç®¡ç†ç³»ç»Ÿ&amp;ndash;&amp;gt;å®‰å…¨æ®µè½ä¸‹çš„&amp;ndash;&amp;gt;å…¨å±€å®‰å…¨é…ç½®,é€‰ä¸­&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202408081652851.png" alt="image-20240808165220186">&lt;/p>
&lt;p>3.ç®¡ç†ç³»ç»Ÿ&amp;ndash;&amp;gt;å®‰å…¨æ®µè½ä¸‹çš„ å°±ä¼šå¤šä¸€ä¸ªåŠŸèƒ½&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202408081653465.png" alt="image-20240808165321957">&lt;/p></content></item><item><title>Mac</title><link>https://connorzhangyu.com/posts/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/mac/</link><pubDate>Sat, 19 Nov 2022 18:25:00 +0000</pubDate><guid>https://connorzhangyu.com/posts/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/mac/</guid><description>&lt;h1 id="å¿«æ·é”®">å¿«æ·é”®&lt;/h1>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>æè¿°&lt;/th>
&lt;th>å‘½ä»¤&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>ä¸€ä¸ªåº”ç”¨å¤šä¸ªçª—å£ åˆ‡æ¢&lt;/td>
&lt;td>command+`&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>å½•å±å¹•&lt;/td>
&lt;td>shift+command+5&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æˆªå›¾&lt;/td>
&lt;td>shift+command+4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>é‡è£…ç³»ç»Ÿ&lt;/td>
&lt;td>å…ˆä¸€ç›´æŒ‰ä½ä¸è¦æ¾æ‰‹:Common+R,&lt;br />å†æŒ‰å¼€æœºé”®;éè‹¹æœé”®ç›˜,æŒ‰ä½å¾®è½¯é”®+R&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ä¸Šä¸€çº§ç›®å½•&lt;/td>
&lt;td>command+â†‘&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h1 id="ç½‘ç«™é“¾æ¥">ç½‘ç«™é“¾æ¥&lt;/h1>
&lt;ul>
&lt;li>&lt;a href="https://www.iplaysoft.com/fix-chrome-slow.html">ä¸€æ‹›è§£å†³ Chrome / Edge æµè§ˆå™¨å¡é¡¿å˜æ…¢è§†é¢‘æ‰å¸§é—®é¢˜ - è®©æµè§ˆå™¨é‡å›ä¸èˆ¬æµç•…&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://alt-tab-macos.netlify.app/">AltTab&lt;/a>&lt;/li>
&lt;/ul>
&lt;h1 id="iphoneå¼ºåˆ¶é‡å¯">iphoneå¼ºåˆ¶é‡å¯&lt;/h1>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051349933.webp" alt="">&lt;/p>
&lt;h1 id="æµè§ˆå™¨è¿”å›æ‰‹åŠ¿">æµè§ˆå™¨è¿”å›æ‰‹åŠ¿&lt;/h1>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051350113.png" alt="">&lt;/p>
&lt;h1 id="æ”¾æ­Œæœ‰å™ªéŸ³">æ”¾æ­Œæœ‰å™ªéŸ³&lt;/h1>
&lt;p>é€šè¿‡ã€æ´»åŠ¨ç›‘è§†å™¨ã€‘ç¨‹åºç»ˆæ­¢ã€coreaudiodã€‘è¿›ç¨‹ï¼š&lt;/p>
&lt;ol>
&lt;li>èšç„¦æœç´¢ã€‘ä¸­è¾“å…¥ã€activity monitorã€‘&lt;/li>
&lt;li>åœ¨çª—å£å³ä¸Šè§’çš„æœç´¢æ é‡Œè¾“å…¥ã€coreaudiodã€‘&lt;/li>
&lt;li>é€‰æ‹©ã€coreaudiodã€‘è¿›ç¨‹åï¼Œç‚¹å‡»çª—å£ä¸Šæ–¹å·¥å…·æ ä¸­çš„ã€åœæ­¢æŒ‰é’®ã€‘ï¼ˆæŒ‰é’®å›¾æ ‡ä¸ºXï¼‰&lt;/li>
&lt;/ol>
&lt;h1 id="åªæœ‰macä¸èƒ½è®¿é—®github">åªæœ‰macä¸èƒ½è®¿é—®github&lt;/h1>
&lt;ol>
&lt;li>
&lt;p>æ‰“å¼€&lt;code>https://github.com.ipaddress.com/&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ‰“å¼€&lt;code>https://fastly.net.ipaddress.com/github.global.ssl.fastly.net#ipinfo&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>sudo vim /etc/hosts&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Shell" data-lang="Shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¿™ä¸ªipä»ç¬¬ä¸€æ­¥è·å–åˆ°çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>140.82.112.4 github.com
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¿™ä¸ªipä»ç¬¬äºŒæ­¥è·å–åˆ°çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>199.232.69.194 github.global.ssl.fastly.net
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>åˆ·æ–°:&lt;code>sudo killall -HUP mDNSResponder;say DNS cache has been flushed&lt;/code>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h1 id="å¯åŠ¨å°æœ‰é—®å·çš„å›¾æ ‡ç‚¹å‡»æ²¡ååº”">å¯åŠ¨å°æœ‰é—®å·çš„å›¾æ ‡,ç‚¹å‡»æ²¡ååº”&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ‰§è¡Œäº†ä¹‹å,è‡ªå·±æ–°å»ºçš„æ–‡ä»¶å¤¹ä¼šé‡ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>defaults write com.apple.dock ResetLaunchPad -bool TRUE
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>killall Dock
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="mac-os-x-è®¿é—®-windowså…±äº«æ–‡ä»¶å¤¹">Mac OS X è®¿é—® Windowså…±äº«æ–‡ä»¶å¤¹&lt;/h1>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051351999.png" alt="">&lt;/p></description><content>&lt;h1 id="å¿«æ·é”®">å¿«æ·é”®&lt;/h1>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>æè¿°&lt;/th>
&lt;th>å‘½ä»¤&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>ä¸€ä¸ªåº”ç”¨å¤šä¸ªçª—å£ åˆ‡æ¢&lt;/td>
&lt;td>command+`&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>å½•å±å¹•&lt;/td>
&lt;td>shift+command+5&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æˆªå›¾&lt;/td>
&lt;td>shift+command+4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>é‡è£…ç³»ç»Ÿ&lt;/td>
&lt;td>å…ˆä¸€ç›´æŒ‰ä½ä¸è¦æ¾æ‰‹:Common+R,&lt;br />å†æŒ‰å¼€æœºé”®;éè‹¹æœé”®ç›˜,æŒ‰ä½å¾®è½¯é”®+R&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ä¸Šä¸€çº§ç›®å½•&lt;/td>
&lt;td>command+â†‘&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h1 id="ç½‘ç«™é“¾æ¥">ç½‘ç«™é“¾æ¥&lt;/h1>
&lt;ul>
&lt;li>&lt;a href="https://www.iplaysoft.com/fix-chrome-slow.html">ä¸€æ‹›è§£å†³ Chrome / Edge æµè§ˆå™¨å¡é¡¿å˜æ…¢è§†é¢‘æ‰å¸§é—®é¢˜ - è®©æµè§ˆå™¨é‡å›ä¸èˆ¬æµç•…&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://alt-tab-macos.netlify.app/">AltTab&lt;/a>&lt;/li>
&lt;/ul>
&lt;h1 id="iphoneå¼ºåˆ¶é‡å¯">iphoneå¼ºåˆ¶é‡å¯&lt;/h1>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051349933.webp" alt="">&lt;/p>
&lt;h1 id="æµè§ˆå™¨è¿”å›æ‰‹åŠ¿">æµè§ˆå™¨è¿”å›æ‰‹åŠ¿&lt;/h1>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051350113.png" alt="">&lt;/p>
&lt;h1 id="æ”¾æ­Œæœ‰å™ªéŸ³">æ”¾æ­Œæœ‰å™ªéŸ³&lt;/h1>
&lt;p>é€šè¿‡ã€æ´»åŠ¨ç›‘è§†å™¨ã€‘ç¨‹åºç»ˆæ­¢ã€coreaudiodã€‘è¿›ç¨‹ï¼š&lt;/p>
&lt;ol>
&lt;li>èšç„¦æœç´¢ã€‘ä¸­è¾“å…¥ã€activity monitorã€‘&lt;/li>
&lt;li>åœ¨çª—å£å³ä¸Šè§’çš„æœç´¢æ é‡Œè¾“å…¥ã€coreaudiodã€‘&lt;/li>
&lt;li>é€‰æ‹©ã€coreaudiodã€‘è¿›ç¨‹åï¼Œç‚¹å‡»çª—å£ä¸Šæ–¹å·¥å…·æ ä¸­çš„ã€åœæ­¢æŒ‰é’®ã€‘ï¼ˆæŒ‰é’®å›¾æ ‡ä¸ºXï¼‰&lt;/li>
&lt;/ol>
&lt;h1 id="åªæœ‰macä¸èƒ½è®¿é—®github">åªæœ‰macä¸èƒ½è®¿é—®github&lt;/h1>
&lt;ol>
&lt;li>
&lt;p>æ‰“å¼€&lt;code>https://github.com.ipaddress.com/&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ‰“å¼€&lt;code>https://fastly.net.ipaddress.com/github.global.ssl.fastly.net#ipinfo&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>sudo vim /etc/hosts&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Shell" data-lang="Shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¿™ä¸ªipä»ç¬¬ä¸€æ­¥è·å–åˆ°çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>140.82.112.4 github.com
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¿™ä¸ªipä»ç¬¬äºŒæ­¥è·å–åˆ°çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>199.232.69.194 github.global.ssl.fastly.net
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>åˆ·æ–°:&lt;code>sudo killall -HUP mDNSResponder;say DNS cache has been flushed&lt;/code>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h1 id="å¯åŠ¨å°æœ‰é—®å·çš„å›¾æ ‡ç‚¹å‡»æ²¡ååº”">å¯åŠ¨å°æœ‰é—®å·çš„å›¾æ ‡,ç‚¹å‡»æ²¡ååº”&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ‰§è¡Œäº†ä¹‹å,è‡ªå·±æ–°å»ºçš„æ–‡ä»¶å¤¹ä¼šé‡ç½®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>defaults write com.apple.dock ResetLaunchPad -bool TRUE
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>killall Dock
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="mac-os-x-è®¿é—®-windowså…±äº«æ–‡ä»¶å¤¹">Mac OS X è®¿é—® Windowså…±äº«æ–‡ä»¶å¤¹&lt;/h1>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051351999.png" alt="">&lt;/p>
&lt;p>åœ¨Macä¸­ï¼Œç‚¹å‡» Finderèœå•çš„â€œå‰å¾€â€ &amp;gt; â€œå‰å¾€æœåŠ¡å™¨â€ã€‚åœ¨å¼¹å‡ºçš„è¿æ¥æœåŠ¡å™¨å¯¹è¯æ¡†ä¸­è¾“å…¥ã€Œsmb://Windowsä¸»æœºçš„IPåœ°å€ã€ï¼Œç‚¹å‡»â€œè¿æ¥â€ã€‚&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051352087.png" alt="">&lt;/p>
&lt;p>ä¸€èˆ¬éœ€è¦è¾“å…¥Windowså¯¹åº”ç”¨æˆ·çš„åç§°å’Œå¯†ç ï¼Œç„¶åå¼¹å‡ºå¦‚ä¸‹çª—å£ï¼Œé€‰æ‹©å¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œç‚¹å‡»â€œå¥½â€å³å¯è¿›è¡Œè¿œç¨‹è®¿é—®&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051352069.png" alt="">&lt;/p>
&lt;h1 id="åªä½¿ç”¨æœç‹—è¾“å…¥æ³•">åªä½¿ç”¨æœç‹—è¾“å…¥æ³•&lt;/h1>
&lt;p>ç³»ç»Ÿåå¥½è®¾ç½® &amp;raquo; é”®ç›˜ &amp;raquo; å¿«æ·é”® &amp;raquo; åé€‰åˆ‡æ¢è¾“å…¥æ³•çš„å¿«æ·é”®&lt;/p>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051353563.png" alt="ç¤ºä¾‹å›¾ç‰‡">&lt;/p>
&lt;h1 id="ç½‘ç»œè¸ªè¿¹">ç½‘ç»œè¸ªè¿¹&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>traceroute ap-southeast-1.signin.aws.amazon.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="å®‰è£…mysqlå®¢æˆ·ç«¯">å®‰è£…mysqlå®¢æˆ·ç«¯&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew install mysql-client
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å®‰è£…ç›®å½•åœ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/Cellar/mysql-client/8.0.33_1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># mysqldumpçš„ç›®å½•&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/opt/mysql-client/bin/mysqldump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="iterm2">Iterm2&lt;/h1>
&lt;h2 id="iterm2å¤šçª—å£åŒæ—¶è¾“å…¥å‘½ä»¤">Iterm2å¤šçª—å£åŒæ—¶è¾“å…¥å‘½ä»¤&lt;/h2>
&lt;p>&lt;code>åªéœ€è¦è¾“å…¥å¿«æ·é”® âŒ˜(command) + â‡§(shift) + i&lt;/code>&lt;/p>
&lt;h2 id="è°ƒå‡ºå¤åˆ¶è¿‡çš„æ–‡æœ¬å†å²">è°ƒå‡ºå¤åˆ¶è¿‡çš„æ–‡æœ¬å†å²&lt;/h2>
&lt;p>å¿«æ·é”®ï¼šâ€œshift+cmd+hâ€&lt;/p>
&lt;h2 id="æŒ‰é”®å›æ”¾">æŒ‰é”®å›æ”¾&lt;/h2>
&lt;p>å›æ”¾ä¸€æ®µæ—¶é—´å†…çš„ä½ æ•²è¿‡çš„æ‰€æœ‰å­—ç¬¦ã€‚
å¿«æ·é”®ï¼šâ€œcmd+alt+bâ€ï¼Œå¦‚å›¾ä¼šå¼¹å‡ºä¸€ä¸ªè¿›åº¦æ¡ï¼ŒæŒ‰å·¦å³é”®å°±å¯ä»¥å®ç°æŒ‰é”®å›æ”¾äº†ã€‚&lt;/p>
&lt;h1 id="cheatsheet">CheatSheet&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew install cheatsheet
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä½¿ç”¨&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>éšä¾¿åœ¨ä¸€ä¸ªè½¯ä»¶ä¸­ é•¿æŒ‰&lt;span style="color:#e6db74">`&lt;/span>command&lt;span style="color:#e6db74">`&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="navicatç ´è§£">Navicatç ´è§£&lt;/h1>
&lt;p>&lt;a href="https://gitee.com/ProgHub/unlimited_trial_navicat_premium">giteeè„šæœ¬&lt;/a>&lt;/p>
&lt;h1 id="macå®‰è£…-protobuf">macå®‰è£… protobuf&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew install protobuf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>protoc --version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/opt/homebrew/share/emacs/site-lisp/protobuf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="è§†é¢‘æ ¼å¼è½¬æ¢">è§†é¢‘æ ¼å¼è½¬æ¢&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>brew install ffmpeg
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä½¿ç”¨è¿™ä¸ªå‘½ä»¤&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ffmpeg -i input.mov -c copy output.mp4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¸è¦ç”¨è¿™ä¸ªå‘½ä»¤,ç½‘ä¸Šè¯´æ˜¯é€Ÿåº¦å¾ˆæ…¢&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ffmpeg -i input.mov output.mp4
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></content></item><item><title>Nginx</title><link>https://connorzhangyu.com/posts/nginx/</link><pubDate>Sat, 19 Nov 2022 18:25:00 +0000</pubDate><guid>https://connorzhangyu.com/posts/nginx/</guid><description>&lt;h2 id="dockerå®‰è£…-nginx">Dockerå®‰è£… Nginx&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç®€å•çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run --name nginx-test &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -p 8080:80 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -d &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ­£å¼çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run -d &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -p 443:443 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -p 80:80 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --name nginx &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /home/nginx/www:/usr/share/nginx/html &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /home/nginx/conf/nginx.conf:/etc/nginx/nginx.conf &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /home/nginx/logs:/var/log/nginx &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ubuntuå®‰è£…nginx">Ubuntuå®‰è£…Nginx&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Ubuntuå®‰è£…ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get install libpcre3 libpcre3-dev openssl libssl-dev zlib1g-dev
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Ubuntu å¦‚æœè¿˜ç¼ºå°‘ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>apt-get install build-essential
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Centoså®‰è£…ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>yum install -y gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¿›å…¥åˆ°è§£å‹çš„æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd ./nginx-1.16
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./configure --prefix&lt;span style="color:#f92672">=&lt;/span>/url/local/nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#æˆ–è€…&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./configure
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¦‚æœéœ€è¦æŒ‡å®šæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./configure --add-module&lt;span style="color:#f92672">=&lt;/span>../nginx-rtmp-module
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#ç„¶åç›®å½•ä¸‹å°±å¤šäº†ä¸€ä¸ªnginxæ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>make &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> make install
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#å¯åŠ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd ../nginx/sbin
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é…ç½®æ–‡ä»¶ç›®å½•&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>æ‰€æœ‰çš„é…ç½®æ–‡ä»¶éƒ½åœ¨/etc/nginxä¸‹ï¼Œå¹¶ä¸”æ¯ä¸ªè™šæ‹Ÿä¸»æœºå·²ç»å®‰æ’åœ¨äº†/etc/nginx/sites-availableä¸‹
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ç¨‹åºæ–‡ä»¶åœ¨/usr/sbin/nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>æ—¥å¿—æ”¾åœ¨äº†/var/log/nginxä¸­
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>å¹¶å·²ç»åœ¨/etc/init.d/ä¸‹åˆ›å»ºäº†å¯åŠ¨è„šæœ¬nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>é»˜è®¤çš„è™šæ‹Ÿä¸»æœºçš„ç›®å½•è®¾ç½®åœ¨äº†/var/www/nginx-default &lt;span style="color:#f92672">(&lt;/span>æœ‰çš„ç‰ˆæœ¬ é»˜è®¤çš„è™šæ‹Ÿä¸»æœºçš„ç›®å½•è®¾ç½®åœ¨äº†/var/www, è¯·å‚è€ƒ/etc/nginx/sites-availableé‡Œçš„é…ç½®&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="nginx-å¸¸ç”¨å‘½ä»¤">Nginx å¸¸ç”¨å‘½ä»¤&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¯åŠ¨nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>start nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æˆ–è€…&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¿®æ”¹é…ç½®åé‡æ–°åŠ è½½ç”Ÿæ•ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -s reload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -s reopen
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æµ‹è¯•nginxé…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -t -c /path/to/nginx.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¿«é€Ÿåœæ­¢nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -s stop
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å®Œæ•´æœ‰åºçš„åœæ­¢nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -s quit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -c /home/anthony/nginx.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="nginx-é…ç½®æ¨¡æ¿">Nginx é…ç½®æ¨¡æ¿&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#user nobody;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è®¾ç½® &amp;lt;= cpuæ ¸æ•°,ä¸€èˆ¬è®¾ç½®æˆcpu*æ ¸æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">worker_processes 1;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®šé”™è¯¯æ—¥å¿—æ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼Œé”™è¯¯æ—¥å¿—çº§åˆ«å¯é€‰é¡¹ä¸ºã€debug|info|notice|warn|error|critã€‘&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">error_log logs/warn.log warn;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®špidå­˜æ”¾è·¯å¾„ nginxå¯åŠ¨åçš„è¿›ç¨‹ID&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">pid logs/nginx.pid;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å·¥ä½œæ¨¡å¼åŠè¿æ¥æ•°ä¸Šé™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#user nobody;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è®¾ç½® &amp;lt;= cpuæ ¸æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">worker_processes 1;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®šé”™è¯¯æ—¥å¿—æ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼Œé”™è¯¯æ—¥å¿—çº§åˆ«å¯é€‰é¡¹ä¸ºã€debug|info|notice|warn|error|critã€‘&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># error_log logs/error.log error;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®špidå­˜æ”¾è·¯å¾„ nginxå¯åŠ¨åçš„è¿›ç¨‹ID&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># pid logs/nginx.pid;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å·¥ä½œæ¨¡å¼åŠè¿æ¥æ•°ä¸Šé™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">events {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ä½¿ç”¨ç½‘ç»œI/Oæ¨¡å‹ï¼ŒLinuxç³»ç»Ÿæ¨èä½¿ç”¨epollæ¨¡å‹ï¼ŒFreeBSDç³»ç»Ÿæ¨èä½¿ç”¨kqueue;windowä¸‹ä¸æŒ‡å®š&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># user epoll;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å…è®¸çš„æœ€å¤§è¿æ¥æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">worker_connections 1024;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è®¾å®šhttpæœåŠ¡å™¨ï¼Œåˆ©ç”¨ä»–çš„åå‘ä»£ç†åŠŸèƒ½æä¾›è´Ÿè½½å‡è¡¡æ”¯æŒ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">http {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾å®šmimeç±»å‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">include mime.types;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">default_type application/octet-stream;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾å®šæ—¥å¿—æ ¼å¼&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">log_format main &amp;#39;$remote_addr - $remote_user [$time_local] &amp;#34;$request&amp;#34; &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;$status $body_bytes_sent &amp;#34;$http_referer&amp;#34; &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#34;$http_user_agent&amp;#34; &amp;#34;$http_x_forwarded_for&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_header_buffer_size 1k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">large_client_header_buffers 4 4k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># access_log logs/info.log main;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># # è®¾å®šaccess log&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">send_timeout 3m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">sendfile on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">tcp_nopush on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">tcp_nodelay on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è¿™ä¸ªå‚æ•°è¡¨ç¤ºhttpè¿æ¥è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤æ˜¯65sã€‚è¦æ˜¯ä¸Šä¼ æ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œåœ¨è§„å®šæ—¶é—´å†…æ²¡æœ‰ä¸Šä¼ å®Œæˆï¼Œå°±ä¼šè‡ªåŠ¨æ–­å¼€è¿æ¥ï¼æ‰€ä»¥é€‚å½“è°ƒå¤§è¿™ä¸ªæ—¶é—´ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">keepalive_timeout 0;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">keepalive_timeout 5000;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å¼€å¯gzipæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_min_length 1100;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_buffers 4 8k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/x-httpd-php application/javascript application/json;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">output_buffers 1 32k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">postpone_output 1460;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">server_names_hash_bucket_size 128;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_header_timeout 3m; &lt;/span> &lt;span style="color:#75715e">#è°ƒå¤§ç‚¹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_body_timeout 3m; &lt;/span> &lt;span style="color:#75715e">#è°ƒå¤§ç‚¹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_max_body_size 200m; &lt;/span> &lt;span style="color:#75715e">#ä¸»è¦æ˜¯è¿™ä¸ªå‚æ•°ï¼Œé™åˆ¶äº†ä¸Šä¼ æ–‡ä»¶å¤§å¤§å°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#client_body_buffer_size 1024;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_connect_timeout 300;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_send_timeout 300;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_read_timeout 300;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_buffer_size 64k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_buffers 4 64k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_busy_buffers_size 128k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_temp_file_write_size 128k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_http_version 1.1;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_comp_level 2;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_vary on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#è®¾å®šè™šæ‹Ÿä¸»æœº&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">server {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">listen 80;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">server_name ap.mmzcg.com;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾ç½®urlç¼–ç æ ¼å¼ï¼Œè§£å†³å‚æ•°ä¸­æ–‡ä¹±ç é—®é¢˜&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">charset UTF-8;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾å®šæœ¬è™šæ‹Ÿä¸»æœºçš„è®¿é—®æ—¥å¿—&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># access_log logs/host.access.log main;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å¯¹ &amp;#34;/&amp;#34; å¯ç”¨è´Ÿè½½å‡è¡¡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">location / {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾å®šä»£ç†è®¿é—®åœ°å€&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_pass http://127.0.0.1:30000/;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># é…ç½®SSLè¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_certificate /etc/nginx/conf.d/ssl/STAR.huihuang200.com.crt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_certificate_key /etc/nginx/conf.d/ssl/STAR.huihuang200.com.key;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_session_timeout 5m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_session_cache shared:SSL:10m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_protocols TLSv1 TLSv1.1 TLSv1.2 SSLv2 SSLv3;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_prefer_server_ciphers on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_verify_client off;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è§£å†³ajaxè·¨åŸŸé—®é¢˜&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">add_header &amp;#39;Access-Control-Allow-Origin&amp;#39; &amp;#39;*&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">add_header &amp;#39;Access-Control-Allow-Credentials&amp;#39; &amp;#39;true&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">add_header &amp;#39;Access-Control-Allow-Methods&amp;#39; &amp;#39;GET, POST, OPTIONS&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">add_header &amp;#39;Access-Control-Allow-Headers&amp;#39; &amp;#39;DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ä¿ç•™ç”¨æˆ·çœŸå®ä¿¡æ¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_set_header Host $host:$server_port;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_set_header X-Real-IP $remote_addr;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•ä¸ªæ–‡ä»¶å­—èŠ‚æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_max_body_size 100m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œå¯ä»¥ç†è§£ä¸ºå…ˆä¿å­˜åˆ°æœ¬åœ°å†ä¼ ç»™ç”¨æˆ·&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_body_buffer_size 1280k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå‘èµ·æ¡æ‰‹ç­‰å€™å“åº”è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_connect_timeout 5;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è¿æ¥æˆåŠŸå ç­‰å¾…åç«¯æœåŠ¡å™¨å“åº”æ—¶é—´ å…¶å®å·²è¿›å…¥åç«¯çš„æ’é˜Ÿä¹‹ä¸­ç­‰å€™å¤„ç†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_read_timeout 60;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ä»£ç†è¯·æ±‚ç¼“å­˜åŒº è¿™ä¸ªç¼“å­˜åŒºé—´ä¼šä¿å­˜ç”¨æˆ·çš„å¤´ä¿¡æ¯ä¸€å…±Nginxè¿›è¡Œè§„åˆ™å¤„ç† ä¸€èˆ¬åªè¦èƒ½ä¿å­˜ä¸‹å¤´ä¿¡æ¯å³å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_send_timeout 30;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># åŒä¸Š å‘Šè¯‰Nginxä¿å­˜å•ä¸ªç”¨çš„å‡ ä¸ªBufferæœ€å¤§ç”¨å¤šå¤§ç©ºé—´&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_buffer_size 256k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_buffers 4 256k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å¦‚æœç³»ç»Ÿå¾ˆå¿™çš„æ—¶å€™å¯ä»¥ç”³è¯·å›½å†…å„å¤§çš„proxy_buffers å®˜æ–¹æ¨è *2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_busy_buffers_size 256k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># proxy ç¼“å­˜ä¸´æ—¶æ–‡ä»¶çš„å¤§å°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_temp_file_write_size 256k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_max_temp_file_size 128m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="nginxæ—¥å¿—ç®¡ç†">Nginxæ—¥å¿—ç®¡ç†&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#access_log logs/access.log main;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># nginxçš„é»˜è®¤é…ç½®,å¦‚æœåœ¨å®‰è£…çš„nginxé‡Œæ²¡æœ‰çœ‹åˆ°è¿™ä¸ª,ä¹Ÿæ²¡æœ‰å…³ç³»
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#log_format main &amp;#39;$remote_addr - $remote_user [$time_local] &amp;#34;$request&amp;#34; &amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># &amp;#39;$status $body_bytes_sent &amp;#34;$http_referer&amp;#34; &amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># &amp;#39;&amp;#34;$http_user_agent&amp;#34; &amp;#34;$http_x_forwarded_for&amp;#34;&amp;#39;;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">root&lt;/span> &lt;span style="color:#e6db74">my&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">index&lt;/span> &lt;span style="color:#e6db74">index.html&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#960050;background-color:#1e0010">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#é…ç½®æ—¥å¿—, main å°±æ˜¯log_format åé¢çš„åå­—
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e"># è¯¥serverçš„è®¿é—®æ—¥å¿—çš„æ–‡ä»¶æ˜¯logs/access.log,ä½¿ç”¨çš„æ˜¯mainæ ¼å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#e6db74">access_log&lt;/span> &lt;span style="color:#e6db74">logs/access.log&lt;/span> &lt;span style="color:#e6db74">main&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ¨èçš„é…ç½®&lt;/p></description><content>&lt;h2 id="dockerå®‰è£…-nginx">Dockerå®‰è£… Nginx&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç®€å•çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run --name nginx-test &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -p 8080:80 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -d &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ­£å¼çš„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker run -d &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -p 443:443 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -p 80:80 &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --name nginx &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /home/nginx/www:/usr/share/nginx/html &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /home/nginx/conf/nginx.conf:/etc/nginx/nginx.conf &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -v /home/nginx/logs:/var/log/nginx &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ubuntuå®‰è£…nginx">Ubuntuå®‰è£…Nginx&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Ubuntuå®‰è£…ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt-get install libpcre3 libpcre3-dev openssl libssl-dev zlib1g-dev
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Ubuntu å¦‚æœè¿˜ç¼ºå°‘ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>apt-get install build-essential
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Centoså®‰è£…ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>yum install -y gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¿›å…¥åˆ°è§£å‹çš„æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd ./nginx-1.16
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./configure --prefix&lt;span style="color:#f92672">=&lt;/span>/url/local/nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#æˆ–è€…&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./configure
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¦‚æœéœ€è¦æŒ‡å®šæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./configure --add-module&lt;span style="color:#f92672">=&lt;/span>../nginx-rtmp-module
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#ç„¶åç›®å½•ä¸‹å°±å¤šäº†ä¸€ä¸ªnginxæ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>make &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> make install
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#å¯åŠ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd ../nginx/sbin
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é…ç½®æ–‡ä»¶ç›®å½•&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>æ‰€æœ‰çš„é…ç½®æ–‡ä»¶éƒ½åœ¨/etc/nginxä¸‹ï¼Œå¹¶ä¸”æ¯ä¸ªè™šæ‹Ÿä¸»æœºå·²ç»å®‰æ’åœ¨äº†/etc/nginx/sites-availableä¸‹
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ç¨‹åºæ–‡ä»¶åœ¨/usr/sbin/nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>æ—¥å¿—æ”¾åœ¨äº†/var/log/nginxä¸­
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>å¹¶å·²ç»åœ¨/etc/init.d/ä¸‹åˆ›å»ºäº†å¯åŠ¨è„šæœ¬nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>é»˜è®¤çš„è™šæ‹Ÿä¸»æœºçš„ç›®å½•è®¾ç½®åœ¨äº†/var/www/nginx-default &lt;span style="color:#f92672">(&lt;/span>æœ‰çš„ç‰ˆæœ¬ é»˜è®¤çš„è™šæ‹Ÿä¸»æœºçš„ç›®å½•è®¾ç½®åœ¨äº†/var/www, è¯·å‚è€ƒ/etc/nginx/sites-availableé‡Œçš„é…ç½®&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="nginx-å¸¸ç”¨å‘½ä»¤">Nginx å¸¸ç”¨å‘½ä»¤&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¯åŠ¨nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>start nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æˆ–è€…&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¿®æ”¹é…ç½®åé‡æ–°åŠ è½½ç”Ÿæ•ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -s reload
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -s reopen
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æµ‹è¯•nginxé…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -t -c /path/to/nginx.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¿«é€Ÿåœæ­¢nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -s stop
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å®Œæ•´æœ‰åºçš„åœæ­¢nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -s quit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nginx -c /home/anthony/nginx.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="nginx-é…ç½®æ¨¡æ¿">Nginx é…ç½®æ¨¡æ¿&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#user nobody;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è®¾ç½® &amp;lt;= cpuæ ¸æ•°,ä¸€èˆ¬è®¾ç½®æˆcpu*æ ¸æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">worker_processes 1;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®šé”™è¯¯æ—¥å¿—æ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼Œé”™è¯¯æ—¥å¿—çº§åˆ«å¯é€‰é¡¹ä¸ºã€debug|info|notice|warn|error|critã€‘&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">error_log logs/warn.log warn;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®špidå­˜æ”¾è·¯å¾„ nginxå¯åŠ¨åçš„è¿›ç¨‹ID&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">pid logs/nginx.pid;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å·¥ä½œæ¨¡å¼åŠè¿æ¥æ•°ä¸Šé™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#user nobody;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è®¾ç½® &amp;lt;= cpuæ ¸æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">worker_processes 1;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®šé”™è¯¯æ—¥å¿—æ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼Œé”™è¯¯æ—¥å¿—çº§åˆ«å¯é€‰é¡¹ä¸ºã€debug|info|notice|warn|error|critã€‘&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># error_log logs/error.log error;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŒ‡å®špidå­˜æ”¾è·¯å¾„ nginxå¯åŠ¨åçš„è¿›ç¨‹ID&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># pid logs/nginx.pid;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å·¥ä½œæ¨¡å¼åŠè¿æ¥æ•°ä¸Šé™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">events {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ä½¿ç”¨ç½‘ç»œI/Oæ¨¡å‹ï¼ŒLinuxç³»ç»Ÿæ¨èä½¿ç”¨epollæ¨¡å‹ï¼ŒFreeBSDç³»ç»Ÿæ¨èä½¿ç”¨kqueue;windowä¸‹ä¸æŒ‡å®š&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># user epoll;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å…è®¸çš„æœ€å¤§è¿æ¥æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">worker_connections 1024;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è®¾å®šhttpæœåŠ¡å™¨ï¼Œåˆ©ç”¨ä»–çš„åå‘ä»£ç†åŠŸèƒ½æä¾›è´Ÿè½½å‡è¡¡æ”¯æŒ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">http {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾å®šmimeç±»å‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">include mime.types;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">default_type application/octet-stream;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾å®šæ—¥å¿—æ ¼å¼&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">log_format main &amp;#39;$remote_addr - $remote_user [$time_local] &amp;#34;$request&amp;#34; &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;$status $body_bytes_sent &amp;#34;$http_referer&amp;#34; &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#34;$http_user_agent&amp;#34; &amp;#34;$http_x_forwarded_for&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#ae81ff">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_header_buffer_size 1k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">large_client_header_buffers 4 4k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># access_log logs/info.log main;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># # è®¾å®šaccess log&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">send_timeout 3m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">sendfile on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">tcp_nopush on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">tcp_nodelay on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è¿™ä¸ªå‚æ•°è¡¨ç¤ºhttpè¿æ¥è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤æ˜¯65sã€‚è¦æ˜¯ä¸Šä¼ æ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œåœ¨è§„å®šæ—¶é—´å†…æ²¡æœ‰ä¸Šä¼ å®Œæˆï¼Œå°±ä¼šè‡ªåŠ¨æ–­å¼€è¿æ¥ï¼æ‰€ä»¥é€‚å½“è°ƒå¤§è¿™ä¸ªæ—¶é—´ã€‚&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">keepalive_timeout 0;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">keepalive_timeout 5000;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å¼€å¯gzipæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_min_length 1100;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_buffers 4 8k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_types text/plain application/x-javascript text/css application/xml text/javascript application/x-httpd-php application/javascript application/json;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">output_buffers 1 32k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">postpone_output 1460;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">server_names_hash_bucket_size 128;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_header_timeout 3m; &lt;/span> &lt;span style="color:#75715e">#è°ƒå¤§ç‚¹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_body_timeout 3m; &lt;/span> &lt;span style="color:#75715e">#è°ƒå¤§ç‚¹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_max_body_size 200m; &lt;/span> &lt;span style="color:#75715e">#ä¸»è¦æ˜¯è¿™ä¸ªå‚æ•°ï¼Œé™åˆ¶äº†ä¸Šä¼ æ–‡ä»¶å¤§å¤§å°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#client_body_buffer_size 1024;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_connect_timeout 300;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_send_timeout 300;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_read_timeout 300;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_buffer_size 64k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_buffers 4 64k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_busy_buffers_size 128k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">fastcgi_temp_file_write_size 128k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_http_version 1.1;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_comp_level 2;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">gzip_vary on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#è®¾å®šè™šæ‹Ÿä¸»æœº&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">server {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">listen 80;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">server_name ap.mmzcg.com;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾ç½®urlç¼–ç æ ¼å¼ï¼Œè§£å†³å‚æ•°ä¸­æ–‡ä¹±ç é—®é¢˜&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">charset UTF-8;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾å®šæœ¬è™šæ‹Ÿä¸»æœºçš„è®¿é—®æ—¥å¿—&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># access_log logs/host.access.log main;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å¯¹ &amp;#34;/&amp;#34; å¯ç”¨è´Ÿè½½å‡è¡¡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">location / {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾å®šä»£ç†è®¿é—®åœ°å€&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_pass http://127.0.0.1:30000/;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># é…ç½®SSLè¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_certificate /etc/nginx/conf.d/ssl/STAR.huihuang200.com.crt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_certificate_key /etc/nginx/conf.d/ssl/STAR.huihuang200.com.key;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_session_timeout 5m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_session_cache shared:SSL:10m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_protocols TLSv1 TLSv1.1 TLSv1.2 SSLv2 SSLv3;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_prefer_server_ciphers on;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ssl_verify_client off;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è§£å†³ajaxè·¨åŸŸé—®é¢˜&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">add_header &amp;#39;Access-Control-Allow-Origin&amp;#39; &amp;#39;*&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">add_header &amp;#39;Access-Control-Allow-Credentials&amp;#39; &amp;#39;true&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">add_header &amp;#39;Access-Control-Allow-Methods&amp;#39; &amp;#39;GET, POST, OPTIONS&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">add_header &amp;#39;Access-Control-Allow-Headers&amp;#39; &amp;#39;DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&amp;#39;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ä¿ç•™ç”¨æˆ·çœŸå®ä¿¡æ¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_set_header Host $host:$server_port;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_set_header X-Real-IP $remote_addr;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•ä¸ªæ–‡ä»¶å­—èŠ‚æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_max_body_size 100m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œå¯ä»¥ç†è§£ä¸ºå…ˆä¿å­˜åˆ°æœ¬åœ°å†ä¼ ç»™ç”¨æˆ·&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">client_body_buffer_size 1280k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå‘èµ·æ¡æ‰‹ç­‰å€™å“åº”è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_connect_timeout 5;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è¿æ¥æˆåŠŸå ç­‰å¾…åç«¯æœåŠ¡å™¨å“åº”æ—¶é—´ å…¶å®å·²è¿›å…¥åç«¯çš„æ’é˜Ÿä¹‹ä¸­ç­‰å€™å¤„ç†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_read_timeout 60;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ä»£ç†è¯·æ±‚ç¼“å­˜åŒº è¿™ä¸ªç¼“å­˜åŒºé—´ä¼šä¿å­˜ç”¨æˆ·çš„å¤´ä¿¡æ¯ä¸€å…±Nginxè¿›è¡Œè§„åˆ™å¤„ç† ä¸€èˆ¬åªè¦èƒ½ä¿å­˜ä¸‹å¤´ä¿¡æ¯å³å¯&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_send_timeout 30;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># åŒä¸Š å‘Šè¯‰Nginxä¿å­˜å•ä¸ªç”¨çš„å‡ ä¸ªBufferæœ€å¤§ç”¨å¤šå¤§ç©ºé—´&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_buffer_size 256k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_buffers 4 256k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å¦‚æœç³»ç»Ÿå¾ˆå¿™çš„æ—¶å€™å¯ä»¥ç”³è¯·å›½å†…å„å¤§çš„proxy_buffers å®˜æ–¹æ¨è *2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_busy_buffers_size 256k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># proxy ç¼“å­˜ä¸´æ—¶æ–‡ä»¶çš„å¤§å°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_temp_file_write_size 256k;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_next_upstream error timeout invalid_header http_500 http_503 http_404;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">proxy_max_temp_file_size 128m;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="nginxæ—¥å¿—ç®¡ç†">Nginxæ—¥å¿—ç®¡ç†&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#access_log logs/access.log main;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># nginxçš„é»˜è®¤é…ç½®,å¦‚æœåœ¨å®‰è£…çš„nginxé‡Œæ²¡æœ‰çœ‹åˆ°è¿™ä¸ª,ä¹Ÿæ²¡æœ‰å…³ç³»
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#log_format main &amp;#39;$remote_addr - $remote_user [$time_local] &amp;#34;$request&amp;#34; &amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># &amp;#39;$status $body_bytes_sent &amp;#34;$http_referer&amp;#34; &amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># &amp;#39;&amp;#34;$http_user_agent&amp;#34; &amp;#34;$http_x_forwarded_for&amp;#34;&amp;#39;;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">root&lt;/span> &lt;span style="color:#e6db74">my&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">index&lt;/span> &lt;span style="color:#e6db74">index.html&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#960050;background-color:#1e0010">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">#é…ç½®æ—¥å¿—, main å°±æ˜¯log_format åé¢çš„åå­—
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e"># è¯¥serverçš„è®¿é—®æ—¥å¿—çš„æ–‡ä»¶æ˜¯logs/access.log,ä½¿ç”¨çš„æ˜¯mainæ ¼å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#e6db74">access_log&lt;/span> &lt;span style="color:#e6db74">logs/access.log&lt;/span> &lt;span style="color:#e6db74">main&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ¨èçš„é…ç½®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">log_format&lt;/span> &lt;span style="color:#e6db74">main&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&lt;/span>$remote_addr &lt;span style="color:#e6db74">-&lt;/span> $remote_user &lt;span style="color:#e6db74">[&lt;/span>$time_local] &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$request&amp;#34; $http_host &lt;span style="color:#e6db74">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&lt;/span>$status $request_length $body_bytes_sent &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$http_referer&amp;#34; &lt;span style="color:#e6db74">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;&amp;#34;&lt;/span>$http_user_agent&amp;#34; $request_time&amp;#39;;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol>
&lt;li>remote_addr : å®¢æˆ·ç«¯åœ°å€&lt;/li>
&lt;li>remote_user : å®¢æˆ·ç«¯ç”¨æˆ·å&lt;/li>
&lt;li>time_local : æœåŠ¡å™¨æ—¶é—´&lt;/li>
&lt;li>request : è¯·æ±‚å†…å®¹ï¼ŒåŒ…æ‹¬æ–¹æ³•åï¼Œåœ°å€ï¼Œå’Œhttpåè®®&lt;/li>
&lt;li>http_host : ç”¨æˆ·è¯·æ±‚æ˜¯ä½¿ç”¨çš„httpåœ°å€&lt;/li>
&lt;li>status : è¿”å›çš„http çŠ¶æ€ç &lt;/li>
&lt;li>request_length : è¯·æ±‚å¤§å°&lt;/li>
&lt;li>body_bytes_sent : è¿”å›çš„å¤§å°&lt;/li>
&lt;li>http_referer : æ¥æºé¡µ&lt;/li>
&lt;li>http_user_agent : å®¢æˆ·ç«¯åç§°&lt;/li>
&lt;li>request_time : æ•´ä½“è¯·æ±‚å»¶æ—¶&lt;/li>
&lt;/ol>
&lt;p>æ—¥å¿—ä¹¦å†™è§„åˆ™&lt;/p>
&lt;p>ä¸€è¡Œè¦ç”¨å•å¼•å·åŒ…èµ·æ¥,ä¸€è¡Œä¸€ä¸ª,æ¢è¡Œä¹Ÿä¸éœ€è¦ä»€ä¹ˆè¿æ¥çš„ç¬¦å·&lt;/p>
&lt;h2 id="locationåŒ¹é…">locationåŒ¹é…&lt;/h2>
&lt;p>= ç²¾å‡†åŒ¹é…
ä¸å†™ ä¸€èˆ¬åŒ¹é…
~ æ­£åˆ™åŒ¹é…
location proxy_pass åé¢çš„url åŠ ä¸ä¸åŠ /çš„åŒºåˆ«&lt;/p>
&lt;h2 id="server_nameåŒ¹é…">server_nameåŒ¹é…&lt;/h2>
&lt;h3 id="é€šé…ç¬¦åŒ¹é…">é€šé…ç¬¦åŒ¹é…&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span>server {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> listen &lt;span style="color:#ae81ff">80&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> server_name &lt;span style="color:#f92672">*.&lt;/span>example&lt;span style="color:#f92672">.&lt;/span>org;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>server {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> listen &lt;span style="color:#ae81ff">80&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> server_name mail&lt;span style="color:#f92672">.*&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">...&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é€šé…ç¬¦æ ¼å¼ä¸­çš„&lt;code>*&lt;/code>å·åªèƒ½åœ¨åŸŸåçš„å¼€å¤´æˆ–ç»“å°¾ï¼Œå¹¶ä¸”&lt;code>*&lt;/code>å·ä¸¤ä¾§åªèƒ½æ˜¯&lt;code>.&lt;/code>è¿™äº›æ— æ•ˆ:&lt;/p>
&lt;ul>
&lt;li>&lt;code>www.*.example.org&lt;/code>&lt;/li>
&lt;li>&lt;code>w*.example.org&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>&lt;code>*&lt;/code>å·å¯ä»¥åŒ¹é…å¤šä¸ªåŸŸåéƒ¨åˆ†ï¼Œ&lt;code>*.example.org&lt;/code>å¯ä»¥åŒ¹é…åˆ°:&lt;/p>
&lt;ul>
&lt;li>&lt;code>www.example.org&lt;/code>&lt;/li>
&lt;li>&lt;code>www.sub.example.org&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>&lt;code>.example.org&lt;/code>æ˜¯æ¯”è¾ƒç‰¹æ®Šçš„é€šé…ç¬¦æ ¼å¼, å¯ä»¥åŒæ—¶åŒ¹é…&lt;/p>
&lt;ul>
&lt;li>&lt;code>example.org&lt;/code>&lt;/li>
&lt;li>&lt;code>*.example.org&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="æ­£åˆ™åŒ¹é…">æ­£åˆ™åŒ¹é…&lt;/h3>
&lt;p>â‰ï¸ ä¸é€‚ç”¨æˆ‘è‡ªå·±&lt;/p>
&lt;h3 id="ç²¾ç¡®åŒ¹é…">ç²¾ç¡®åŒ¹é…&lt;/h3>
&lt;pre tabindex="0">&lt;code class="language-visual-basic" data-lang="visual-basic">server {
listen 80;
server_name example.org www.example.org;
...
}
&lt;/code>&lt;/pre>&lt;h3 id="ç‰¹æ®ŠåŒ¹é…æ ¼å¼">ç‰¹æ®ŠåŒ¹é…æ ¼å¼&lt;/h3>
&lt;ol>
&lt;li>&lt;code>server_name &amp;quot;&amp;quot;&lt;/code>; åŒ¹é…Hostè¯·æ±‚å¤´ä¸å­˜åœ¨çš„æƒ…å†µã€‚&lt;/li>
&lt;li>&lt;code>server_name &amp;quot;-&amp;quot;&lt;/code>; æ— ä»»ä½•æ„ä¹‰ã€‚&lt;/li>
&lt;li>&lt;code>server_name &amp;quot;*&amp;quot;;&lt;/code> å®ƒè¢«é”™è¯¯åœ°è§£é‡Šä¸ºä¸‡èƒ½çš„åç§°ã€‚ å®ƒä»ä¸ç”¨ä½œé€šç”¨æˆ–é€šé…ç¬¦æœåŠ¡å™¨åç§°ã€‚ç›¸åï¼Œå®ƒæä¾›äº†server_name_in_redirectæŒ‡ä»¤ç°åœ¨æä¾›çš„åŠŸèƒ½ã€‚ &lt;code>ç°åœ¨ä¸å»ºè®®ä½¿ç”¨ç‰¹æ®Šåç§°â€œ *â€ï¼Œè€Œåº”ä½¿ç”¨server_name_in_redirectæŒ‡ä»¤ã€‚&lt;/code>&lt;/li>
&lt;/ol>
&lt;h4 id="åŒ¹é…é¡ºåº">åŒ¹é…é¡ºåº&lt;/h4>
&lt;ol>
&lt;li>ç²¾ç¡®çš„åå­—&lt;/li>
&lt;li>ä»¥*å·å¼€å¤´çš„æœ€é•¿é€šé…ç¬¦åç§°ï¼Œä¾‹å¦‚ *.example.org&lt;/li>
&lt;li>ä»¥&lt;em>å·ç»“å°¾çš„æœ€é•¿é€šé…ç¬¦åç§°ï¼Œä¾‹å¦‚ mail.&lt;/em>&lt;/li>
&lt;li>ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆåœ¨é…ç½®æ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºï¼‰&lt;/li>
&lt;/ol>
&lt;h3 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h3>
&lt;ol>
&lt;li>å°½é‡ä½¿ç”¨ç²¾ç¡®åŒ¹é…;&lt;/li>
&lt;li>å½“å®šä¹‰å¤§é‡server_nameæ—¶æˆ–ç‰¹åˆ«é•¿çš„server_nameæ—¶ï¼Œéœ€è¦åœ¨httpçº§åˆ«è°ƒæ•´server_names_hash_max_sizeå’Œserver_names_hash_bucket_sizeï¼Œå¦åˆ™nginxå°†æ— æ³•å¯åŠ¨ã€‚&lt;/li>
&lt;/ol>
&lt;h1 id="nginxæŠ¥é”™">NginxæŠ¥é”™&lt;/h1>
&lt;h3 id="1æœåŠ¡å™¨é‡å¯ä¹‹åæ‰§è¡Œ-nginx--t-æ˜¯okçš„ç„¶è€Œåœ¨æ‰§è¡Œ-nginx--s-reload-çš„æ—¶å€™æŠ¥é”™">1.æœåŠ¡å™¨é‡å¯ä¹‹åï¼Œæ‰§è¡Œ nginx -t æ˜¯OKçš„ï¼Œç„¶è€Œåœ¨æ‰§è¡Œ nginx -s reload çš„æ—¶å€™æŠ¥é”™&lt;/h3>
&lt;p>&lt;code>nginx: [error] invalid PID number &amp;quot;&amp;quot; in &amp;quot;/run/nginx.pid&amp;quot;&lt;/code>&lt;/p>
&lt;pre tabindex="0">&lt;code># è§£å†³åŠæ³•:
nginx -c /etc/nginx/nginx.conf
nginx.confæ–‡ä»¶çš„è·¯å¾„å¯ä»¥ä»nginx -tçš„è¿”å›ä¸­æ‰¾åˆ°ã€‚
nginx -s reload
&lt;/code>&lt;/pre>&lt;h3 id="2a-duplicate-default-server-for-000080">2.&lt;code>a duplicate default server for 0.0.0.0:80&lt;/code>&lt;/h3>
&lt;p>nginx: [emerg] a duplicate default server for 0.0.0.0:80 in /etc/nginx/sites-enabled/gitlab:10&lt;/p>
&lt;pre tabindex="0">&lt;code>åˆ é™¤/etc/nginx/sites-available/defaultæ–‡ä»¶ï¼Œé‡æ–°å¯åŠ¨æœåŠ¡å³å¯
nginx -t :æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å‡ºé”™
&lt;/code>&lt;/pre>&lt;h3 id="3403">3.403&lt;/h3>
&lt;pre tabindex="0">&lt;code>æ‰“å¼€nginx.conf
ä¾‹å­ï¼švim /etc/nginx/nginx.conf
æŠŠ user ç”¨æˆ·å æ”¹ä¸º user root æˆ– å…¶å®ƒæœ‰é«˜æƒé™çš„ç”¨æˆ·åç§°å³å¯
&lt;/code>&lt;/pre>&lt;h1 id="nginxåº”ç”¨">Nginxåº”ç”¨&lt;/h1>
&lt;h2 id="acmeshçš„ä½¿ç”¨">Acme.shçš„ä½¿ç”¨&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¸‹è½½è½¯ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl https://get.acme.sh | sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è®¾ç½®åˆ«å alias:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>alias acme.sh&lt;span style="color:#f92672">=&lt;/span>~/.acme.sh/acme.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># åˆ‡æ¢ Let&amp;#39;s Encrypt,é»˜è®¤ä½¿ç”¨ ZeroSSL&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --set-default-ca --server letsencrypt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ‰§è¡Œ,ä¼šæ‰“å°é…ç½®åŸŸåçš„TXT&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --issue -d baidu.me --dns --yes-I-know-dns-manual-mode-enough-go-ahead-please
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é…ç½®å¥½æ‰§è¡Œ,å†æ‰§è¡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --issue -d baidu.me --dns --yes-I-know-dns-manual-mode-enough-go-ahead-please --renew
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># --nginx å°±æ˜¯æŒ‡å®šåŸŸåçš„é…ç½®æ–‡ä»¶&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Your cert is in: /root/.acme.sh/baidu.me_ecc/baidu.me.cer
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Your cert key is in: /root/.acme.sh/baidu.me_ecc/baidu.me.key
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>The intermediate CA cert is in: /root/.acme.sh/baidu.me_ecc/ca.cer
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>And the full chain certs is there: /root/.acme.sh/baidu.me_ecc/fullchain.cer
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŸ¥çœ‹ç”³è¯·çš„è¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>root@jenkins-jumpserver-nginx:~/.acme.sh# acme.sh --list
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Main_Domain KeyLength SAN_Domains CA Created Renew
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>baidu &lt;span style="color:#e6db74">&amp;#34;ec-256&amp;#34;&lt;/span> no LetsEncrypt.org 2023-09-17T11:52:22Z 2023-11-15T11:52:22Z
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç»­æœŸè¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¯ä¹¦é»˜è®¤æ˜¯90å¤©ï¼Œå¦‚éœ€å¼ºåˆ¶æ›´æ–°è¯ä¹¦ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹å‘½ä»¤&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --renew -d abc.xyz --force
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># acme.shä¼šè‡ªåŠ¨ä¸ºä½ åˆ›å»º cronjob, æ¯å¤© 0:00 ç‚¹è‡ªåŠ¨æ£€æµ‹æ‰€æœ‰çš„è¯ä¹¦, &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¦‚æœå¿«è¿‡æœŸäº†, éœ€è¦æ›´æ–°, åˆ™ä¼šè‡ªåŠ¨æ›´æ–°è¯ä¹¦ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯æŸ¥çœ‹å®šæ—¶ä»»åŠ¡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>crontab -l
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å‡çº§ acme.sh åˆ°æœ€æ–°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --upgrade
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># CF&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>export CF_Key&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;xxxxxxx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>export CF_Email&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;CFè´¦å·çš„é‚®ç®±&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>acme.sh --issue -d &lt;span style="color:#e6db74">&amp;#34;baidu.com&amp;#34;&lt;/span> --dns dns_cf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å»ºç«‹è½¯è¿æ¥">å»ºç«‹è½¯è¿æ¥&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo ln -s /etc/nginx/sites-available/domain-one.com /etc/nginx/sites-enabled/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å¿«é€Ÿéƒ¨ç½²é™æ€åº”ç”¨">å¿«é€Ÿéƒ¨ç½²é™æ€åº”ç”¨&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é¦–å°¾é…ç½®æš‚æ—¶å¿½ç•¥
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">8080&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">localhost&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è®¾ç½®ä¸ºä¸ªäººé¡¹ç›®çš„æ ¹ç›®å½•è·¯å¾„
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">root&lt;/span> &lt;span style="color:#e6db74">/usr/local/var/www/my-project&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">index&lt;/span> &lt;span style="color:#e6db74">index.html&lt;/span> &lt;span style="color:#e6db74">index.htm&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># vueé¡¹ç›®404è®©å‰ç«¯è·¯ç”±å¤„ç†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">try_files&lt;/span> $uri $uri/ &lt;span style="color:#e6db74">/index.html&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é¦–å°¾é…ç½®æš‚æ—¶å¿½ç•¥
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è·¨åŸŸ">è·¨åŸŸ&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é¦–å°¾é…ç½®æš‚æ—¶å¿½ç•¥
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">8080&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">localhost&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è·¨åŸŸä»£ç†è®¾ç½®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://www.proxy.com&lt;/span>; &lt;span style="color:#75715e"># è¦å®ç°è·¨åŸŸçš„åŸŸå
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">Access-Control-Allow-Origin&lt;/span> &lt;span style="color:#e6db74">*&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">Access-Control-Allow-Methods&lt;/span> &lt;span style="color:#e6db74">&amp;#39;GET,&lt;/span> &lt;span style="color:#e6db74">POST,&lt;/span> &lt;span style="color:#e6db74">OPTIONS&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">Access-Control-Allow-Headers&lt;/span> &lt;span style="color:#e6db74">&amp;#39;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># é¦–å°¾é…ç½®æš‚æ—¶å¿½ç•¥
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ç¬¬äºŒç§
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span> &lt;span style="color:#e6db74">default_server&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">_&lt;/span> &lt;span style="color:#e6db74">www.*&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">index&lt;/span> &lt;span style="color:#e6db74">index.html&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">root&lt;/span> &lt;span style="color:#e6db74">/home/ubuntu/sabong-server-front&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">try_files&lt;/span> $uri $uri/ &lt;span style="color:#e6db74">/index.html&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/api/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">if&lt;/span> &lt;span style="color:#e6db74">(&lt;/span>$request_method = &lt;span style="color:#e6db74">&amp;#39;OPTIONS&amp;#39;)&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Origin&amp;#39;&lt;/span> &lt;span style="color:#e6db74">*&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Methods&amp;#39;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;GET,&lt;/span> &lt;span style="color:#e6db74">POST,&lt;/span> &lt;span style="color:#e6db74">PUT,&lt;/span> &lt;span style="color:#e6db74">DELETE,&lt;/span> &lt;span style="color:#e6db74">OPTIONS&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Headers&amp;#39;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,language,If-Modified-Since,Cache-Control,Content-Type&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Credentials&amp;#39;&lt;/span> &lt;span style="color:#e6db74">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Max-Age&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">86400&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">return&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Origin&amp;#39;&lt;/span> &lt;span style="color:#e6db74">*&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Methods&amp;#39;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;GET,&lt;/span> &lt;span style="color:#e6db74">POST,&lt;/span> &lt;span style="color:#e6db74">PUT,&lt;/span> &lt;span style="color:#e6db74">DELETE,&lt;/span> &lt;span style="color:#e6db74">OPTIONS&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Headers&amp;#39;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,language,If-Modified-Since,Cache-Control,Content-Type&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Allow-Credentials&amp;#39;&lt;/span> &lt;span style="color:#e6db74">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Access-Control-Max-Age&amp;#39;&lt;/span> &lt;span style="color:#ae81ff">86400&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Real-IP&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forward-For&lt;/span> $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Host&lt;/span> $http_host;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Nginx-Proxy&lt;/span> &lt;span style="color:#e6db74">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://172.31.41.206:9001/&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/ws&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://172.31.41.206:9006/ws&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_http_version&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#e6db74">.1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_read_timeout&lt;/span> &lt;span style="color:#e6db74">360s&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_redirect&lt;/span> &lt;span style="color:#66d9ef">off&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Upgrade&lt;/span> $http_upgrade;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Connection&lt;/span> &lt;span style="color:#e6db74">&amp;#34;upgrade&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Host&lt;/span> $host:$server_port;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Real-IP&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">REMOTE-HOST&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forwarded-For&lt;/span> $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="gzipå‹ç¼©">Gzipå‹ç¼©&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">http&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># é…ç½®gzipå‹ç¼©
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">gzip&lt;/span> &lt;span style="color:#66d9ef">on&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">gzip_min_length&lt;/span> &lt;span style="color:#ae81ff">1000&lt;/span>; &lt;span style="color:#75715e"># è®¾å®šå‹ç¼©çš„ä¸´ç•Œç‚¹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">gzip_comp_level&lt;/span> &lt;span style="color:#ae81ff">3&lt;/span>; &lt;span style="color:#75715e"># å‹ç¼©çº§åˆ«
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">gzip_types&lt;/span> &lt;span style="color:#e6db74">text/plain&lt;/span> &lt;span style="color:#e6db74">application/xml&lt;/span>; &lt;span style="color:#75715e"># è¦å‹ç¼©çš„æ–‡ä»¶ç±»åˆ«
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è½¬å‘vueé¡¹ç›®">è½¬å‘Vueé¡¹ç›®&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span> &lt;span style="color:#e6db74">default_server&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">_&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">index&lt;/span> &lt;span style="color:#e6db74">index.html&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">root&lt;/span> &lt;span style="color:#e6db74">/home/ubuntu/sabong-server-front&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># nginx è½¬å‘ç»™å‰ç«¯åˆ¤æ–­æ˜¯ä¸æ˜¯404
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">try_files&lt;/span> $uri $uri/ &lt;span style="color:#e6db74">/index.html&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/api/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Real-IP&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forwarded-For&lt;/span> $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Host&lt;/span> $http_host;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Nginx-Proxy&lt;/span> &lt;span style="color:#e6db74">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://172.31.41.206:9001/&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è½¬å‘websocket">è½¬å‘Websocket&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">location&lt;/span> &lt;span style="color:#e6db74">/ws&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://172.31.41.206:9006/ws&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_http_version&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#e6db74">.1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_read_timeout&lt;/span> &lt;span style="color:#e6db74">360s&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_redirect&lt;/span> &lt;span style="color:#66d9ef">off&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Upgrade&lt;/span> $http_upgrade;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Connection&lt;/span> &lt;span style="color:#e6db74">&amp;#34;upgrade&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Host&lt;/span> $host:$server_port;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Real-IP&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">REMOTE-HOST&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forwarded-For&lt;/span> $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è½¬å‘redis">è½¬å‘Redis&lt;/h2>
&lt;p>åªçŸ¥é“è¿™ä¹ˆé…ç½®,ä¸çŸ¥é“æ€ä¹ˆç»™redisé…ç½®ä¸ŠåŸŸå&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">user&lt;/span> &lt;span style="color:#e6db74">www-data&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">worker_processes&lt;/span> &lt;span style="color:#e6db74">auto&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">pid&lt;/span> &lt;span style="color:#e6db74">/run/nginx.pid&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">include&lt;/span> /etc/nginx/modules-enabled/*.conf;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">events&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">worker_connections&lt;/span> &lt;span style="color:#ae81ff">768&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># multi_accept on;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">http{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># è¦è·Ÿhttpç»Ÿè®¡,æ—§çš„ç‰ˆæœ¬æ²¡æœ‰steramæ¨¡å—,éœ€è¦ç¼–è¯‘çš„æ—¶å€™åŠ 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¸‹è½½æœ€æ–°çš„ç‰ˆæœ¬è‚¯å®šæ˜¯æœ‰streamæ¨¡å—çš„
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#e6db74">stream&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">upstream&lt;/span> &lt;span style="color:#e6db74">redis&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># myredis.godjfp.com è¦è¢«è½¬å‘çš„Redisåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e"># 6379:redisè‡ªå·±è®¾ç½®çš„ç«¯å£æ˜¯å¤šå°‘,å°±æ˜¯å¤šå°‘
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">server&lt;/span> myredis.godjfp.com:&lt;span style="color:#ae81ff">6379&lt;/span> &lt;span style="color:#e6db74">max_fails=3&lt;/span> &lt;span style="color:#e6db74">fail_timeout=30s&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å…¬ç½‘è®¿é—®çš„ç«¯å£
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">6379&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_connect_timeout&lt;/span> &lt;span style="color:#e6db74">1s&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_timeout&lt;/span> &lt;span style="color:#e6db74">3s&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">redis&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://image.runtimes.cc/202404051446413.png" alt="">&lt;/p>
&lt;h2 id="å›¾ç‰‡ä¸Šä¼ ">å›¾ç‰‡ä¸Šä¼ &lt;/h2>
&lt;p>postä¸Šä¼ æ–‡ä»¶ï¼Œå‡ºç°413é”™è¯¯ç  è§£å†³æ–¹æ¡ˆ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sql" data-lang="sql">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">#&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>client_max_body_size &lt;span style="color:#ae81ff">10&lt;/span>m;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">#&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>client_body_buffer_size &lt;span style="color:#ae81ff">128&lt;/span>k;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="httpsè·³è½¬">HTTPSè·³è½¬&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">443&lt;/span> &lt;span style="color:#e6db74">ssl&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># é…ç½®SSLè¯ä¹¦
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">abc.xyz&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å¦‚æœæ˜¯http,å°±è·³è½¬https,æ³¨æ„nginxé…ç½®æ–‡ä»¶çš„ä¸åŒ,å¯èƒ½ä¼šå‡ºç°é‡å®šå‘æ¬¡æ•°è¿‡å¤š
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">if&lt;/span> &lt;span style="color:#e6db74">(&lt;/span>$scheme = &lt;span style="color:#e6db74">http)&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">return&lt;/span> &lt;span style="color:#ae81ff">301&lt;/span> &lt;span style="color:#e6db74">https://&lt;/span>$host$request_uri;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://192.168.0.2:8084/&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æ¯”å¦‚é…ç½®å¼ºåˆ¶è·³è½¬https,å¯¼è‡´é‡å®šå‘æ¬¡æ•°è¿‡å¤š
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">443&lt;/span> &lt;span style="color:#e6db74">ssl&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># é…ç½®SSLè¯ä¹¦
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">abc.xyz&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># å¦‚æœæ˜¯http,å°±è·³è½¬https,æ³¨æ„nginxé…ç½®æ–‡ä»¶çš„ä¸åŒ,å¯èƒ½ä¼šå‡ºç°é‡å®šå‘æ¬¡æ•°è¿‡å¤š
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e"># æ¯”å¦‚è¿™ä¸ªé…ç½® return 301 https://$server_name$request_uri;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e"># æ¯”å¦‚è¿™ä¸ªé…ç½® rewrite ^(.*)$ https://$host$1 permanent;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://192.168.0.2:8084/&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ä¸Šé¢ä¸¤ç§å¯¼è‡´é‡å®šå‘çš„æ¬¡æ•°è¿‡å¤š,éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶,æ¯”å¦‚ä¸‹é¢çš„é…ç½®æ–‡ä»¶å°±å¯ä»¥
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">your_domain.com&lt;/span> &lt;span style="color:#e6db74">www.your_domain.com&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">return&lt;/span> &lt;span style="color:#ae81ff">301&lt;/span> &lt;span style="color:#e6db74">https://&lt;/span>$host$request_uri;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">443&lt;/span> &lt;span style="color:#e6db74">ssl&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">your_domain.com&lt;/span> &lt;span style="color:#e6db74">www.your_domain.com&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ssl_certificate&lt;/span> &lt;span style="color:#e6db74">/path/to/your/certificate.crt&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ssl_certificate_key&lt;/span> &lt;span style="color:#e6db74">/path/to/your/private_key.key&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ä»£ç†jumpserver">ä»£ç†JumpServer&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span> &lt;span style="color:#e6db74">default_server&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#e6db74">[::]:80&lt;/span> &lt;span style="color:#e6db74">default_server&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">root&lt;/span> &lt;span style="color:#e6db74">/var/www/html&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">index&lt;/span> &lt;span style="color:#e6db74">index.html&lt;/span> &lt;span style="color:#e6db74">index.htm&lt;/span> &lt;span style="color:#e6db74">index.nginx-debian.html&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">_&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># æ¯”å¦‚æœåŠ¡å™¨é‡Œçš„JumpServerçš„ç«¯å£å·²ç»è®¾ç½®æˆäº†8083
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://127.0.0.1:8083/&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># æŒ‰ç…§å®˜æ–¹çš„é…ç½®,éœ€è¦ä½¿ç”¨WebSocket,å¦‚æœä¸é…ç½®çš„è¯,è®¿é—®JumpServerç½‘é¡µä¼šæç¤ºWebSocketæŠ¥é”™
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">proxy_http_version&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#e6db74">.1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_buffering&lt;/span> &lt;span style="color:#66d9ef">off&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_request_buffering&lt;/span> &lt;span style="color:#66d9ef">off&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Upgrade&lt;/span> $http_upgrade;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Connection&lt;/span> &lt;span style="color:#e6db74">&amp;#34;upgrade&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Host&lt;/span> $host;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forwarded-For&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://docs.jumpserver.org/zh/v3/installation/proxy/?h=nginx#2-nginx">å®˜æ–¹æ–‡æ¡£:ä½¿ç”¨Nginxä»£ç†JumpServer&lt;/a>&lt;/p>
&lt;h2 id="ä»£ç†jenkins">ä»£ç†Jenkins&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span> &lt;span style="color:#e6db74">default_server&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#e6db74">[::]:80&lt;/span> &lt;span style="color:#e6db74">default_server&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">_&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://127.0.0.1:8083/&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å¦‚æœä½¿ç”¨è¿™æ ·çš„é…ç½®,ä¼šæœ‰é—®é¢˜,æ¯”å¦‚é…ç½®çš„åŸŸåæ˜¯baidu.com
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># å½“è®¿é—®baidu.comä¼šæ­£å¸¸è®¿é—®,å½“ç™»å½•ä¹‹å,ç½‘é¡µåœ°å€å°±å˜æˆhttp://127.0.0.1:8083/
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># éœ€è¦æ”¹æˆä¸€ä¸‹é…ç½®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span> &lt;span style="color:#e6db74">default_server&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#e6db74">[::]:80&lt;/span> &lt;span style="color:#e6db74">default_server&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">_&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://127.0.0.1:8080/&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ä¸‹é¢è¿™å‡ ä¸ªé…ç½®,è®¿é—®Githubä¼š403
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">proxy_http_version&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>&lt;span style="color:#e6db74">.1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">http2_push_preload&lt;/span> &lt;span style="color:#66d9ef">on&lt;/span>; &lt;span style="color:#75715e"># Enable http2 push
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forwarded-Proto&lt;/span> $scheme;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forwarded-For&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Real-IP&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># è¿™ä¸ªé…ç½®åˆæ˜¯æ­£å¸¸çš„,è¦çœ‹çœ‹è¿™ä¸ªè¯·æ±‚å¤´æ˜¯å¹²å˜›çš„äº†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Rea&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forwarded-For&lt;/span> $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Host&lt;/span> $http_host;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Nginx-Proxy&lt;/span> &lt;span style="color:#e6db74">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">listen&lt;/span> &lt;span style="color:#ae81ff">80&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">server_name&lt;/span> &lt;span style="color:#e6db74">_&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/api/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">client_max_body_size&lt;/span> &lt;span style="color:#ae81ff">100m&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">client_body_buffer_size&lt;/span> &lt;span style="color:#ae81ff">50m&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_redirect&lt;/span> &lt;span style="color:#66d9ef">off&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Host&lt;/span> $host;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Real-IP&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forwarded-For&lt;/span> $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://172.31.2.105:8083/&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ä»£ç†swaggerç¨³å®š openapi3çš„ç‰ˆæœ¬,springboot3çš„ç‰ˆæœ¬
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/v3/api-docs&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">client_max_body_size&lt;/span> &lt;span style="color:#ae81ff">100m&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">client_body_buffer_size&lt;/span> &lt;span style="color:#ae81ff">50m&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_redirect&lt;/span> &lt;span style="color:#66d9ef">off&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">Host&lt;/span> $host;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Real-IP&lt;/span> $remote_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_set_header&lt;/span> &lt;span style="color:#e6db74">X-Forwarded-For&lt;/span> $proxy_add_x_forwarded_for;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">proxy_pass&lt;/span> &lt;span style="color:#e6db74">http://172.31.2.105:8083/v3/api-docs&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">try_files&lt;/span> $uri $uri/ &lt;span style="color:#e6db74">/index.html&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">root&lt;/span> &lt;span style="color:#e6db74">/usr/share/nginx/html/manager/dist/&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">index&lt;/span> &lt;span style="color:#e6db74">index.html&lt;/span> &lt;span style="color:#e6db74">index.htm&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="srs">SRS&lt;/h1>
&lt;h2 id="dockeræ–¹å¼è¿è¡Œ">Dockeræ–¹å¼è¿è¡Œ&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-docker" data-lang="docker">&lt;span style="display:flex;">&lt;span>docker run -p 1935:1935 -p 1985:1985 -p 8080:8080 ossrs/srs:latest&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># æµ‹è¯•&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">&lt;/span>&lt;span style="color:#75715e"># è®¿é—®:[http://192.168.254.180:8080/](http://192.168.254.180:8080/)&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="srså®‰è£…å‚è€ƒ">SRSå®‰è£…å‚è€ƒ&lt;/h2>
&lt;p>&lt;a href="https://cloud.tencent.com/developer/article/1693951">https://cloud.tencent.com/developer/article/1693951&lt;/a>&lt;/p>
&lt;h2 id="macæ”¹æˆåªæ’­æ”¾ç³»ç»Ÿå£°éŸ³">Macæ”¹æˆåªæ’­æ”¾ç³»ç»Ÿå£°éŸ³&lt;/h2>
&lt;p>&lt;a href="http://www.obsproject.com.cn/obs/78.html">Mac obsæ¨æµç›´æ’­æ— å£°éŸ³è§£å†³æ–¹æ³•_OBSæ•™ç¨‹_OBS Open Broadcaster Software&lt;/a>&lt;/p>
&lt;h2 id="obsæƒé™ç›‘å¬æµè§ˆå™¨">OBSæƒé™ç›‘å¬æµè§ˆå™¨&lt;/h2>
&lt;p>&lt;img src="https://image.runtimes.cc/202404051442055.png" alt="">&lt;/p></content></item></channel></rss>